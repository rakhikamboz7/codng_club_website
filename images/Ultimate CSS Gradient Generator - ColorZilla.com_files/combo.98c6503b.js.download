var Prototype={Version:"1.7.2",Browser:function(){var t=navigator.userAgent,e="[object Opera]"==Object.prototype.toString.call(window.opera);return{IE:!!window.attachEvent&&!e,Opera:e,WebKit:-1<t.indexOf("AppleWebKit/"),Gecko:-1<t.indexOf("Gecko")&&-1===t.indexOf("KHTML"),MobileSafari:/Apple.*Mobile/.test(t)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var t=window.Element||window.HTMLElement;return!(!t||!t.prototype)}(),SpecificElementExtensions:function(){var t,e,i;return void 0!==window.HTMLDivElement||(t=document.createElement("div"),e=document.createElement("form"),i=!1,t.__proto__&&t.__proto__!==e.__proto__&&(i=!0),t=e=null,i)}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)</script\\s*>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(t){return t}},Class=(Prototype.Browser.MobileSafari&&(Prototype.BrowserFeatures.SpecificElementExtensions=!1),function(){var l=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}();function s(){}return{create:function(){var t=null,e=$A(arguments);function i(){this.initialize.apply(this,arguments)}Object.isFunction(e[0])&&(t=e.shift()),Object.extend(i,Class.Methods),i.superclass=t,i.subclasses=[],t&&(s.prototype=t.prototype,i.prototype=new s,t.subclasses.push(i));for(var o=0,n=e.length;o<n;o++)i.addMethods(e[o]);return i.prototype.initialize||(i.prototype.initialize=Prototype.emptyFunction),i.prototype.constructor=i},Methods:{addMethods:function(t){var e=this.superclass&&this.superclass.prototype,i=Object.keys(t);l&&(t.toString!=Object.prototype.toString&&i.push("toString"),t.valueOf!=Object.prototype.valueOf)&&i.push("valueOf");for(var o=0,n=i.length;o<n;o++){var s,r=i[o],a=t[r];e&&Object.isFunction(a)&&"$super"==a.argumentNames()[0]&&(s=a,(a=function(t){return function(){return e[t].apply(this,arguments)}}(r).wrap(s)).valueOf=function(t){return function(){return t.valueOf.call(t)}}(s),a.toString=function(t){return function(){return t.toString.call(t)}}(s)),this.prototype[r]=a}return this}}}}()),PeriodicalExecuter=(!function(){var u=Object.prototype.toString,n=Object.prototype.hasOwnProperty,e="Null",i="Undefined",o="Boolean",s="Number",r="String",p="Object",d="[object Boolean]",f="[object Number]",m="[object String]",g="[object Array]",t=window.JSON&&"function"==typeof JSON.stringify&&"0"===JSON.stringify(0)&&void 0===JSON.stringify(Prototype.K),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}();function b(t){switch(t){case null:return e;case void 0:return i}switch(typeof t){case"boolean":return o;case"number":return s;case"string":return r}return p}function c(t,e){for(var i in e)t[i]=e[i];return t}function h(t){return u.call(t)===g}function v(t){return void 0===t}"function"==typeof Array.isArray&&Array.isArray([])&&!Array.isArray({})&&(h=Array.isArray),c(Object,{extend:c,inspect:function(t){try{return v(t)?"undefined":null===t?"null":t.inspect?t.inspect():String(t)}catch(t){if(t instanceof RangeError)return"...";throw t}},toJSON:t?function(t){return JSON.stringify(t)}:function(t){return function t(e,i,o){var n=i[e];b(n)===p&&"function"==typeof n.toJSON&&(n=n.toJSON(e));var s=u.call(n);switch(s){case f:case d:case m:n=n.valueOf()}switch(n){case null:return"null";case!0:return"true";case!1:return"false"}i=typeof n;switch(i){case"string":return n.inspect(!0);case"number":return isFinite(n)?String(n):"null";case"object":for(var r=0,a=o.length;r<a;r++)if(o[r]===n)throw new TypeError("Cyclic reference to '"+n+"' in object");o.push(n);var l=[];if(s===g){for(r=0,a=n.length;r<a;r++){var c=t(r,n,o);l.push(void 0===c?"null":c)}l="["+l.join(",")+"]"}else{for(var h=Object.keys(n),r=0,a=h.length;r<a;r++){e=h[r];void 0!==(c=t(e,n,o))&&l.push(e.inspect(!0)+":"+c)}l="{"+l.join(",")+"}"}return o.pop(),l}}("",{"":t},[])},toQueryString:function(t){return $H(t).toQueryString()},toHTML:function(t){return t&&t.toHTML?t.toHTML():String.interpret(t)},keys:Object.keys||function(t){if(b(t)!==p)throw new TypeError;var e,i=[];for(e in t)n.call(t,e)&&i.push(e);if(l)for(var o=0;e=a[o];o++)n.call(t,e)&&i.push(e);return i},values:function(t){var e,i=[];for(e in t)i.push(t[e]);return i},clone:function(t){return c({},t)},isElement:function(t){return!(!t||1!=t.nodeType)},isArray:h,isHash:function(t){return t instanceof Hash},isFunction:function(t){return"[object Function]"===u.call(t)},isString:function(t){return u.call(t)===m},isNumber:function(t){return u.call(t)===f},isDate:function(t){return"[object Date]"===u.call(t)},isUndefined:v})}(),Object.extend(Function.prototype,function(){var r=Array.prototype.slice;function n(t,e){for(var i=t.length,o=e.length;o--;)t[i+o]=e[o];return t}function a(t,e){return n(t=r.call(t,0),e)}var t={argumentNames:function(){var t=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return 1!=t.length||t[0]?t:[]},bindAsEventListener:function(e){var i=this,o=r.call(arguments,1);return function(t){t=n([t||window.event],o);return i.apply(e,t)}},curry:function(){var e,i;return arguments.length?(e=this,i=r.call(arguments,0),function(){var t=a(i,arguments);return e.apply(this,t)}):this},delay:function(t){var e=this,i=r.call(arguments,1);return t*=1e3,window.setTimeout(function(){return e.apply(e,i)},t)},defer:function(){var t=n([.01],arguments);return this.delay.apply(this,t)},wrap:function(e){var i=this;return function(){var t=n([i.bind(this)],arguments);return e.apply(this,t)}},methodize:function(){var e;return this._methodized||((e=this)._methodized=function(){var t=n([this],arguments);return e.apply(null,t)})}};return Function.prototype.bind||(t.bind=function(i){if(arguments.length<2&&Object.isUndefined(i))return this;var t,o,n,s;if(Object.isFunction(this))return t=function(){},o=this,n=r.call(arguments,1),s=function(){var t=a(n,arguments),e=this instanceof s?this:i;return o.apply(e,t)},t.prototype=this.prototype,s.prototype=new t,s;throw new TypeError("The object is not callable.")}),t}()),!function(t){t.toISOString||(t.toISOString=function(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}),t.toJSON||(t.toJSON=function(){return this.toISOString()})}(Date.prototype),RegExp.prototype.match=RegExp.prototype.test,RegExp.escape=function(t){return String(t).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},Class.create({initialize:function(t,e){this.callback=t,this.frequency=e,this.currentlyExecuting=!1,this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),1e3*this.frequency)},execute:function(){this.callback(this)},stop:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},onTimerEvent:function(){if(!this.currentlyExecuting)try{this.currentlyExecuting=!0,this.execute(),this.currentlyExecuting=!1}catch(t){throw this.currentlyExecuting=!1,t}}})),Template=(Object.extend(String,{interpret:function(t){return null==t?"":String(t)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}}),Object.extend(String.prototype,function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&"function"==typeof JSON.parse&&JSON.parse('{"test": true}').test;function prepareReplacement(t){var e;return Object.isFunction(t)?t:(e=new Template(t),function(t){return e.evaluate(t)})}function isNonEmptyRegExp(t){return t.source&&"(?:)"!==t.source}function gsub(t,e){var i,o="",n=this;if(e=prepareReplacement(e),!(t=Object.isString(t)?RegExp.escape(t):t).length&&!isNonEmptyRegExp(t))return(e=e(""))+n.split("").join(e)+e;for(;0<n.length;)n=(i=n.match(t))&&0<i[0].length?(o=(o+=n.slice(0,i.index))+String.interpret(e(i)),n.slice(i.index+i[0].length)):(o+=n,"");return o}function sub(t,e,i){return e=prepareReplacement(e),i=Object.isUndefined(i)?1:i,this.gsub(t,function(t){return--i<0?t[0]:e(t)})}function scan(t,e){return this.gsub(t,e),String(this)}function truncate(t,e){return t=t||30,e=Object.isUndefined(e)?"...":e,this.length>t?this.slice(0,t-e.length)+e:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var t=new RegExp(Prototype.ScriptFragment,"img"),e=new RegExp(Prototype.ScriptFragment,"im");return(this.match(t)||[]).map(function(t){return(t.match(e)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(t){var e=this.strip().match(/([^?#]*)(#.*)?$/);return e?e[1].split(t||"&").inject({},function(t,e){var i;return(e=e.split("="))[0]&&(i=decodeURIComponent(e.shift()),null!=(e=1<e.length?e.join("="):e[0])&&(e=e.gsub("+"," "),e=decodeURIComponent(e)),i in t?(Object.isArray(t[i])||(t[i]=[t[i]]),t[i].push(e)):t[i]=e),t}):{}}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(t){return t<1?"":new Array(t+1).join(this)}function camelize(){return this.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(t){var e=this.replace(/[\x00-\x1f\\]/g,function(t){return t in String.specialChar?String.specialChar[t]:"\\u00"+t.charCodeAt().toPaddedString(2,16)});return t?'"'+e.replace(/"/g,'\\"')+'"':"'"+e.replace(/'/g,"\\'")+"'"}function unfilterJSON(t){return this.replace(t||Prototype.JSONFilter,"$1")}function isJSON(){var t=this;return!t.blank()&&(t=(t=(t=t.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@")).replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]")).replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(t))}function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;cx.test(json)&&(json=json.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}));try{if(!sanitize||json.isJSON())return eval("("+json+")")}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function parseJSON(){var t=this.unfilterJSON();return JSON.parse(t)}function include(t){return-1<this.indexOf(t)}function startsWith(t,e){return e=Object.isNumber(e)?e:0,this.lastIndexOf(t,e)===e}function endsWith(t,e){t=String(t);e=(e=(e=(e=Object.isNumber(e)?e:this.length)<0?0:e)>this.length?this.length:e)-t.length;return 0<=e&&this.indexOf(t,e)===e}function empty(){return""==this}function blank(){return/^\s*$/.test(this)}function interpolate(t,e){return new Template(this,e).evaluate(t)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:String.prototype.startsWith||startsWith,endsWith:String.prototype.endsWith||endsWith,empty:empty,blank:blank,interpolate:interpolate}}()),Class.create({initialize:function(t,e){this.template=t.toString(),this.pattern=e||Template.Pattern},evaluate:function(s){return s&&Object.isFunction(s.toTemplateReplacements)&&(s=s.toTemplateReplacements()),this.template.gsub(this.pattern,function(t){if(null==s)return t[1]+"";var e=t[1]||"";if("\\"==e)return t[2];var i=s,o=t[3],n=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;if(null==(t=n.exec(o)))return e;for(;null!=t;){if(null==(i=i[t[1].startsWith("[")?t[2].replace(/\\\\]/g,"]"):t[1]])||""==t[3])break;o=o.substring(("["==t[3]?t[1]:t[0]).length),t=n.exec(o)}return e+String.interpret(i)})}})),$break=(Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/,{}),Enumerable=function(){function t(i,o){i=i||Prototype.K;var n=!0;return this.each(function(t,e){if(!(n=n&&!!i.call(o,t,e,this)))throw $break},this),n}function e(i,o){i=i||Prototype.K;var n=!1;return this.each(function(t,e){if(n=!!i.call(o,t,e,this))throw $break},this),n}function i(i,o){i=i||Prototype.K;var n=[];return this.each(function(t,e){n.push(i.call(o,t,e,this))},this),n}function o(i,o){var n;return this.each(function(t,e){if(i.call(o,t,e,this))throw n=t,$break},this),n}function n(i,o){var n=[];return this.each(function(t,e){i.call(o,t,e,this)&&n.push(t)},this),n}function s(e){var i;return!(!Object.isFunction(this.indexOf)||-1==this.indexOf(e))||(i=!1,this.each(function(t){if(t==e)throw i=!0,$break}),i)}function r(){return this.map()}return{each:function(t,e){try{this._each(t,e)}catch(t){if(t!=$break)throw t}return this},eachSlice:function(t,e,i){var o=-t,n=[],s=this.toArray();if(t<1)return s;for(;(o+=t)<s.length;)n.push(s.slice(o,o+t));return n.collect(e,i)},all:t,every:t,any:e,some:e,collect:i,map:i,detect:o,findAll:n,select:n,filter:n,grep:function(i,o,n){o=o||Prototype.K;var s=[];return Object.isString(i)&&(i=new RegExp(RegExp.escape(i))),this.each(function(t,e){i.match(t)&&s.push(o.call(n,t,e,this))},this),s},include:s,member:s,inGroupsOf:function(e,i){return i=Object.isUndefined(i)?null:i,this.eachSlice(e,function(t){for(;t.length<e;)t.push(i);return t})},inject:function(i,o,n){return this.each(function(t,e){i=o.call(n,i,t,e,this)},this),i},invoke:function(e){var i=$A(arguments).slice(1);return this.map(function(t){return t[e].apply(t,i)})},max:function(i,o){var n;return i=i||Prototype.K,this.each(function(t,e){t=i.call(o,t,e,this),(null==n||n<=t)&&(n=t)},this),n},min:function(i,o){var n;return i=i||Prototype.K,this.each(function(t,e){t=i.call(o,t,e,this),(null==n||t<n)&&(n=t)},this),n},partition:function(i,o){i=i||Prototype.K;var n=[],s=[];return this.each(function(t,e){(i.call(o,t,e,this)?n:s).push(t)},this),[n,s]},pluck:function(e){var i=[];return this.each(function(t){i.push(t[e])}),i},reject:function(i,o){var n=[];return this.each(function(t,e){i.call(o,t,e,this)||n.push(t)},this),n},sortBy:function(i,o){return this.map(function(t,e){return{value:t,criteria:i.call(o,t,e,this)}},this).sort(function(t,e){t=t.criteria,e=e.criteria;return t<e?-1:e<t?1:0}).pluck("value")},toArray:r,entries:r,zip:function(){var i=Prototype.K,t=$A(arguments),o=(Object.isFunction(t.last())&&(i=t.pop()),[this].concat(t).map($A));return this.map(function(t,e){return i(o.pluck(e))})},size:function(){return this.toArray().length},inspect:function(){return"#<Enumerable:"+this.toArray().inspect()+">"},find:o}}();function $A(t){if(!t)return[];if("toArray"in Object(t))return t.toArray();for(var e=t.length||0,i=new Array(e);e--;)i[e]=t[e];return i}function $w(t){return Object.isString(t)&&(t=t.strip())?t.split(/\s+/):[]}function $H(t){return new Hash(t)}Array.from=$A,!function(){var t,e,i=Array.prototype,c=i.slice,o=i.forEach;function n(){return c.call(this,0)}function s(e){return function(){var t;return 0===arguments.length?e.call(this,Prototype.K):void 0===arguments[0]?((t=c.call(arguments,1)).unshift(Prototype.K),e.apply(this,t)):e.apply(this,arguments)}}function r(t){if(null==this)throw new TypeError;t=t||Prototype.K;for(var e=Object(this),i=[],o=arguments[1],n=0,s=0,r=e.length>>>0;s<r;s++)s in e&&(i[n]=t.call(o,e[s],s,e)),n++;return i.length=n,i}function a(t){if(null==this||!Object.isFunction(t))throw new TypeError;for(var e,i=Object(this),o=[],n=arguments[1],s=0,r=i.length>>>0;s<r;s++)s in i&&(e=i[s],t.call(n,e,s,i))&&o.push(e);return o}function t(t){if(null==this)throw new TypeError;t=t||Prototype.K;for(var e=arguments[1],i=Object(this),o=0,n=i.length>>>0;o<n;o++)if(o in i&&t.call(e,i[o],o,i))return!0;return!1}function e(t){if(null==this)throw new TypeError;t=t||Prototype.K;for(var e=arguments[1],i=Object(this),o=0,n=i.length>>>0;o<n;o++)if(o in i&&!t.call(e,i[o],o,i))return!1;return!0}o=o||function(t,e){for(var i=0,o=this.length>>>0;i<o;i++)i in this&&t.call(e,this[i],i,this)},i.map&&(r=s(Array.prototype.map)),i.filter&&(a=Array.prototype.filter),i.some&&(t=s(Array.prototype.some)),i.every&&(e=s(Array.prototype.every));var l,h=i.reduce;function l(t,e){e=e||Prototype.K;var i=arguments[2];return h.call(this,e.bind(i),t)}i.reduce||(l=Enumerable.inject),Object.extend(i,Enumerable),i._reverse||(i._reverse=i.reverse),Object.extend(i,{_each:o,map:r,collect:r,select:a,filter:a,findAll:a,some:t,any:t,every:e,all:e,inject:l,clear:function(){return this.length=0,this},first:function(){return this[0]},last:function(){return this[this.length-1]},compact:function(){return this.select(function(t){return null!=t})},flatten:function(){return this.inject([],function(t,e){return Object.isArray(e)?t.concat(e.flatten()):(t.push(e),t)})},without:function(){var e=c.call(arguments,0);return this.select(function(t){return!e.include(t)})},reverse:function(t){return(!1===t?this.toArray():this)._reverse()},uniq:function(o){return this.inject([],function(t,e,i){return 0!=i&&(o?t.last()==e:t.include(e))||t.push(e),t})},intersect:function(e){return this.uniq().findAll(function(t){return-1!==e.indexOf(t)})},clone:n,toArray:n,size:function(){return this.length},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]"}}),function(){return 1!==[].concat(arguments)[0][0]}(1,2)&&(i.concat=function(t){var e,i=[],o=c.call(arguments,0),n=0;o.unshift(this);for(var s=0,r=o.length;s<r;s++)if(e=o[s],!Object.isArray(e)||"callee"in e)i[n++]=e;else for(var a=0,l=e.length;a<l;a++)a in e&&(i[n]=e[a]),n++;return i.length=n,i}),i.indexOf||(i.indexOf=function(t,e){if(null==this)throw new TypeError;var i=Object(this),o=i.length>>>0;if(0!=o&&(e=Number(e),isNaN(e)?e=0:0!==e&&isFinite(e)&&(e=(0<e?1:-1)*Math.floor(Math.abs(e))),!(o<e)))for(var n=0<=e?e:Math.max(o-Math.abs(e),0);n<o;n++)if(n in i&&i[n]===t)return n;return-1}),i.lastIndexOf||(i.lastIndexOf=function(t,e){if(null==this)throw new TypeError;var i=Object(this),o=i.length>>>0;if(0!=o){Object.isUndefined(e)?e=o:(e=Number(e),isNaN(e)?e=0:0!==e&&isFinite(e)&&(e=(0<e?1:-1)*Math.floor(Math.abs(e))));for(var n=0<=e?Math.min(e,o-1):o-Math.abs(e);0<=n;n--)if(n in i&&i[n]===t)return n}return-1})}();var Hash=Class.create(Enumerable,function(){function t(){return Object.clone(this._object)}function l(t,e){return Object.isUndefined(e)?t:(e=(e=String.interpret(e)).gsub(/(\r)?\n/,"\r\n"),t+"="+(e=(e=encodeURIComponent(e)).gsub(/%20/,"+")))}return{initialize:function(t){this._object=Object.isHash(t)?t.toObject():Object.clone(t)},_each:function(t,e){var i,o=0;for(i in this._object){var n=this._object[i],s=[i,n];s.key=i,s.value=n,t.call(e,s,o),o++}},set:function(t,e){return this._object[t]=e},get:function(t){if(this._object[t]!==Object.prototype[t])return this._object[t]},unset:function(t){var e=this._object[t];return delete this._object[t],e},toObject:t,toTemplateReplacements:t,keys:function(){return this.pluck("key")},values:function(){return this.pluck("value")},index:function(e){var t=this.detect(function(t){return t.value===e});return t&&t.key},merge:function(t){return this.clone().update(t)},update:function(t){return new Hash(t).inject(this,function(t,e){return t.set(e.key,e.value),t})},toQueryString:function(){return this.inject([],function(t,e){var i=encodeURIComponent(e.key),o=e.value;if(o&&"object"==typeof o){if(Object.isArray(o)){for(var n,s=[],r=0,a=o.length;r<a;r++)n=o[r],s.push(l(i,n));return t.concat(s)}}else t.push(l(i,o));return t}).join("&")},inspect:function(){return"#<Hash:{"+this.map(function(t){return t.map(Object.inspect).join(": ")}).join(", ")+"}>"},toJSON:t,clone:function(){return new Hash(this)}}}());function $R(t,e,i){return new ObjectRange(t,e,i)}Hash.from=$H,Object.extend(Number.prototype,{toColorPart:function(){return this.toPaddedString(2,16)},succ:function(){return this+1},times:function(t,e){return $R(0,this,!0).each(t,e),this},toPaddedString:function(t,e){return e=this.toString(e||10),"0".times(t-e.length)+e},abs:function(){return Math.abs(this)},round:function(){return Math.round(this)},ceil:function(){return Math.ceil(this)},floor:function(){return Math.floor(this)}});var ObjectRange=Class.create(Enumerable,{initialize:function(t,e,i){this.start=t,this.end=e,this.exclusive=i},_each:function(t,e){for(var i=this.start,o=0;this.include(i);o++)t.call(e,i,o),i=i.succ()},include:function(t){return!(t<this.start)&&(this.exclusive?t<this.end:t<=this.end)}}),Abstract={},Try={these:function(){for(var t,e=0,i=arguments.length;e<i;e++){var o=arguments[e];try{t=o();break}catch(t){}}return t}},Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0,Responders:{responders:[],_each:function(t,e){this.responders._each(t,e)},register:function(t){this.include(t)||this.responders.push(t)},unregister:function(t){this.responders=this.responders.without(t)},dispatch:function(e,i,o,n){this.each(function(t){if(Object.isFunction(t[e]))try{t[e].apply(t,[i,o,n])}catch(t){}})}}},Form=(Object.extend(Ajax.Responders,Enumerable),Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}}),Ajax.Base=Class.create({initialize:function(t){this.options={method:"post",asynchronous:!0,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:!0,evalJS:!0},Object.extend(this.options,t||{}),this.options.method=this.options.method.toLowerCase(),Object.isHash(this.options.parameters)&&(this.options.parameters=this.options.parameters.toObject())}}),Ajax.Request=Class.create(Ajax.Base,{_complete:!1,initialize:function(t,e,i){t(i),this.transport=Ajax.getTransport(),this.request(e)},request:function(t){this.url=t,this.method=this.options.method;t=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);["get","post"].include(this.method)||(t+=(t?"&":"")+"_method="+this.method,this.method="post"),t&&"get"===this.method&&(this.url+=(this.url.include("?")?"&":"?")+t),this.parameters=t.toQueryParams();try{var e=new Ajax.Response(this);this.options.onCreate&&this.options.onCreate(e),Ajax.Responders.dispatch("onCreate",this,e),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&this.respondToReadyState.bind(this).defer(1),this.transport.onreadystatechange=this.onStateChange.bind(this),this.setRequestHeaders(),this.body="post"==this.method?this.options.postBody||t:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(t){this.dispatchException(t)}},onStateChange:function(){var t=this.transport.readyState;1<t&&(4!=t||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var t,e={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if("post"==this.method&&(e["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType)&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(e.Connection="close"),"object"==typeof this.options.requestHeaders){var i=this.options.requestHeaders;if(Object.isFunction(i.push))for(var o=0,n=i.length;o<n;o+=2)e[i[o]]=i[o+1];else $H(i).each(function(t){e[t.key]=t.value})}for(t in e)null!=e[t]&&this.transport.setRequestHeader(t,e[t])},success:function(){var t=this.getStatus();return!t||200<=t&&t<300||304==t},getStatus:function(){try{return 1223===this.transport.status?204:this.transport.status||0}catch(t){return 0}},respondToReadyState:function(t){var t=Ajax.Request.Events[t],e=new Ajax.Response(this);if("Complete"==t){try{this._complete=!0,(this.options["on"+e.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(e,e.headerJSON)}catch(t){this.dispatchException(t)}var i=e.getHeader("Content-type");("force"==this.options.evalJS||this.options.evalJS&&this.isSameOrigin()&&i&&i.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))&&this.evalResponse()}try{(this.options["on"+t]||Prototype.emptyFunction)(e,e.headerJSON),Ajax.Responders.dispatch("on"+t,this,e,e.headerJSON)}catch(t){this.dispatchException(t)}"Complete"==t&&(this.transport.onreadystatechange=Prototype.emptyFunction)},isSameOrigin:function(){var t=this.url.match(/^\s*https?:\/\/[^\/]*/);return!t||t[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(t){try{return this.transport.getResponseHeader(t)||null}catch(t){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(t){(this.options.onException||Prototype.emptyFunction)(this,t),Ajax.Responders.dispatch("onException",this,t)}}),Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],Ajax.Response=Class.create({initialize:function(t){this.request=t;var t=this.transport=t.transport,e=this.readyState=t.readyState;(2<e&&!Prototype.Browser.IE||4==e)&&(this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=String.interpret(t.responseText),this.headerJSON=this._getHeaderJSON()),4==e&&(e=t.responseXML,this.responseXML=Object.isUndefined(e)?null:e,this.responseJSON=this._getResponseJSON())},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(t){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(t){return null}},getResponseHeader:function(t){return this.transport.getResponseHeader(t)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var t=this.getHeader("X-JSON");if(!t)return null;try{t=decodeURIComponent(escape(t))}catch(t){}try{return t.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(t){this.request.dispatchException(t)}},_getResponseJSON:function(){var t=this.request.options;if(!t.evalJSON||"force"!=t.evalJSON&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(t.sanitizeJSON||!this.request.isSameOrigin())}catch(t){this.request.dispatchException(t)}}}),Ajax.Updater=Class.create(Ajax.Request,{initialize:function(t,e,i,o){this.container={success:e.success||e,failure:e.failure||(e.success?null:e)};var n=(o=Object.clone(o)).onComplete;o.onComplete=function(t,e){this.updateContent(t.responseText),Object.isFunction(n)&&n(t,e)}.bind(this),t(i,o)},updateContent:function(t){var e,i=this.container[this.success()?"success":"failure"],o=this.options;o.evalScripts||(t=t.stripScripts()),(i=$(i))&&(o.insertion?Object.isString(o.insertion)?((e={})[o.insertion]=t,i.insert(e)):o.insertion(i,t):i.update(t))}}),Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function(t,e,i,o){t(o),this.onComplete=this.options.onComplete,this.frequency=this.options.frequency||2,this.decay=this.options.decay||1,this.updater={},this.container=e,this.url=i,this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this),this.onTimerEvent()},stop:function(){this.updater.options.onComplete=void 0,clearTimeout(this.timer),(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(t){this.options.decay&&(this.decay=t.responseText==this.lastText?this.decay*this.options.decay:1,this.lastText=t.responseText),this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}}),!function(t){var n,r=Array.prototype.slice,a=document.createElement("div");function u(t){if(1<arguments.length){for(var e=0,i=[],o=arguments.length;e<o;e++)i.push(u(arguments[e]));return i}return Object.isString(t)&&(t=document.getElementById(t)),c.extend(t)}t.$=u,t.Node||(t.Node={}),t.Node.ELEMENT_NODE||Object.extend(t.Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});var l={};var o=function(){try{var t=document.createElement('<input name="x">');return"input"===t.tagName.toLowerCase()&&"x"===t.name}catch(t){return!1}}(),e=t.Element;function c(t,e){if(e=e||{},t=t.toLowerCase(),o&&e.name)return t="<"+t+' name="'+e.name+'">',delete e.name,c.writeAttribute(document.createElement(t),e);l[t]||(l[t]=c.extend(document.createElement(t)));i=e;var i="select"===t||"type"in i?document.createElement(t):l[t].cloneNode(!1);return c.writeAttribute(i,e)}t.Element=c,Object.extend(t.Element,e||{}),e&&(t.Element.prototype=e.prototype),c.Methods={ByTag:{},Simulated:{}};var e={},s={id:"id",className:"class"};e.inspect=function(t){var e,i,o,n="<"+(t=u(t)).tagName.toLowerCase();for(o in s)e=s[o],(i=(t[o]||"").toString())&&(n+=" "+e+"="+i.inspect(!0));return n+">"},Object.extend(e,{visible:function(t){return"none"!==u(t).style.display},toggle:function(t,e){return t=u(t),Object.isUndefined(e)&&(e=!c.visible(t)),c[e?"show":"hide"](t),t},hide:function(t){return(t=u(t)).style.display="none",t},show:function(t){return(t=u(t)).style.display="",t}});i=document.createElement("select"),h=!0,i.innerHTML='<option value="test">test</option>',i.options&&i.options[0]&&(h="OPTION"!==i.options[0].nodeName.toUpperCase()),i=null;var i=h,h=function(){try{var t,e=document.createElement("table");if(e&&e.tBodies)return e.innerHTML="<tbody><tr><td>test</td></tr></tbody>",t=void 0===e.tBodies[0],e=null,t}catch(t){return!0}}(),p=function(){try{(e=document.createElement("div")).innerHTML="<link />";var t=0===e.childNodes.length,e=null;return t}catch(t){return!0}}(),L=i||h||p,H=function(){var t=document.createElement("script"),e=!1;try{t.appendChild(document.createTextNode("")),e=!t.firstChild||t.firstChild&&3!==t.firstChild.nodeType}catch(t){e=!0}return t=null,e}();function R(t,e){var i;return t=u(t),e&&e.toElement?e=e.toElement():Object.isElement(e)||(e=Object.toHTML(e),(i=t.ownerDocument.createRange()).selectNode(t),e.evalScripts.bind(e).defer(),e=i.createContextualFragment(e.stripScripts())),t.parentNode.replaceChild(e,t),t}var d={before:function(t,e){t.parentNode.insertBefore(e,t)},top:function(t,e){t.insertBefore(e,t.firstChild)},bottom:function(t,e){t.appendChild(e)},after:function(t,e){t.parentNode.insertBefore(e,t.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}},i=d.tags;function f(t,e,i){var t=d.tags[t],o=a,n=!!t;if(!n&&i&&(n=!0,t=["","",0]),n){o.innerHTML="&#160;"+t[0]+e+t[1],o.removeChild(o.firstChild);for(var s=t[2];s--;)o=o.firstChild}else o.innerHTML=e;return $A(o.childNodes)}function m(t){var e=_(t);e&&(c.stopObserving(t),k||(t._prototypeUID=n),delete c.Storage[e])}function g(t,e,i){t=u(t),i=i||-1;for(var o=[];(t=t[e])&&(t.nodeType===Node.ELEMENT_NODE&&o.push(c.extend(t)),o.length!==i););return o}function B(t){for(t=u(t).firstChild;t&&t.nodeType!==Node.ELEMENT_NODE;)t=t.nextSibling;return u(t)}function W(t){for(var e=[],i=u(t).firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&e.push(c.extend(i)),i=i.nextSibling;return e}function F(t){return g(t,"previousSibling")}function U(t){return g(t,"nextSibling")}function b(t,e,i,o){for(t=u(t),i=i||0,o=o||0,Object.isNumber(i)&&(o=i,i=null);t=t[e];)if(1===t.nodeType&&(!i||Prototype.Selector.match(t,i))&&!(0<=--o))return c.extend(t)}function G(t){t=u(t);var e=r.call(arguments,1).join(", ");return Prototype.Selector.select(e,t)}function z(t,e){for(t=u(t),e=u(e);t=t.parentNode;)if(t===e)return!0;return!1}Object.extend(i,{THEAD:i.TBODY,TFOOT:i.TBODY,TH:i.TD}),"outerHTML"in document.documentElement&&(R=function(t,e){var i,o,n;return t=u(t),e&&e.toElement&&(e=e.toElement()),Object.isElement(e)?t.parentNode.replaceChild(e,t):(e=Object.toHTML(e),(n=(i=t.parentNode).tagName.toUpperCase())in d.tags?(o=c.next(t),n=f(n,e.stripScripts()),i.removeChild(t),n.each(o?function(t){i.insertBefore(t,o)}:function(t){i.appendChild(t)})):t.outerHTML=e.stripScripts(),e.evalScripts.bind(e).defer()),t}),Object.extend(e,{remove:function(t){return(t=u(t)).parentNode.removeChild(t),t},update:function(t,e){for(var i=(t=u(t)).getElementsByTagName("*"),o=i.length;o--;)m(i[o]);if(e&&e.toElement&&(e=e.toElement()),Object.isElement(e))return t.update().insert(e);e=Object.toHTML(e);var n=t.tagName.toUpperCase();if("SCRIPT"===n&&H)t.text=e;else{if(L)if(n in d.tags){for(;t.firstChild;)t.removeChild(t.firstChild);for(var s=f(n,e.stripScripts()),o=0;r=s[o];o++)t.appendChild(r)}else if(p&&Object.isString(e)&&-1<e.indexOf("<link")){for(;t.firstChild;)t.removeChild(t.firstChild);for(var r,s=f(n,e.stripScripts(),!0),o=0;r=s[o];o++)t.appendChild(r)}else t.innerHTML=e.stripScripts();else t.innerHTML=e.stripScripts();e.evalScripts.bind(e).defer()}return t},replace:R,insert:function(t,e){var i,o;for(o in t=u(t),i=e,e=!Object.isUndefined(i)&&null!==i&&(Object.isString(i)||Object.isNumber(i)||Object.isElement(i)||i.toElement||i.toHTML)?{bottom:e}:e){n=void 0;s=void 0;r=void 0;a=void 0;l=void 0;h=void 0;c=void 0;var n=t;var s=e[o];var r=o;r=r.toLowerCase();var a=d[r];if(s&&s.toElement&&(s=s.toElement()),Object.isElement(s))a(n,s);else{s=Object.toHTML(s);var l=f(("before"===r||"after"===r?n.parentNode:n).tagName.toUpperCase(),s.stripScripts());"top"!==r&&"after"!==r||l.reverse();for(var c,h=0;c=l[h];h++)a(n,c);s.evalScripts.bind(s).defer()}}return t},wrap:function(t,e,i){return t=u(t),Object.isElement(e)?u(e).writeAttribute(i||{}):e=Object.isString(e)?new c(e,i):new c("div",e),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},cleanWhitespace:function(t){for(var e=(t=u(t)).firstChild;e;){var i=e.nextSibling;e.nodeType!==Node.TEXT_NODE||/\S/.test(e.nodeValue)||t.removeChild(e),e=i}return t},empty:function(t){return u(t).innerHTML.blank()},clone:function(t,e){if(t=u(t)){t=t.cloneNode(e);if(!k&&(t._prototypeUID=n,e))for(var i=c.select(t,"*"),o=i.length;o--;)i[o]._prototypeUID=n;return c.extend(t)}},purge:function(t){if(t=u(t)){m(t);for(var e=t.getElementsByTagName("*"),i=e.length;i--;)m(e[i]);return null}}}),h=a.compareDocumentPosition?function(t,e){return t=u(t),e=u(e),8==(8&t.compareDocumentPosition(e))}:a.contains?function(t,e){return t=u(t),(e=u(e)).contains?e.contains(t)&&e!==t:z(t,e)}:z,Object.extend(e,{recursivelyCollect:g,ancestors:function(t){return g(t,"parentNode")},descendants:function(t){return c.select(t,"*")},firstDescendant:B,immediateDescendants:W,previousSiblings:F,nextSiblings:U,siblings:function(t){var e=F(t=u(t)),t=U(t);return e.reverse().concat(t)},match:function(t,e){return t=u(t),Object.isString(e)?Prototype.Selector.match(t,e):e.match(t)},up:function(t,e,i){return t=u(t),1===arguments.length?u(t.parentNode):b(t,"parentNode",e,i)},down:function(t,e,i){if(1===arguments.length)return B(t);t=u(t),e=e||0,i=i||0,Object.isNumber(e)&&(i=e,e="*");var o=Prototype.Selector.select(e,t)[i];return c.extend(o)},previous:function(t,e,i){return b(t,"previousSibling",e,i)},next:function(t,e,i){return b(t,"nextSibling",e,i)},select:G,adjacent:function(t){t=u(t);for(var e,i=r.call(arguments,1).join(", "),o=c.siblings(t),n=[],s=0;e=o[s];s++)Prototype.Selector.match(e,i)&&n.push(e);return n},descendantOf:h,getElementsBySelector:G,childElements:W});var V=1;function v(t,e){return u(t).getAttribute(e)}a.setAttribute("onclick",[]),i=a.getAttribute("onclick"),i=Object.isArray(i),a.removeAttribute("onclick"),i?v=function(t,e){t=u(t);var i=E.read;return i.values[e]?i.values[e](t,e):(e=i.names[e]?i.names[e]:e).include(":")?t.attributes&&t.attributes[e]?t.attributes[e].value:null:t.getAttribute(e)}:Prototype.Browser.Opera&&(v=function(t,e){return"title"===e?t.title:t.getAttribute(e)});i=!!o&&((h=document.createElement('<input type="checkbox">')).checked=!0,!(h=h.getAttributeNode("checked"))||!h.specified);function $(t,e){e=E.has[e]||e;t=u(t).getAttributeNode(e);return!(!t||!t.specified)}t.Element.Methods.Simulated.hasAttribute=i?function(t,e){return"checked"===e?t.checked:$(t,e)}:$;var K={};function q(t){var e;return K[t]||(e=new RegExp("(^|\\s+)"+t+"(\\s+|$)"),K[t]=e)}function y(t,e){if(t=u(t))return 0!==(t=t.className).length&&(t===e||q(e).test(t))}var E={},h="className",i="for",S=(a.setAttribute(h,"x"),"x"!==a.className&&(a.setAttribute("class","x"),"x"===a.className)&&(h="class"),document.createElement("label"));function J(t,e){return t.getAttribute(e,2)}function w(t,e){return u(t).hasAttribute(e)?e:null}S.setAttribute(i,"x"),"x"!==S.htmlFor&&(S.setAttribute("htmlFor","x"),"x"===S.htmlFor)&&(i="htmlFor"),S=null,a.onclick=Prototype.emptyFunction;for(var C,S=a.getAttribute("onclick"),Z=(-1<String(S).indexOf("{")?I=function(t,e){t=t.getAttribute(e);return t?(t=(t=(t=t.toString()).split("{")[1]).split("}")[0]).strip():null}:""===S&&(I=function(t,e){t=t.getAttribute(e);return t?t.strip():null}),E.read={names:{class:h,className:h,for:i,htmlFor:i},values:{style:function(t){return t.style.cssText.toLowerCase()},title:function(t){return t.title}}},E.write={names:{className:"class",htmlFor:"for",cellpadding:"cellPadding",cellspacing:"cellSpacing"},values:{checked:function(t,e){t.checked=!!e},style:function(t,e){t.style.cssText=e||""}}},E.has={names:{}},Object.extend(E.write.names,E.read.names),$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder")),Y=0;C=Z[Y];Y++)E.write.names[C.toLowerCase()]=C,E.has.names[C.toLowerCase()]=C;function X(t,e){t=u(t),e="float"===(i=e)||"styleFloat"===i?"cssFloat":i.camelize();var i=t.style[e];return i&&"auto"!==i||(i=(t=document.defaultView.getComputedStyle(t,null))?t[e]:null),"opacity"===e?i?parseFloat(i):1:"auto"===i?null:i}function Q(t){return(t||"").replace(/alpha\([^\)]*\)/gi,"")}Object.extend(E.read.values,{href:J,src:J,type:function(t,e){return t.getAttribute(e)},action:function(t,e){return(t=t.getAttributeNode(e))?t.value:""},disabled:w,checked:w,readonly:w,multiple:w,onload:I,onunload:I,onclick:I,ondblclick:I,onmousedown:I,onmouseup:I,onmouseover:I,onmousemove:I,onmouseout:I,onfocus:I,onblur:I,onkeypress:I,onkeydown:I,onkeyup:I,onsubmit:I,onreset:I,onselect:I,onchange:I}),Object.extend(e,{identify:function(t){t=u(t);var e=c.readAttribute(t,"id");if(!e){for(;u(e="anonymous_element_"+V++););c.writeAttribute(t,"id",e)}return e},readAttribute:v,writeAttribute:function(t,e,i){t=u(t);var o,n={},s=E.write;for(o in"object"==typeof e?n=e:n[e]=!!Object.isUndefined(i)||i,n)e=s.names[o]||o,i=n[o],s.values[o]&&(e=s.values[o](t,i)||e),!1===i||null===i?t.removeAttribute(e):!0===i?t.setAttribute(e,e):t.setAttribute(e,i);return t},classNames:function(t){return new c.ClassNames(t)},hasClassName:y,addClassName:function(t,e){if(t=u(t))return y(t,e)||(t.className+=(t.className?" ":"")+e),t},removeClassName:function(t,e){if(t=u(t))return t.className=t.className.replace(q(e)," ").strip(),t},toggleClassName:function(t,e,i){if(t=u(t))return(0,c[(i=Object.isUndefined(i)?!y(t,e):i)?"addClassName":"removeClassName"])(t,e)}});a.style.cssText="opacity:.55";var x=/^0.55/.test(a.style.opacity);function tt(t,e){return 1==e||""===e?e="":e<1e-5&&(e=0),(t=u(t)).style.opacity=e,t}function et(t){return c.getStyle(t,"opacity")}function it(t){return x?et(t):0!==(t=c.getStyle(t,"filter")).length&&(t=(t||"").match(/alpha\(opacity=(.*)\)/))&&t[1]?parseFloat(t[1])/100:1}Object.extend(e,{setStyle:function(t,e){var i,o,n=(t=u(t)).style;if(Object.isString(e))n.cssText+=";"+e,e.include("opacity")&&(i=e.match(/opacity:\s*(\d?\.?\d*)/)[1],c.setOpacity(t,i));else for(var s in e)"opacity"===s?c.setOpacity(t,e[s]):(o=e[s],n[s="float"!==s&&"cssFloat"!==s?s:Object.isUndefined(n.styleFloat)?"cssFloat":"styleFloat"]=o);return t},getStyle:X,setOpacity:tt,getOpacity:et}),"styleFloat"in a.style&&(e.getStyle=function(t,e){t=u(t),e="float"===(i=e)||"cssFloat"===i?"styleFloat":i.camelize();var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),"opacity"!==e||x?"auto"===i?"width"!==e&&"height"!==e||!c.visible(t)?null:c.measure(t,e)+"px":i:it(t)},e.setOpacity=function(t,e){var i,o;return x?tt(t,e):((i=u(t)).currentStyle&&i.currentStyle.hasLayout||(i.style.zoom=1),t=i,i=c.getStyle(t,"filter"),o=t.style,1==e||""===e?(i=Q(i))?o.filter=i:o.removeAttribute("filter"):(e<1e-5&&(e=0),o.filter=Q(i)+"alpha(opacity="+100*e+")"),t)},e.getOpacity=it);function _(t){return t===window?0:(void 0===t._prototypeUID&&(t._prototypeUID=c.Storage.UID++),t._prototypeUID)}t.Element.Storage={UID:1};var k="uniqueID"in a;function O(t){if(t=u(t))return t=_(t),c.Storage[t]||(c.Storage[t]=$H()),c.Storage[t]}k&&(_=function(t){return t===window?0:t==document?1:t.uniqueID}),Object.extend(e,{getStorage:O,store:function(t,e,i){var o;if(t=u(t))return o=O(t),2===arguments.length?o.update(e):o.set(e,i),t},retrieve:function(t,e,i){var o;if(t=u(t))return o=(t=O(t)).get(e),Object.isUndefined(o)&&(t.set(e,i),o=i),o}});var P={},M=c.Methods.ByTag,T=Prototype.BrowserFeatures;!T.ElementExtensions&&"__proto__"in a&&(t.HTMLElement={},t.HTMLElement.prototype=a.__proto__,T.ElementExtensions=!0);S="object";var I,h=void 0!==window.Element&&!!o&&!!(h=window.Element.prototype)&&(i="_"+(Math.random()+"").slice(2),S=document.createElement(S),I=(h[i]="x")!==S[i],delete h[i],S=null,I);function A(t,e){for(var i in e){var o=e[i];!Object.isFunction(o)||i in t||(t[i]=o.methodize())}}var D={};function ot(t){return _(t)in D}function N(t){var e,i;return t&&!ot(t)&&t.nodeType===Node.ELEMENT_NODE&&t!=window&&(e=Object.clone(P),i=t.tagName.toUpperCase(),M[i]&&Object.extend(e,M[i]),A(t,e),D[_(t)]=!0),t}function nt(t,e){t=t.toUpperCase(),M[t]||(M[t]={}),Object.extend(M[t],e)}function j(t,e,i){for(var o in Object.isUndefined(i)&&(i=!1),e){var n=e[o];!Object.isFunction(n)||i&&o in t||(t[o]=n.methodize())}}T.SpecificElementExtensions&&(N=h?function(t){var e;return t&&!ot(t)&&((e=t.tagName)&&/^(?:object|applet|embed)$/i.test(e))&&(A(t,c.Methods),A(t,c.Methods.Simulated),A(t,c.Methods.ByTag[e.toUpperCase()])),t}:Prototype.K),Object.extend(t.Element,{extend:N,addMethods:function(t){var e;if(0===arguments.length&&(Object.extend(Form,Form.Methods),Object.extend(Form.Element,Form.Element.Methods),Object.extend(c.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})),2===arguments.length&&(e=t,t=arguments[1]),e)if(Object.isArray(e))for(var i=0;r=e[i];i++)nt(r,t);else nt(e,t);else Object.extend(c.Methods,t||{});var o,n,s=(window.HTMLElement?HTMLElement:c).prototype;if(T.ElementExtensions&&(j(s,c.Methods),j(s,c.Methods.Simulated,!0)),T.SpecificElementExtensions)for(var r in c.Methods.ByTag){o=void 0,(n={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"})[a=r]&&(o="HTML"+n[a]+"Element");var a=window[o]||(o="HTML"+a+"Element",window[o])||(o="HTML"+a.capitalize()+"Element",window[o])||(o=(n=document.createElement(a)).__proto__||n.constructor.prototype,n=null,o);Object.isUndefined(a)||j(a.prototype,M[r])}Object.extend(c,c.Methods),Object.extend(c,c.Methods.Simulated),delete c.ByTag,delete c.Simulated,c.extend.refresh(),l={}}}),N===Prototype.K?t.Element.extend.refresh=Prototype.emptyFunction:t.Element.extend.refresh=function(){Prototype.BrowserFeatures.ElementExtensions||(Object.extend(P,c.Methods),Object.extend(P,c.Methods.Simulated),D={})},c.addMethods(e),window.attachEvent&&window.attachEvent("onunload",function(){l=a=null})}(this),!function(){function a(t,e){var i=(t=$(t)).style[e];return i&&"auto"!==i||(i=(t=document.defaultView.getComputedStyle(t,null))?t[e]:null),"opacity"===e?i?parseFloat(i):1:"auto"===i?null:i}function s(t,e){return t.offsetWidth-(i(t,"borderLeftWidth",e)||0)-(i(t,"borderRightWidth",e)||0)-(i(t,"paddingLeft",e)||0)-(i(t,"paddingRight",e)||0)}function i(t,e,i){var o,n,s,r=null;return null===(t=Object.isElement(t)?a(r=t,e):t)||Object.isUndefined(t)?null:/^(?:-)?\d+(\.\d+)?(px)?$/i.test(t)?window.parseFloat(t):(o=t.include("%"),s=i===document.viewport,!(/\d/.test(t)&&r&&r.runtimeStyle)||o&&s?!r||!o||(i=i||r.parentNode,o=(s=(s=t).match(/^(\d+)%?$/i))?Number(s[1])/100:null,s=null,n=e.include("left")||e.include("right")||e.include("width"),e=e.include("top")||e.include("bottom")||e.include("height"),i===document.viewport?n?s=document.viewport.getWidth():e&&(s=document.viewport.getHeight()):n?s=$(i).measure("width"):e&&(s=$(i).measure("height")),null===s)?0:s*o:(n=r.style.left,e=r.runtimeStyle.left,r.runtimeStyle.left=r.currentStyle.left,r.style.left=t||0,t=r.style.pixelLeft,r.style.left=n,r.runtimeStyle.left=e,t))}"currentStyle"in document.documentElement&&(a=function(t,e){var i=t.style[e];return i=!i&&t.currentStyle?t.currentStyle[e]:i});var n=Prototype.K;function o(t){if(!(c(t=$(t))||h(t)||r(t)||l(t))){if(!("inline"===Element.getStyle(t,"display"))&&t.offsetParent)return $(t.offsetParent);for(;(t=t.parentNode)&&t!==document.body;)if("static"!==Element.getStyle(t,"position"))return l(t)?$(document.body):$(t)}return $(document.body)}function t(t){var e=0,i=0;if((t=$(t)).parentNode)for(;e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent;);return new Element.Offset(i,e)}function e(t){var e=(t=$(t)).getLayout(),i=0,o=0;do{if(i+=t.offsetTop||0,o+=t.offsetLeft||0,t=t.offsetParent){if(r(t))break;if("static"!==Element.getStyle(t,"position"))break}}while(t);return o-=e.get("margin-top"),i-=e.get("margin-left"),new Element.Offset(o,i)}function r(t){return"BODY"===t.nodeName.toUpperCase()}function l(t){return"HTML"===t.nodeName.toUpperCase()}function c(t){return t.nodeType===Node.DOCUMENT_NODE}function h(t){return t!==document.body&&!Element.descendantOf(t,document.body)}"currentStyle"in document.documentElement&&(n=function(t){return t.currentStyle.hasLayout||(t.style.zoom=1),t}),Element.Layout=Class.create(Hash,{initialize:function(t,e,i){t(),this.element=$(e),Element.Layout.PROPERTIES.each(function(t){this._set(t,null)},this),i&&(this._preComputing=!0,this._begin(),Element.Layout.PROPERTIES.each(this._compute,this),this._end(),this._preComputing=!1)},_set:function(t,e){return Hash.prototype.set.call(this,t,e)},set:function(t,e){throw"Properties of Element.Layout are read-only."},get:function(t,e){t=t(e);return null===t?this._compute(e):t},_begin:function(){var t,e,i,o,n;this._isPrepared()||(function(t){for(;t&&t.parentNode;){if("none"===t.getStyle("display"))return;t=$(t.parentNode)}return 1}(t=this.element)||(e={position:t.style.position||"",width:t.style.width||"",visibility:t.style.visibility||"",display:t.style.display||""},t.store("prototype_original_styles",e),e=a(t,"position"),0!==(n=t.offsetWidth)&&null!==n||(t.style.display="block",n=t.offsetWidth),i="fixed"===e?document.viewport:t.parentNode,o={visibility:"hidden",display:"block"},"fixed"!==e&&(o.position="absolute"),t.setStyle(o),o=t.offsetWidth,n=n&&o===n||"absolute"===e||"fixed"===e?s(t,i):(o=t.parentNode,$(o).getLayout().get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right")),t.setStyle({width:n+"px"})),this._setPrepared(!0))},_end:function(){var t=this.element,e=t.retrieve("prototype_original_styles");t.store("prototype_original_styles",null),t.setStyle(e),this._setPrepared(!1)},_compute:function(t){var e=Element.Layout.COMPUTATIONS;if(t in e)return this._set(t,e[t].call(this,this.element));throw"Property not found."},_isPrepared:function(){return this.element.retrieve("prototype_element_layout_prepared",!1)},_setPrepared:function(t){return this.element.store("prototype_element_layout_prepared",t)},toObject:function(){var t=$A(arguments),t=0===t.length?Element.Layout.PROPERTIES:t.join(" ").split(" "),i={};return t.each(function(t){var e;Element.Layout.PROPERTIES.include(t)&&null!=(e=this.get(t))&&(i[t]=e)},this),i},toHash:function(){var t=this.toObject.apply(this,arguments);return new Hash(t)},toCSS:function(){var t=$A(arguments),t=0===t.length?Element.Layout.PROPERTIES:t.join(" ").split(" "),i={};return t.each(function(t){var e;Element.Layout.PROPERTIES.include(t)&&!Element.Layout.COMPOSITE_PROPERTIES.include(t)&&null!=(e=this.get(t))&&(i[(t=t).include("border")&&(t+="-width"),t.camelize()]=e+"px")},this),i},inspect:function(){return"#<Element.Layout>"}}),Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(t){this._preComputing||this._begin();var e,i,o,n,s=this.get("border-box-height");return s<=0?(this._preComputing||this._end(),0):(e=this.get("border-top"),i=this.get("border-bottom"),o=this.get("padding-top"),n=this.get("padding-bottom"),this._preComputing||this._end(),s-e-i-o-n)},width:function(t){this._preComputing||this._begin();var e,i,o,n,s=this.get("border-box-width");return s<=0?(this._preComputing||this._end(),0):(e=this.get("border-left"),i=this.get("border-right"),o=this.get("padding-left"),n=this.get("padding-right"),this._preComputing||this._end(),s-e-i-o-n)},"padding-box-height":function(t){return this.get("height")+this.get("padding-top")+this.get("padding-bottom")},"padding-box-width":function(t){return this.get("width")+this.get("padding-left")+this.get("padding-right")},"border-box-height":function(t){this._preComputing||this._begin();t=t.offsetHeight;return this._preComputing||this._end(),t},"border-box-width":function(t){this._preComputing||this._begin();t=t.offsetWidth;return this._preComputing||this._end(),t},"margin-box-height":function(t){var e=this.get("border-box-height"),i=this.get("margin-top"),o=this.get("margin-bottom");return e<=0?0:e+i+o},"margin-box-width":function(t){var e=this.get("border-box-width"),i=this.get("margin-left"),o=this.get("margin-right");return e<=0?0:e+i+o},top:function(t){return t.positionedOffset().top},bottom:function(t){var e=t.positionedOffset();return t.getOffsetParent().measure("height")-this.get("border-box-height")-e.top},left:function(t){return t.positionedOffset().left},right:function(t){var e=t.positionedOffset();return t.getOffsetParent().measure("width")-this.get("border-box-width")-e.left},"padding-top":function(t){return i(t,"paddingTop")},"padding-bottom":function(t){return i(t,"paddingBottom")},"padding-left":function(t){return i(t,"paddingLeft")},"padding-right":function(t){return i(t,"paddingRight")},"border-top":function(t){return i(t,"borderTopWidth")},"border-bottom":function(t){return i(t,"borderBottomWidth")},"border-left":function(t){return i(t,"borderLeftWidth")},"border-right":function(t){return i(t,"borderRightWidth")},"margin-top":function(t){return i(t,"marginTop")},"margin-bottom":function(t){return i(t,"marginBottom")},"margin-left":function(t){return i(t,"marginLeft")},"margin-right":function(t){return i(t,"marginRight")}}}),"getBoundingClientRect"in document.documentElement&&Object.extend(Element.Layout.COMPUTATIONS,{right:function(t){var e=n(t.getOffsetParent()),t=t.getBoundingClientRect();return(e.getBoundingClientRect().right-t.right).round()},bottom:function(t){var e=n(t.getOffsetParent()),t=t.getBoundingClientRect();return(e.getBoundingClientRect().bottom-t.bottom).round()}}),Element.Offset=Class.create({initialize:function(t,e){this.left=t.round(),this.top=e.round(),this[0]=this.left,this[1]=this.top},relativeTo:function(t){return new Element.Offset(this.left-t.left,this.top-t.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}}),Prototype.Browser.IE?(o=o.wrap(function(t,e){if(c(e=$(e))||h(e)||r(e)||l(e))return $(document.body);var i=e.getStyle("position");if("static"!==i)return t(e);e.setStyle({position:"relative"});t=t(e);return e.setStyle({position:i}),t}),e=e.wrap(function(t,e){var i,o;return(e=$(e)).parentNode?"static"!==(i=e.getStyle("position"))?t(e):((o=e.getOffsetParent())&&"fixed"===o.getStyle("position")&&n(o),e.setStyle({position:"relative"}),o=t(e),e.setStyle({position:i}),o):new Element.Offset(0,0)})):Prototype.Browser.Webkit&&(t=function(t){t=$(t);for(var e=0,i=0;e+=t.offsetTop||0,i+=t.offsetLeft||0,(t.offsetParent!=document.body||"absolute"!=Element.getStyle(t,"position"))&&(t=t.offsetParent););return new Element.Offset(i,e)}),Element.addMethods({getLayout:function(t,e){return new Element.Layout(t,e)},measure:function(t,e){return $(t).getLayout().get(e)},getWidth:function(t){return Element.getDimensions(t).width},getHeight:function(t){return Element.getDimensions(t).height},getDimensions:function(t){t=$(t);var e,i=Element.getStyle(t,"display");return i&&"none"!==i?{width:t.offsetWidth,height:t.offsetHeight}:(i={visibility:"hidden",display:"block"},"fixed"!==(e={visibility:(e=t.style).visibility,position:e.position,display:e.display}).position&&(i.position="absolute"),Element.setStyle(t,i),i={width:t.offsetWidth,height:t.offsetHeight},Element.setStyle(t,e),i)},getOffsetParent:o,cumulativeOffset:t,positionedOffset:e,cumulativeScrollOffset:function(t){var e=0,i=0;do{if(t===document.body){var o=document.documentElement||document.body.parentNode||document.body;e+=Object.isUndefined(window.pageYOffset)?o.scrollTop||0:window.pageYOffset,i+=Object.isUndefined(window.pageXOffset)?o.scrollLeft||0:window.pageXOffset;break}}while(e+=t.scrollTop||0,i+=t.scrollLeft||0,t=t.parentNode);return new Element.Offset(i,e)},viewportOffset:function(t){var e=0,i=0,o=document.body,n=t=$(t);do{if(e+=n.offsetTop||0,i+=n.offsetLeft||0,n.offsetParent==o&&"absolute"==Element.getStyle(n,"position"))break}while(n=n.offsetParent);for(n=t;n!=o&&(e-=n.scrollTop||0,i-=n.scrollLeft||0),n=n.parentNode;);return new Element.Offset(i,e)},absolutize:function(t){var e,i;return t=$(t),"absolute"!==Element.getStyle(t,"position")&&(i=o(t),e=t.viewportOffset(),i=i.viewportOffset(),e=e.relativeTo(i),i=t.getLayout(),t.store("prototype_absolutize_original_styles",{position:t.getStyle("position"),left:t.getStyle("left"),top:t.getStyle("top"),width:t.getStyle("width"),height:t.getStyle("height")}),t.setStyle({position:"absolute",top:e.top+"px",left:e.left+"px",width:i.get("width")+"px",height:i.get("height")+"px"})),t},relativize:function(t){var e;return t=$(t),"relative"!==Element.getStyle(t,"position")&&(e=t.retrieve("prototype_absolutize_original_styles"))&&t.setStyle(e),t},scrollTo:function(t){t=$(t);var e=Element.cumulativeOffset(t);return window.scrollTo(e.left,e.top),t},makePositioned:function(t){t=$(t);var e=Element.getStyle(t,"position"),i={};return"static"!==e&&e||(i.position="relative",Prototype.Browser.Opera&&(i.top=0,i.left=0),Element.setStyle(t,i),Element.store(t,"prototype_made_positioned",!0)),t},undoPositioned:function(t){t=$(t);var e=Element.getStorage(t);return e.get("prototype_made_positioned")&&(e.unset("prototype_made_positioned"),Element.setStyle(t,{position:"",top:"",bottom:"",left:"",right:""})),t},makeClipping:function(t){t=$(t);var e=Element.getStorage(t),i=e.get("prototype_made_clipping");return Object.isUndefined(i)&&(i=Element.getStyle(t,"overflow"),e.set("prototype_made_clipping",i),"hidden"!==i)&&(t.style.overflow="hidden"),t},undoClipping:function(t){t=$(t);var e=Element.getStorage(t),i=e.get("prototype_made_clipping");return Object.isUndefined(i)||(e.unset("prototype_made_clipping"),t.style.overflow=i||""),t},clonePosition:function(t,e,i){i=Object.extend({setLeft:!0,setTop:!0,setWidth:!0,setHeight:!0,offsetTop:0,offsetLeft:0},i||{}),e=$(e),t=$(t);var o,n,s,r,a={};return(i.setLeft||i.setTop)&&(s=Element.viewportOffset(e),r=[0,0],"absolute"===Element.getStyle(t,"position"))&&(n=Element.getOffsetParent(t))!==document.body&&(r=Element.viewportOffset(n)),(i.setWidth||i.setHeight)&&(o=Element.getLayout(e)),i.setLeft&&(a.left=s[0]-r[0]+i.offsetLeft+"px"),i.setTop&&(a.top=s[1]-r[1]+i.offsetTop+"px"),i.setWidth&&(a.width=o.get("border-box-width")+"px"),i.setHeight&&(a.height=o.get("border-box-height")+"px"),Element.setStyle(t,a)}}),"getBoundingClientRect"in document.documentElement&&Element.addMethods({viewportOffset:function(t){var e;return h(t=$(t))?new Element.Offset(0,0):(t=t.getBoundingClientRect(),e=document.documentElement,new Element.Offset(t.left-e.clientLeft,t.top-e.clientTop))}})}(),!function(){var t=Prototype.Browser.Opera&&window.parseFloat(window.opera.version())<9.5,e=null;function i(){return e=e||(t?document.body:document.documentElement)}document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return i().clientWidth},getHeight:function(){return i().clientHeight},getScrollOffsets:function(){var t=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;return new Element.Offset(t,e)}}}(),window.$$=function(){var t=$A(arguments).join(", ");return Prototype.Selector.select(t,document)},Prototype.Selector=function(){var t=Prototype.K;return{select:function(){throw new Error('Method "Prototype.Selector.select" must be defined.')},match:function(){throw new Error('Method "Prototype.Selector.match" must be defined.')},find:function(t,e,i){i=i||0;for(var o=Prototype.Selector.match,n=t.length,s=0,r=0;r<n;r++)if(o(t[r],e)&&i==s++)return Element.extend(t[r])},extendElements:Element.extend===t?t:function(t){for(var e=0,i=t.length;e<i;e++)Element.extend(t[e]);return t},extendElement:Element.extend}}(),Prototype._original_property=window.Sizzle,!function(i){function u(t,e,i){var o="0x"+e-65536;return o!=o||i?e:o<0?String.fromCharCode(65536+o):String.fromCharCode(o>>10|55296,1023&o|56320)}var t,p,E,s,L,H,R,S,c,h,d,w,e,f,m,o,n,g,y="sizzle"+-new Date,b=i.document,C=0,B=0,W=lt(),F=lt(),U=lt(),G=function(t,e){return t===e&&(h=!0),0},r="undefined",z={}.hasOwnProperty,a=[],V=a.pop,$=a.push,x=a.push,K=a.slice,v=a.indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(this[e]===t)return e;return-1},q="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",_="[\\x20\\t\\r\\n\\f]",l="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",J=l.replace("w","w#"),Z="\\["+_+"*("+l+")"+_+"*(?:([*^$|!~]?=)"+_+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+J+")|)|)"+_+"*\\]",Y=":("+l+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+Z.replace(3,8)+")*)|.*)\\)|)",k=new RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),X=new RegExp("^"+_+"*,"+_+"*"),Q=new RegExp("^"+_+"*([>+~]|"+_+")"+_+"*"),tt=new RegExp("="+_+"*([^\\]'\"]*?)"+_+"*\\]","g"),et=new RegExp(Y),it=new RegExp("^"+J+"$"),O={ID:new RegExp("^#("+l+")"),CLASS:new RegExp("^\\.("+l+")"),TAG:new RegExp("^("+l.replace("w","w*")+")"),ATTR:new RegExp("^"+Z),PSEUDO:new RegExp("^"+Y),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),bool:new RegExp("^(?:"+q+")$","i"),needsContext:new RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},ot=/^(?:input|select|textarea|button)$/i,nt=/^h\d$/i,P=/^[^{]+\{\s*\[native \w/,st=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rt=/[+~]/,at=/'|\\/g,M=new RegExp("\\\\([\\da-f]{1,6}"+_+"?|("+_+")|.)","ig");try{x.apply(a=K.call(b.childNodes),b.childNodes),a[b.childNodes.length].nodeType}catch(t){x={apply:a.length?function(t,e){$.apply(t,K.call(e))}:function(t,e){for(var i=t.length,o=0;t[i++]=e[o++];);t.length=i-1}}}function T(t,e,i,o){var n,s,r,a,l,c,h;if((e?e.ownerDocument||e:b)!==w&&d(e),i=i||[],!t||"string"!=typeof t)return i;if(1!==(n=(e=e||w).nodeType)&&9!==n)return[];if(f&&!o){if(c=st.exec(t))if(h=c[1]){if(9===n){if(!(a=e.getElementById(h))||!a.parentNode)return i;if(a.id===h)return i.push(a),i}else if(e.ownerDocument&&(a=e.ownerDocument.getElementById(h))&&g(e,a)&&a.id===h)return i.push(a),i}else{if(c[2])return x.apply(i,e.getElementsByTagName(t)),i;if((h=c[3])&&p.getElementsByClassName&&e.getElementsByClassName)return x.apply(i,e.getElementsByClassName(h)),i}if(p.qsa&&(!m||!m.test(t))){if(l=a=y,c=e,h=9===n&&t,1===n&&"object"!==e.nodeName.toLowerCase()){for(r=N(t),(a=e.getAttribute("id"))?l=a.replace(at,"\\$&"):e.setAttribute("id",l),l="[id='"+l+"'] ",s=r.length;s--;)r[s]=l+j(r[s]);c=rt.test(t)&&ut(e.parentNode)||e,h=r.join(",")}if(h)try{return x.apply(i,c.querySelectorAll(h)),i}catch(t){}finally{a||e.removeAttribute("id")}}}return R(t.replace(k,"$1"),e,i,o)}function lt(){var i=[];function o(t,e){return i.push(t+" ")>E.cacheLength&&delete o[i.shift()],o[t+" "]=e}return o}function I(t){return t[y]=!0,t}function A(t){var e=w.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function ct(t,e){for(var i=t.split("|"),o=t.length;o--;)E.attrHandle[i[o]]=e}function ht(t,e){var i=e&&t,o=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(o)return o;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function D(r){return I(function(s){return s=+s,I(function(t,e){for(var i,o=r([],t.length,s),n=o.length;n--;)t[i=o[n]]&&(t[i]=!(e[i]=t[i]))})})}function ut(t){return t&&typeof t.getElementsByTagName!==r&&t}for(t in p=T.support={},L=T.isXML=function(t){t=t&&(t.ownerDocument||t).documentElement;return!!t&&"HTML"!==t.nodeName},d=T.setDocument=function(t){var l=t?t.ownerDocument||t:b,t=l.defaultView;return l!==w&&9===l.nodeType&&l.documentElement?(e=(w=l).documentElement,f=!L(l),t&&t!==t.top&&(t.addEventListener?t.addEventListener("unload",function(){d()},!1):t.attachEvent&&t.attachEvent("onunload",function(){d()})),p.attributes=A(function(t){return t.className="i",!t.getAttribute("className")}),p.getElementsByTagName=A(function(t){return t.appendChild(l.createComment("")),!t.getElementsByTagName("*").length}),p.getElementsByClassName=P.test(l.getElementsByClassName)&&A(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),p.getById=A(function(t){return e.appendChild(t).id=y,!l.getElementsByName||!l.getElementsByName(y).length}),p.getById?(E.find.ID=function(t,e){if(typeof e.getElementById!==r&&f)return(e=e.getElementById(t))&&e.parentNode?[e]:[]},E.filter.ID=function(t){var e=t.replace(M,u);return function(t){return t.getAttribute("id")===e}}):(delete E.find.ID,E.filter.ID=function(t){var e=t.replace(M,u);return function(t){t=typeof t.getAttributeNode!==r&&t.getAttributeNode("id");return t&&t.value===e}}),E.find.TAG=p.getElementsByTagName?function(t,e){if(typeof e.getElementsByTagName!==r)return e.getElementsByTagName(t)}:function(t,e){var i,o=[],n=0,s=e.getElementsByTagName(t);if("*"!==t)return s;for(;i=s[n++];)1===i.nodeType&&o.push(i);return o},E.find.CLASS=p.getElementsByClassName&&function(t,e){if(typeof e.getElementsByClassName!==r&&f)return e.getElementsByClassName(t)},o=[],m=[],(p.qsa=P.test(l.querySelectorAll))&&(A(function(t){t.innerHTML="<select t=''><option selected=''></option></select>",t.querySelectorAll("[t^='']").length&&m.push("[*^$]="+_+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+_+"*(?:value|"+q+")"),t.querySelectorAll(":checked").length||m.push(":checked")}),A(function(t){var e=l.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+_+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")})),(p.matchesSelector=P.test(n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.msMatchesSelector))&&A(function(t){p.disconnectedMatch=n.call(t,"div"),n.call(t,"[s!='']:x"),o.push("!=",Y)}),m=m.length&&new RegExp(m.join("|")),o=o.length&&new RegExp(o.join("|")),t=P.test(e.compareDocumentPosition),g=t||P.test(e.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(i.contains?i.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},G=t?function(t,e){var i;return t===e?(h=!0,0):(i=!t.compareDocumentPosition-!e.compareDocumentPosition)||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!p.sortDetached&&e.compareDocumentPosition(t)===i?t===l||t.ownerDocument===b&&g(b,t)?-1:e===l||e.ownerDocument===b&&g(b,e)?1:c?v.call(c,t)-v.call(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var i,o=0,n=t.parentNode,s=e.parentNode,r=[t],a=[e];if(!n||!s)return t===l?-1:e===l?1:n?-1:s?1:c?v.call(c,t)-v.call(c,e):0;if(n===s)return ht(t,e);for(i=t;i=i.parentNode;)r.unshift(i);for(i=e;i=i.parentNode;)a.unshift(i);for(;r[o]===a[o];)o++;return o?ht(r[o],a[o]):r[o]===b?-1:a[o]===b?1:0},l):w},T.matches=function(t,e){return T(t,null,null,e)},T.matchesSelector=function(t,e){if((t.ownerDocument||t)!==w&&d(t),e=e.replace(tt,"='$1']"),p.matchesSelector&&f&&(!o||!o.test(e))&&(!m||!m.test(e)))try{var i=n.call(t,e);if(i||p.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return 0<T(e,w,null,[t]).length},T.contains=function(t,e){return(t.ownerDocument||t)!==w&&d(t),g(t,e)},T.attr=function(t,e){(t.ownerDocument||t)!==w&&d(t);var i=E.attrHandle[e.toLowerCase()],i=i&&z.call(E.attrHandle,e.toLowerCase())?i(t,e,!f):void 0;return void 0!==i?i:p.attributes||!f?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},T.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},T.uniqueSort=function(t){var e,i=[],o=0,n=0;if(h=!p.detectDuplicates,c=!p.sortStable&&t.slice(0),t.sort(G),h){for(;e=t[n++];)e===t[n]&&(o=i.push(n));for(;o--;)t.splice(i[o],1)}return c=null,t},s=T.getText=function(t){var e,i="",o=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=s(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[o++];)i+=s(e);return i},(E=T.selectors={cacheLength:50,createPseudo:I,match:O,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(M,u),t[3]=(t[4]||t[5]||"").replace(M,u),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||T.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&T.error(t[0]),t},PSEUDO:function(t){var e,i=!t[5]&&t[2];return O.CHILD.test(t[0])?null:(t[3]&&void 0!==t[4]?t[2]=t[4]:i&&et.test(i)&&(e=(e=N(i,!0))&&i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(M,u).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+_+")"+t+"("+_+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==r&&t.getAttribute("class")||"")})},ATTR:function(e,i,o){return function(t){t=T.attr(t,e);return null==t?"!="===i:!i||(t+="","="===i?t===o:"!="===i?t!==o:"^="===i?o&&0===t.indexOf(o):"*="===i?o&&-1<t.indexOf(o):"$="===i?o&&t.slice(-o.length)===o:"~="===i?-1<(" "+t+" ").indexOf(o):"|="===i&&(t===o||t.slice(0,o.length+1)===o+"-"))}},CHILD:function(d,t,e,f,m){var g="nth"!==d.slice(0,3),b="last"!==d.slice(-4),v="of-type"===t;return 1===f&&0===m?function(t){return!!t.parentNode}:function(t,e,i){var o,n,s,r,a,l,c=g!=b?"nextSibling":"previousSibling",h=t.parentNode,u=v&&t.nodeName.toLowerCase(),p=!i&&!v;if(h){if(g){for(;c;){for(s=t;s=s[c];)if(v?s.nodeName.toLowerCase()===u:1===s.nodeType)return!1;l=c="only"===d&&!l&&"nextSibling"}return!0}if(l=[b?h.firstChild:h.lastChild],b&&p){for(a=(o=(n=h[y]||(h[y]={}))[d]||[])[0]===C&&o[1],r=o[0]===C&&o[2],s=a&&h.childNodes[a];s=++a&&s&&s[c]||(r=a=0,l.pop());)if(1===s.nodeType&&++r&&s===t){n[d]=[C,a,r];break}}else if(p&&(o=(t[y]||(t[y]={}))[d])&&o[0]===C)r=o[1];else for(;(s=++a&&s&&s[c]||(r=a=0,l.pop()))&&((v?s.nodeName.toLowerCase()!==u:1!==s.nodeType)||!++r||(p&&((s[y]||(s[y]={}))[d]=[C,r]),s!==t)););return(r-=m)===f||r%f==0&&0<=r/f}}},PSEUDO:function(t,s){var e,r=E.pseudos[t]||E.setFilters[t.toLowerCase()]||T.error("unsupported pseudo: "+t);return r[y]?r(s):1<r.length?(e=[t,t,"",s],E.setFilters.hasOwnProperty(t.toLowerCase())?I(function(t,e){for(var i,o=r(t,s),n=o.length;n--;)t[i=v.call(t,o[n])]=!(e[i]=o[n])}):function(t){return r(t,0,e)}):r}},pseudos:{not:I(function(t){var o=[],n=[],a=H(t.replace(k,"$1"));return a[y]?I(function(t,e,i,o){for(var n,s=a(t,null,o,[]),r=t.length;r--;)(n=s[r])&&(t[r]=!(e[r]=n))}):function(t,e,i){return o[0]=t,a(o,null,i,n),!n.pop()}}),has:I(function(e){return function(t){return 0<T(e,t).length}}),contains:I(function(e){return function(t){return-1<(t.textContent||t.innerText||s(t)).indexOf(e)}}),lang:I(function(i){return it.test(i||"")||T.error("unsupported lang: "+i),i=i.replace(M,u).toLowerCase(),function(t){var e;do{if(e=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===i||0===e.indexOf(i+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=i.location&&i.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===e},focus:function(t){return t===w.activeElement&&(!w.hasFocus||w.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!E.pseudos.empty(t)},header:function(t){return nt.test(t.nodeName)},input:function(t){return ot.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(t=t.getAttribute("type"))||"text"===t.toLowerCase())},first:D(function(){return[0]}),last:D(function(t,e){return[e-1]}),eq:D(function(t,e,i){return[i<0?i+e:i]}),even:D(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:D(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:D(function(t,e,i){for(var o=i<0?i+e:i;0<=--o;)t.push(o);return t}),gt:D(function(t,e,i){for(var o=i<0?i+e:i;++o<e;)t.push(o);return t})}}).pseudos.nth=E.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[t]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(t);for(t in{submit:!0,reset:!0})E.pseudos[t]=function(i){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===i}}(t);function pt(){}function N(t,e){var i,o,n,s,r,a,l,c=F[t+" "];if(c)return e?0:c.slice(0);for(r=t,a=[],l=E.preFilter;r;){for(s in i&&!(o=X.exec(r))||(o&&(r=r.slice(o[0].length)||r),a.push(n=[])),i=!1,(o=Q.exec(r))&&(i=o.shift(),n.push({value:i,type:o[0].replace(k," ")}),r=r.slice(i.length)),E.filter)!(o=O[s].exec(r))||l[s]&&!(o=l[s](o))||(i=o.shift(),n.push({value:i,type:s,matches:o}),r=r.slice(i.length));if(!i)break}return e?r.length:r?T.error(t):F(t,a).slice(0)}function j(t){for(var e=0,i=t.length,o="";e<i;e++)o+=t[e].value;return o}function dt(r,t,e){var a=t.dir,l=e&&"parentNode"===a,c=B++;return t.first?function(t,e,i){for(;t=t[a];)if(1===t.nodeType||l)return r(t,e,i)}:function(t,e,i){var o,n,s=[C,c];if(i){for(;t=t[a];)if((1===t.nodeType||l)&&r(t,e,i))return!0}else for(;t=t[a];)if(1===t.nodeType||l){if((o=(n=t[y]||(t[y]={}))[a])&&o[0]===C&&o[1]===c)return s[2]=o[2];if((n[a]=s)[2]=r(t,e,i))return!0}}}function ft(n){return 1<n.length?function(t,e,i){for(var o=n.length;o--;)if(!n[o](t,e,i))return!1;return!0}:n[0]}function mt(t,e,i,o,n){for(var s,r=[],a=0,l=t.length,c=null!=e;a<l;a++)!(s=t[a])||i&&!i(s,o,n)||(r.push(s),c&&e.push(a));return r}function gt(d,f,m,g,b,t){return g&&!g[y]&&(g=gt(g)),b&&!b[y]&&(b=gt(b,t)),I(function(t,e,i,o){var n,s,r,a=[],l=[],c=e.length,h=t||function(t,e,i){for(var o=0,n=e.length;o<n;o++)T(t,e[o],i);return i}(f||"*",i.nodeType?[i]:i,[]),u=!d||!t&&f?h:mt(h,a,d,i,o),p=m?b||(t?d:c||g)?[]:e:u;if(m&&m(u,p,i,o),g)for(n=mt(p,l),g(n,[],i,o),s=n.length;s--;)(r=n[s])&&(p[l[s]]=!(u[l[s]]=r));if(t){if(b||d){if(b){for(n=[],s=p.length;s--;)(r=p[s])&&n.push(u[s]=r);b(null,p=[],n,o)}for(s=p.length;s--;)(r=p[s])&&-1<(n=b?v.call(t,r):a[s])&&(t[n]=!(e[n]=r))}}else p=mt(p===e?p.splice(c,p.length):p),b?b(null,e,p,o):x.apply(e,p)})}function bt(g,b){function t(t,e,i,o,n){var s,r,a,l=0,c="0",h=t&&[],u=[],p=S,d=t||y&&E.find.TAG("*",n),f=C+=null==p?1:Math.random()||.1,m=d.length;for(n&&(S=e!==w&&e);c!==m&&null!=(s=d[c]);c++){if(y&&s){for(r=0;a=g[r++];)if(a(s,e,i)){o.push(s);break}n&&(C=f)}v&&((s=!a&&s)&&l--,t)&&h.push(s)}if(l+=c,v&&c!==l){for(r=0;a=b[r++];)a(h,u,e,i);if(t){if(0<l)for(;c--;)h[c]||u[c]||(u[c]=V.call(o));u=mt(u)}x.apply(o,u),n&&!t&&0<u.length&&1<l+b.length&&T.uniqueSort(o)}return n&&(C=f,S=p),h}var v=0<b.length,y=0<g.length;return v?I(t):t}pt.prototype=E.filters=E.pseudos,E.setFilters=new pt,H=T.compile=function(t,e){var i,o=[],n=[],s=U[t+" "];if(!s){for(i=(e=e||N(t)).length;i--;)((s=function t(e){for(var o,i,n,s=e.length,r=E.relative[e[0].type],a=r||E.relative[" "],l=r?1:0,c=dt(function(t){return t===o},a,!0),h=dt(function(t){return-1<v.call(o,t)},a,!0),u=[function(t,e,i){return!r&&(i||e!==S)||((o=e).nodeType?c:h)(t,e,i)}];l<s;l++)if(i=E.relative[e[l].type])u=[dt(ft(u),i)];else{if((i=E.filter[e[l].type].apply(null,e[l].matches))[y]){for(n=++l;n<s&&!E.relative[e[n].type];n++);return gt(1<l&&ft(u),1<l&&j(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(k,"$1"),i,l<n&&t(e.slice(l,n)),n<s&&t(e=e.slice(n)),n<s&&j(e))}u.push(i)}return ft(u)}(e[i]))[y]?o:n).push(s);(s=U(t,bt(n,o))).selector=t}return s},R=T.select=function(t,e,i,o){var n,s,r,a,l,c="function"==typeof t&&t,h=!o&&N(t=c.selector||t);if(i=i||[],1===h.length){if(2<(s=h[0]=h[0].slice(0)).length&&"ID"===(r=s[0]).type&&p.getById&&9===e.nodeType&&f&&E.relative[s[1].type]){if(!(e=(E.find.ID(r.matches[0].replace(M,u),e)||[])[0]))return i;c&&(e=e.parentNode),t=t.slice(s.shift().value.length)}for(n=O.needsContext.test(t)?0:s.length;n--&&(r=s[n],!E.relative[a=r.type]);)if((l=E.find[a])&&(o=l(r.matches[0].replace(M,u),rt.test(s[0].type)&&ut(e.parentNode)||e))){if(s.splice(n,1),t=o.length&&j(s))break;return x.apply(i,o),i}}return(c||H(t,h))(o,e,!f,i,rt.test(t)&&ut(e.parentNode)||e),i},p.sortStable=y.split("").sort(G).join("")===y,p.detectDuplicates=!!h,d(),p.sortDetached=A(function(t){return 1&t.compareDocumentPosition(w.createElement("div"))}),A(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ct("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),p.attributes&&A(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ct("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),A(function(t){return null==t.getAttribute("disabled")})||ct(q,function(t,e,i){if(!i)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),"function"==typeof define&&define.amd?define(function(){return T}):"undefined"!=typeof module&&module.exports?module.exports=T:i.Sizzle=T}(window),!function(i){var o=Prototype.Selector.extendElements;Prototype.Selector.engine=i,Prototype.Selector.select=function(t,e){return o(i(t,e||document))},Prototype.Selector.match=function(t,e){return 1==i.matches(e,[t]).length}}(Sizzle),window.Sizzle=Prototype._original_property,delete Prototype._original_property,{reset:function(t){return(t=$(t)).reset(),t},serializeElements:function(t,e){"object"!=typeof e?e={hash:!!e}:Object.isUndefined(e.hash)&&(e.hash=!0);var i,o,n,s=!1,r=e.submit,a=e.hash?(n={},function(t,e,i){return e in t?(Object.isArray(t[e])||(t[e]=[t[e]]),t[e]=t[e].concat(i)):t[e]=i,t}):(n="",function(t,e,i){var o;return(i=Object.isArray(i)?i:[i]).length?(o=encodeURIComponent(e).gsub(/%20/,"+"),t+(t?"&":"")+i.map(function(t){return t=t.gsub(/(\r)?\n/,"\r\n"),t=(t=encodeURIComponent(t)).gsub(/%20/,"+"),o+"="+t}).join("&")):t});return t.inject(n,function(t,e){return!e.disabled&&e.name&&(i=e.name,null==(o=$(e).getValue())||"file"==e.type||"submit"==e.type&&(s||!1===r||r&&i!=r||!(s=!0))||(t=a(t,i,o))),t})},Methods:{serialize:function(t,e){return Form.serializeElements(Form.getElements(t),e)},getElements:function(t){for(var e,i=$(t).getElementsByTagName("*"),o=[],n=Form.Element.Serializers,s=0;e=i[s];s++)n[e.tagName.toLowerCase()]&&o.push(Element.extend(e));return o},getInputs:function(t,e,i){var o=(t=$(t)).getElementsByTagName("input");if(!e&&!i)return $A(o).map(Element.extend);for(var n=0,s=[],r=o.length;n<r;n++){var a=o[n];e&&a.type!=e||i&&a.name!=i||s.push(Element.extend(a))}return s},disable:function(t){return t=$(t),Form.getElements(t).invoke("disable"),t},enable:function(t){return t=$(t),Form.getElements(t).invoke("enable"),t},findFirstElement:function(t){var t=$(t).getElements().findAll(function(t){return"hidden"!=t.type&&!t.disabled}),e=t.findAll(function(t){return t.hasAttribute("tabIndex")&&0<=t.tabIndex}).sortBy(function(t){return t.tabIndex}).first();return e||t.find(function(t){return/^(?:input|select|textarea)$/i.test(t.tagName)})},focusFirstElement:function(t){var e=(t=$(t)).findFirstElement();return e&&e.activate(),t},request:function(t,e){t=$(t);var i=(e=Object.clone(e||{})).parameters,o=t.readAttribute("action")||"";return o.blank()&&(o=window.location.href),e.parameters=t.serialize(!0),i&&(Object.isString(i)&&(i=i.toQueryParams()),Object.extend(e.parameters,i)),t.hasAttribute("method")&&!e.method&&(e.method=t.method),new Ajax.Request(o,e)}},Element:{focus:function(t){return $(t).focus(),t},select:function(t){return $(t).select(),t}}}),Field=(Form.Element.Methods={serialize:function(t){if(!(t=$(t)).disabled&&t.name){var e,i=t.getValue();if(null!=i)return(e={})[t.name]=i,Object.toQueryString(e)}return""},getValue:function(t){var e=(t=$(t)).tagName.toLowerCase();return Form.Element.Serializers[e](t)},setValue:function(t,e){var i=(t=$(t)).tagName.toLowerCase();return Form.Element.Serializers[i](t,e),t},clear:function(t){return $(t).value="",t},present:function(t){return""!=$(t).value},activate:function(t){t=$(t);try{t.focus(),!t.select||"input"==t.tagName.toLowerCase()&&/^(?:button|reset|submit)$/i.test(t.type)||t.select()}catch(t){}return t},disable:function(t){return(t=$(t)).disabled=!0,t},enable:function(t){return(t=$(t)).disabled=!1,t}},Form.Element),$F=Form.Element.Methods.getValue,Toggle=(Form.Element.Serializers=function(){function i(t,e){if(Object.isUndefined(e))return t.checked?t.value:null;t.checked=!!e}function o(t,e){if(Object.isUndefined(e))return t.value;t.value=e}function a(t){var e=t.selectedIndex;return 0<=e?s(t.options[e]):null}function l(t){var e=t.length;if(!e)return null;for(var i=0,o=[];i<e;i++){var n=t.options[i];n.selected&&o.push(s(n))}return o}function s(t){return Element.hasAttribute(t,"value")?t.value:t.text}return{input:function(t,e){switch(t.type.toLowerCase()){case"checkbox":case"radio":return i(t,e);default:return o(t,e)}},inputSelector:i,textarea:o,select:function(t,e){if(Object.isUndefined(e))return("select-one"===t.type?a:l)(t);for(var i,o,n=!Object.isArray(e),s=0,r=t.length;s<r;s++)if(i=t.options[s],o=this.optionValue(i),n){if(o==e)return void(i.selected=!0)}else i.selected=e.include(o)},selectOne:a,selectMany:l,optionValue:s,button:o}}(),Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function(t,e,i,o){t(o,i),this.element=$(e),this.lastValue=this.getValue()},execute:function(){var t=this.getValue();(Object.isString(this.lastValue)&&Object.isString(t)?this.lastValue!=t:String(this.lastValue)!=String(t))&&(this.callback(this.element,t),this.lastValue=t)}}),Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}}),Abstract.EventObserver=Class.create({initialize:function(t,e){this.element=$(t),this.callback=e,this.lastValue=this.getValue(),"form"==this.element.tagName.toLowerCase()?this.registerFormCallbacks():this.registerCallback(this.element)},onElementEvent:function(){var t=this.getValue();this.lastValue!=t&&(this.callback(this.element,t),this.lastValue=t)},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(t){if(t.type)switch(t.type.toLowerCase()){case"checkbox":case"radio":Event.observe(t,"click",this.onElementEvent.bind(this));break;default:Event.observe(t,"change",this.onElementEvent.bind(this))}}}),Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}}),Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}}),!function(d){var e,t=document.createElement("div"),i=document.documentElement,i="onmouseenter"in i&&"onmouseleave"in i,s={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45},o=function(t){return!1};function n(t,e){return t.which?t.which===e+1:t.button===e}window.attachEvent&&(o=window.addEventListener?function(t){return!(t instanceof window.Event)}:function(t){return!0});var r={0:1,1:4,2:2};function a(t,e){return t.button===r[e]}function l(t){var e=(t=s.extend(t)).target,i=t.type,t=t.currentTarget;return(e=t&&t.tagName&&("load"===i||"error"===i||"click"===i&&"input"===t.tagName.toLowerCase()&&"radio"===t.type)?t:e).nodeType==Node.TEXT_NODE?e.parentNode:e}function c(t){var e=document.documentElement,i=document.body||{scrollLeft:0};return t.pageX||t.clientX+(e.scrollLeft||i.scrollLeft)-(e.clientLeft||0)}function h(t){var e=document.documentElement,i=document.body||{scrollTop:0};return t.pageY||t.clientY+(e.scrollTop||i.scrollTop)-(e.clientTop||0)}e=window.attachEvent?window.addEventListener?function(t,e){return(o(t)?a:n)(t,e)}:a:Prototype.Browser.WebKit?function(t,e){switch(e){case 0:return 1==t.which&&!t.metaKey;case 1:return 2==t.which||1==t.which&&t.metaKey;case 2:return 3==t.which;default:return!1}}:n,s.Methods={isLeftClick:function(t){return e(t,0)},isMiddleClick:function(t){return e(t,1)},isRightClick:function(t){return e(t,2)},element:function(t){return Element.extend(l(t))},findElement:function(t,e){var i=l(t),o=Prototype.Selector;if(!e)return Element.extend(i);for(;i;){if(Object.isElement(i)&&o.match(i,e))return Element.extend(i);i=i.parentNode}},pointer:function(t){return{x:c(t),y:h(t)}},pointerX:c,pointerY:h,stop:function(t){s.extend(t),t.preventDefault(),t.stopPropagation(),t.stopped=!0}};var u,p=Object.keys(s.Methods).inject({},function(t,e){return t[e]=s.Methods[e].methodize(),t});window.attachEvent?(u={stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.returnValue=!1},inspect:function(){return"[object Event]"}},s.extend=function(t,e){var i;return!!t&&(o(t)&&!t._extendedByPrototype&&(t._extendedByPrototype=Prototype.emptyFunction,i=s.pointer(t),Object.extend(t,{target:t.srcElement||e,relatedTarget:function(t){var e;switch(t.type){case"mouseover":case"mouseenter":e=t.fromElement;break;case"mouseout":case"mouseleave":e=t.toElement;break;default:return null}return Element.extend(e)}(t),pageX:i.x,pageY:i.y}),Object.extend(t,p),Object.extend(t,u)),t)}):s.extend=Prototype.K,window.addEventListener&&(s.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__,Object.extend(s.prototype,p));var f={mouseenter:"mouseover",mouseleave:"mouseout"};function m(t){return f[t]||t}function g(t){return t===window?0:(void 0===t._prototypeUID&&(t._prototypeUID=Element.Storage.UID++),t._prototypeUID)}function b(t){return t.include(":")}function v(t,e){var i=d.Event.cache;return i[e=Object.isUndefined(e)?g(t):e]||(i[e]={element:t}),i[e]}function y(t,e,i){i=function(t,e,i){for(var o=v(t),n=(o[e]||(o[e]=[]),o[e]),s=n.length;s--;)if(n[s].handler===i)return null;return o=g(t),t={responder:d.Event._createResponder(o,e,i),handler:i},n.push(t),t}(t=$(t),e,i);if(null!==i){i=i.responder;if(b(e))n=i,(o=t).addEventListener?o.addEventListener("dataavailable",n,!1):(o.attachEvent("ondataavailable",n),o.attachEvent("onlosecapture",n));else{var o=t,n=e,e=i;n=m(n),o.addEventListener?o.addEventListener(n,e,!1):o.attachEvent("on"+n,e)}}return t}function E(t,e,i){t=$(t);var o=!Object.isUndefined(i);if(!Object.isUndefined(e)||o)if(o){o=function(t,e,i){var o=v(t)[e];if(o){for(var n,s=o.length;s--;)if(o[s].handler===i){n=o[s];break}if(n)return t=o.indexOf(n),o.splice(t,1),n}}(t,e,i);o&&S(t,e,o.responder)}else{var n=t,s=e,i=v(n),r=i[s];if(r){delete i[s];for(var a=r.length;a--;)S(n,s,r[a].responder)}}else{var l,c,h,u=t,o=g(u),p=d.Event.cache[o];if(p){e=u;for(h in Object.isUndefined(o)&&(o=g(e)),delete d.Event.cache[o],p)if("element"!==h)for(l=p[h],c=l.length;c--;)S(u,h,l[c].responder)}}return t}function S(t,e,i){var o,n;b(e)?(n=i,(o=t).removeEventListener?o.removeEventListener("dataavailable",n,!1):(o.detachEvent("ondataavailable",n),o.detachEvent("onlosecapture",n))):(o=t,n=i,t=m(t=e),o.removeEventListener?o.removeEventListener(t,n,!1):o.detachEvent("on"+t,n))}function w(t,e,i,o){t=(n=$(t))===document&&document.createEvent&&!n.dispatchEvent?document.documentElement:n,Object.isUndefined(o)&&(o=!0);var n=C(t,e,i=i||{},o);return s.extend(n)}i&&(m=Prototype.K),"uniqueID"in t&&(g=function(t){return t===window?0:t==document?1:t.uniqueID}),s._isCustomEvent=b;var C=document.createEvent?function(t,e,i,o){var n=document.createEvent("HTMLEvents");return n.initEvent("dataavailable",o,!0),n.eventName=e,n.memo=i,t.dispatchEvent(n),n}:function(t,e,i,o){var n=document.createEventObject();return n.eventType=o?"ondataavailable":"onlosecapture",n.eventName=e,n.memo=i,t.fireEvent(n.eventType,n),n};function x(t,e,i,o){return t=$(t),Object.isFunction(i)&&Object.isUndefined(o)&&(o=i,i=null),new s.Handler(t,e,i,o).start()}s.Handler=Class.create({initialize:function(t,e,i,o){this.element=$(t),this.eventName=e,this.selector=i,this.callback=o,this.handler=this.handleEvent.bind(this)},start:function(){return s.observe(this.element,this.eventName,this.handler),this},stop:function(){return s.stopObserving(this.element,this.eventName,this.handler),this},handleEvent:function(t){var e=s.findElement(t,this.selector);e&&this.callback.call(this.element,t,e)}}),Object.extend(s,s.Methods),Object.extend(s,{fire:w,observe:y,stopObserving:E,on:x}),Element.addMethods({fire:w,observe:y,stopObserving:E,on:x}),Object.extend(document,{fire:w.methodize(),observe:y.methodize(),stopObserving:E.methodize(),on:x.methodize(),loaded:!1}),d.Event?Object.extend(window.Event,s):d.Event=s,d.Event.cache={},window.attachEvent&&window.attachEvent("onunload",function(){d.Event.cache=null})}(this),!function(t){var e=document.documentElement,c="onmouseenter"in e&&"onmouseleave"in e;t.Event._createResponder=function(i,t,o){var n,s,r,a,l;return Event._isCustomEvent(t)?(n=i,s=t,r=o,function(t){var e=Event.cache[n].element;return!Object.isUndefined(t.eventName)&&t.eventName===s&&(Event.extend(t,e),void r.call(e,t))}):(t=t,c||"mouseenter"!==t&&"mouseleave"!==t?function(t){var e;Event.cache&&(e=Event.cache[i].element,Event.extend(t,e),o.call(e,t))}:(a=i,l=o,function(t){for(var e=Event.cache[a].element,i=(Event.extend(t,e),t.relatedTarget);i&&i!==e;)try{i=i.parentNode}catch(t){i=e}i!==e&&l.call(e,t)}))}}(this),!function(){var e;function i(){document.loaded||(e&&window.clearTimeout(e),document.loaded=!0,document.fire("dom:loaded"))}function o(){try{document.documentElement.doScroll("left")}catch(t){return void(e=o.defer())}i()}"complete"===document.readyState?i():(document.addEventListener?document.addEventListener("DOMContentLoaded",i,!1):(document.attachEvent("onreadystatechange",function t(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),i())}),window==top&&(e=o.defer())),Event.observe(window,"load",i))}(),Element.addMethods(),Hash.toQueryString=Object.toQueryString,{display:Element.toggle}),Insertion=(Element.Methods.childOf=Element.Methods.descendantOf,{Before:function(t,e){return Element.insert(t,{before:e})},Top:function(t,e){return Element.insert(t,{top:e})},Bottom:function(t,e){return Element.insert(t,{bottom:e})},After:function(t,e){return Element.insert(t,{after:e})}}),$continue=new Error('"throw $continue" is deprecated, use "return" instead'),Position={includeScrollOffsets:!1,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(t,e,i){return this.includeScrollOffsets?this.withinIncludingScrolloffsets(t,e,i):(this.xcomp=e,this.ycomp=i,this.offset=Element.cumulativeOffset(t),i>=this.offset[1]&&i<this.offset[1]+t.offsetHeight&&e>=this.offset[0]&&e<this.offset[0]+t.offsetWidth)},withinIncludingScrolloffsets:function(t,e,i){var o=Element.cumulativeScrollOffset(t);return this.xcomp=e+o[0]-this.deltaX,this.ycomp=i+o[1]-this.deltaY,this.offset=Element.cumulativeOffset(t),this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+t.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+t.offsetWidth},overlap:function(t,e){return t?"vertical"==t?(this.offset[1]+e.offsetHeight-this.ycomp)/e.offsetHeight:"horizontal"==t?(this.offset[0]+e.offsetWidth-this.xcomp)/e.offsetWidth:void 0:0},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(t){return Position.prepare(),Element.absolutize(t)},relativize:function(t){return Position.prepare(),Element.relativize(t)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(t,e,i){return i=i||{},Element.clonePosition(e,t,i)}},Window=(document.getElementsByClassName||(document.getElementsByClassName=function(){function i(t){return t.blank()?null:"[contains(concat(' ', @class, ' '), ' "+t+" ')]"}return Element.Methods.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(t,e){e=e.toString().strip();e=/\s/.test(e)?$w(e).map(i).join(""):i(e);return e?document._getElementsByXPath(".//*"+e,t):[]}:function(t,e){e=e.toString().strip();var i=[],o=/\s/.test(e)?$w(e):null;if(o||e){var n=$(t).getElementsByTagName("*");e=" "+e+" ";for(var s,r,a=0;s=n[a];a++)s.className&&(r=" "+s.className+" ")&&(r.include(e)||o&&o.all(function(t){return!t.toString().blank()&&r.include(" "+t+" ")}))&&i.push(Element.extend(s))}return i},function(t,e){return $(e||document.body).getElementsByClassName(t)}}()),Element.ClassNames=Class.create(),Element.ClassNames.prototype={initialize:function(t){this.element=$(t)},_each:function(t,e){this.element.className.split(/\s+/).select(function(t){return 0<t.length})._each(t,e)},set:function(t){this.element.className=t},add:function(t){this.include(t)||this.set($A(this).concat(t).join(" "))},remove:function(t){this.include(t)&&this.set($A(this).without(t).join(" "))},toString:function(){return $A(this).join(" ")}},Object.extend(Element.ClassNames.prototype,Enumerable),window.Selector=Class.create({initialize:function(t){this.expression=t.strip()},findElements:function(t){return Prototype.Selector.select(this.expression,t)},match:function(t){return Prototype.Selector.match(t,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}}),Object.extend(Selector,{matchElements:function(t,e){for(var i=Prototype.Selector.match,o=[],n=0,s=t.length;n<s;n++){var r=t[n];i(r,e)&&o.push(Element.extend(r))}return o},findElement:function(t,e,i){i=i||0;for(var o,n=0,s=0,r=t.length;s<r;s++)if(o=t[s],Prototype.Selector.match(o,e)&&i===n++)return Element.extend(o)},findChildElements:function(t,e){e=e.toArray().join(", ");return Prototype.Selector.select(e,t||document)}}),Class.create()),Windows=(Window.keepMultiModalWindow=!1,Window.hasEffectLib="undefined"!=typeof Effect,Window.resizeEffectDuration=.4,Window.prototype={initialize:function(){var t,e,i=0;0<arguments.length&&("string"==typeof arguments[0]?(t=arguments[0],i=1):t=arguments[0]?arguments[0].id:null),t=t||"window_"+(new Date).getTime(),$(t)&&alert("Window "+t+" is already registered in the DOM! Make sure you use setDestroyOnClose() or destroyOnClose: true in the constructor"),this.options=Object.extend({className:"dialog",blurClassName:null,minWidth:100,minHeight:20,resizable:!0,closable:!0,minimizable:!0,maximizable:!0,draggable:!0,userData:null,showEffect:Window.hasEffectLib?Effect.Appear:Element.show,hideEffect:Window.hasEffectLib?Effect.Fade:Element.hide,showEffectOptions:{},hideEffectOptions:{},effectOptions:null,parent:document.body,title:"&nbsp;",url:null,onload:Prototype.emptyFunction,width:200,height:300,opacity:1,recenterAuto:!0,wiredDrag:!1,closeCallback:null,destroyOnClose:!1,gridX:1,gridY:1},arguments[i]||{}),this.options.blurClassName&&(this.options.focusClassName=this.options.className),void 0===this.options.top&&void 0===this.options.bottom&&(this.options.top=this._round(500*Math.random(),this.options.gridY)),void 0===this.options.left&&void 0===this.options.right&&(this.options.left=this._round(500*Math.random(),this.options.gridX)),this.options.effectOptions&&(Object.extend(this.options.hideEffectOptions,this.options.effectOptions),Object.extend(this.options.showEffectOptions,this.options.effectOptions),this.options.showEffect==Element.Appear)&&(this.options.showEffectOptions.to=this.options.opacity),Window.hasEffectLib&&(this.options.showEffect==Effect.Appear&&(this.options.showEffectOptions.to=this.options.opacity),this.options.hideEffect==Effect.Fade)&&(this.options.hideEffectOptions.from=this.options.opacity),this.options.hideEffect==Element.hide&&(this.options.hideEffect=function(){Element.hide(this.element),this.options.destroyOnClose&&this.destroy()}.bind(this)),this.options.parent!=document.body&&(this.options.parent=$(this.options.parent)),this.element=this._createWindow(t),(this.element.win=this).eventMouseDown=this._initDrag.bindAsEventListener(this),this.eventMouseUp=this._endDrag.bindAsEventListener(this),this.eventMouseMove=this._updateDrag.bindAsEventListener(this),this.eventOnLoad=this._getWindowBorderSize.bindAsEventListener(this),this.eventMouseDownContent=this.toFront.bindAsEventListener(this),this.eventResize=this._recenter.bindAsEventListener(this),this.topbar=$(this.element.id+"_top"),this.bottombar=$(this.element.id+"_bottom"),this.content=$(this.element.id+"_content"),Event.observe(this.topbar,"mousedown",this.eventMouseDown),Event.observe(this.bottombar,"mousedown",this.eventMouseDown),Event.observe(this.content,"mousedown",this.eventMouseDownContent),Event.observe(window,"load",this.eventOnLoad),Event.observe(window,"resize",this.eventResize),Event.observe(window,"scroll",this.eventResize),Event.observe(this.options.parent,"scroll",this.eventResize),this.options.draggable&&([(e=this).topbar,this.topbar.up().previous(),this.topbar.up().next()].each(function(t){t.observe("mousedown",e.eventMouseDown),t.addClassName("top_draggable")}),[this.bottombar.up(),this.bottombar.up().previous(),this.bottombar.up().next()].each(function(t){t.observe("mousedown",e.eventMouseDown),t.addClassName("bottom_draggable")})),this.options.resizable&&(this.sizer=$(this.element.id+"_sizer"),Event.observe(this.sizer,"mousedown",this.eventMouseDown)),this.useLeft=null,this.useTop=null,void 0!==this.options.left?(this.element.setStyle({left:parseFloat(this.options.left)+"px"}),this.useLeft=!0):(this.element.setStyle({right:parseFloat(this.options.right)+"px"}),this.useLeft=!1),void 0!==this.options.top?(this.element.setStyle({top:parseFloat(this.options.top)+"px"}),this.useTop=!0):(this.element.setStyle({bottom:parseFloat(this.options.bottom)+"px"}),this.useTop=!1),this.storedLocation=null,this.setOpacity(this.options.opacity),this.options.zIndex&&this.setZIndex(this.options.zIndex),this.options.destroyOnClose&&this.setDestroyOnClose(!0),this._getWindowBorderSize(),this.width=this.options.width,this.height=this.options.height,this.visible=!1,this.constraint=!1,this.constraintPad={top:0,left:0,bottom:0,right:0},this.width&&this.height&&this.setSize(this.options.width,this.options.height),this.setTitle(this.options.title),Windows.register(this)},destroy:function(){if(this._notify("onDestroy"),Event.stopObserving(this.topbar,"mousedown",this.eventMouseDown),Event.stopObserving(this.bottombar,"mousedown",this.eventMouseDown),Event.stopObserving(this.content,"mousedown",this.eventMouseDownContent),Event.stopObserving(window,"load",this.eventOnLoad),Event.stopObserving(window,"resize",this.eventResize),Event.stopObserving(window,"scroll",this.eventResize),Event.stopObserving(this.content,"load",this.options.onload),this._oldParent){for(var t=this.getContent(),e=null,i=0;i<t.childNodes.length&&1!=(e=t.childNodes[i]).nodeType;i++)e=null;e&&this._oldParent.appendChild(e),this._oldParent=null}this.sizer&&Event.stopObserving(this.sizer,"mousedown",this.eventMouseDown),this.options.url&&(this.content.src=null),this.iefix&&Element.remove(this.iefix),Element.remove(this.element),Windows.unregister(this)},setCloseCallback:function(t){this.options.closeCallback=t},getContent:function(){return this.content},setContent:function(t,e,i){var o=$(t);if(null==o)throw"Unable to find element '"+t+"' in DOM";this._oldParent=o.parentNode;var t=null,n=null;e&&(t=Element.getDimensions(o)),i&&(n=Position.cumulativeOffset(o)),this.getContent();this.setHTMLContent(""),this.getContent().appendChild(o),o.show(),e&&this.setSize(t.width,t.height),i&&this.setLocation(n[1]-this.heightN,n[0]-this.widthW)},setHTMLContent:function(t){var e;this.options.url&&(this.content.src=null,this.options.url=null,e='<div id="'+this.getId()+'_content" class="'+this.options.className+'_content"> </div>',$(this.getId()+"_table_content").innerHTML=e,this.content=$(this.element.id+"_content")),this.getContent().innerHTML=t},setAjaxContent:function(t,e,i,o){this.showFunction=i?"showCenter":"show",this.showModal=o||!1,e=e||{},this.setHTMLContent(""),this.onComplete=e.onComplete,this._onCompleteHandler||(this._onCompleteHandler=this._setAjaxContent.bind(this)),e.onComplete=this._onCompleteHandler,new Ajax.Request(t,e),e.onComplete=this.onComplete},_setAjaxContent:function(t){Element.update(this.getContent(),t.responseText),this.onComplete&&this.onComplete(t),this.onComplete=null,this[this.showFunction](this.showModal)},setURL:function(t){this.options.url&&(this.content.src=null),this.options.url=t;t="<iframe frameborder='0' name='"+this.getId()+"_content'  id='"+this.getId()+"_content' src='"+t+"' width='"+this.width+"' height='"+this.height+"'> </iframe>";$(this.getId()+"_table_content").innerHTML=t,this.content=$(this.element.id+"_content")},getURL:function(){return this.options.url||null},refresh:function(){this.options.url&&($(this.element.getAttribute("id")+"_content").src=this.options.url)},setCookie:function(t,e,i,o,n){t=t||this.element.id,this.cookie=[t,e,i,o,n];var s,e=WindowUtilities.getCookie(t);e&&(o=(i=e.split(","))[0].split(":"),n=i[1].split(":"),t=parseFloat(i[2]),e=parseFloat(i[3]),s=i[4],i=i[5],this.setSize(t,e),"true"==s?this.doMinimize=!0:"true"==i&&(this.doMaximize=!0),this.useLeft="l"==o[0],this.useTop="t"==n[0],this.element.setStyle(this.useLeft?{left:o[1]}:{right:o[1]}),this.element.setStyle(this.useTop?{top:n[1]}:{bottom:n[1]}))},getId:function(){return this.element.id},setDestroyOnClose:function(){this.options.destroyOnClose=!0},setConstraint:function(t,e){this.constraint=t,this.constraintPad=Object.extend(this.constraintPad,e||{}),this.useTop&&this.useLeft&&this.setLocation(parseFloat(this.element.style.top),parseFloat(this.element.style.left))},_initDrag:function(t){if(!(Event.element(t)==this.sizer&&this.isMinimized()||Event.element(t)!=this.sizer&&this.isMaximized())){if(Prototype.Browser.IE&&0==this.heightN&&this._getWindowBorderSize(),this.pointer=[this._round(Event.pointerX(t),this.options.gridX),this._round(Event.pointerY(t),this.options.gridY)],this.options.wiredDrag?this.currentDrag=this._createWiredElement():this.currentDrag=this.element,Event.element(t)==this.sizer)this.doResize=!0,this.widthOrg=this.width,this.heightOrg=this.height,this.bottomOrg=parseFloat(this.element.getStyle("bottom")),this.rightOrg=parseFloat(this.element.getStyle("right")),this._notify("onStartResize");else{this.doResize=!1;var e=$(this.getId()+"_close");if(e&&Position.within(e,this.pointer[0],this.pointer[1]))return void(this.currentDrag=null);if(this.toFront(),!this.options.draggable)return;this._notify("onStartMove")}Event.observe(document,"mouseup",this.eventMouseUp,!1),Event.observe(document,"mousemove",this.eventMouseMove,!1),WindowUtilities.disableScreen("__invisible__","__invisible__",this.overlayOpacity),document.body.ondrag=function(){return!1},document.body.onselectstart=function(){return!1},this.currentDrag.show(),Event.stop(t)}},_round:function(t,e){return 1==e?t:Math.floor(t/e)*e},_updateDrag:function(t){var e,i,o=[this._round(Event.pointerX(t),this.options.gridX),this._round(Event.pointerY(t),this.options.gridY)],n=o[0]-this.pointer[0],s=o[1]-this.pointer[1];this.doResize?(i=this.widthOrg+n,e=this.heightOrg+s,n=this.width-this.widthOrg,s=this.height-this.heightOrg,this.useLeft?i=this._updateWidthConstraint(i):this.currentDrag.setStyle({right:this.rightOrg-n+"px"}),this.useTop?e=this._updateHeightConstraint(e):this.currentDrag.setStyle({bottom:this.bottomOrg-s+"px"}),this.setSize(i,e),this._notify("onResize")):(this.pointer=o,this.useLeft?(i=parseFloat(this.currentDrag.getStyle("left"))+n,e=this._updateLeftConstraint(i),this.pointer[0]+=e-i,this.currentDrag.setStyle({left:e+"px"})):this.currentDrag.setStyle({right:parseFloat(this.currentDrag.getStyle("right"))-n+"px"}),this.useTop?(o=parseFloat(this.currentDrag.getStyle("top"))+s,i=this._updateTopConstraint(o),this.pointer[1]+=i-o,this.currentDrag.setStyle({top:i+"px"})):this.currentDrag.setStyle({bottom:parseFloat(this.currentDrag.getStyle("bottom"))-s+"px"}),this._notify("onMove")),this.iefix&&this._fixIEOverlapping(),this._removeStoreLocation(),Event.stop(t)},_endDrag:function(t){WindowUtilities.enableScreen("__invisible__"),this.doResize?this._notify("onEndResize"):this._notify("onEndMove"),Event.stopObserving(document,"mouseup",this.eventMouseUp,!1),Event.stopObserving(document,"mousemove",this.eventMouseMove,!1),Event.stop(t),this._hideWiredElement(),this._saveCookie(),document.body.ondrag=null,document.body.onselectstart=null},_updateLeftConstraint:function(t){var e;return t=this.constraint&&this.useLeft&&this.useTop&&(e=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width,(t=t<this.constraintPad.left?this.constraintPad.left:t)+this.width+this.widthE+this.widthW>e-this.constraintPad.right)?e-this.constraintPad.right-this.width-this.widthE-this.widthW:t},_updateTopConstraint:function(t){var e,i;return t=this.constraint&&this.useLeft&&this.useTop&&(e=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height,i=this.height+this.heightN+this.heightS,(t=t<this.constraintPad.top?this.constraintPad.top:t)+i>e-this.constraintPad.bottom)?e-this.constraintPad.bottom-i:t},_updateWidthConstraint:function(t){var e,i;return t=this.constraint&&this.useLeft&&this.useTop&&(e=this.options.parent==document.body?WindowUtilities.getPageSize().windowWidth:this.options.parent.getDimensions().width,(i=parseFloat(this.element.getStyle("left")))+t+this.widthE+this.widthW>e-this.constraintPad.right)?e-this.constraintPad.right-i-this.widthE-this.widthW:t},_updateHeightConstraint:function(t){var e,i;return t=this.constraint&&this.useLeft&&this.useTop&&(e=this.options.parent==document.body?WindowUtilities.getPageSize().windowHeight:this.options.parent.getDimensions().height,(i=parseFloat(this.element.getStyle("top")))+t+this.heightN+this.heightS>e-this.constraintPad.bottom)?e-this.constraintPad.bottom-i-this.heightN-this.heightS:t},_createWindow:function(t){var e,i=this.options.className,o=document.createElement("div"),n=(o.setAttribute("id",t),o.className="dialog",e=this.options.url?'<iframe frameborder="0" name="'+t+'_content"  id="'+t+'_content" src="'+this.options.url+'"> </iframe>':'<div id="'+t+'_content" class="'+i+'_content"> </div>',this.options.closable?"<div class='"+i+"_close' id='"+t+"_close' onclick='Windows.close(\""+t+"\", event)'> </div>":""),s=this.options.minimizable?"<div class='"+i+"_minimize' id='"+t+"_minimize' onclick='Windows.minimize(\""+t+"\", event)'> </div>":"",r=this.options.maximizable?"<div class='"+i+"_maximize' id='"+t+"_maximize' onclick='Windows.maximize(\""+t+"\", event)'> </div>":"",a=this.options.resizable?"class='"+i+"_sizer' id='"+t+"_sizer'":"class='"+i+"_se'";return o.innerHTML=n+s+r+"      <table id='"+t+"_row1' class=\"top table_window\">        <tr>          <td class='"+i+"_nw'></td>          <td class='"+i+"_n'><div id='"+t+"_top' class='"+i+"_title title_window'>"+this.options.title+"</div></td>          <td class='"+i+"_ne'></td>        </tr>      </table>      <table id='"+t+"_row2' class=\"mid table_window\">        <tr>          <td class='"+i+"_w'></td>            <td id='"+t+"_table_content' class='"+i+"_content' valign='top'>"+e+"</td>          <td class='"+i+"_e'></td>        </tr>      </table>        <table id='"+t+"_row3' class=\"bot table_window\">        <tr>          <td class='"+i+"_sw'></td>            <td class='"+i+"_s'><div id='"+t+"_bottom' class='status_bar'><span style='float:left; width:1px; height:1px'></span></div></td>            <td "+a+"></td>        </tr>      </table>    ",Element.hide(o),this.options.parent.insertBefore(o,this.options.parent.firstChild),Event.observe($(t+"_content"),"load",this.options.onload),o},changeClassName:function(e){var i=this.options.className,o=this.getId();$A(["_close","_minimize","_maximize","_sizer","_content"]).each(function(t){this._toggleClassName($(o+t),i+t,e+t)}.bind(this)),this._toggleClassName($(o+"_top"),i+"_title",e+"_title"),$$("#"+o+" td").each(function(t){t.className=t.className.sub(i,e)}),this.options.className=e},_toggleClassName:function(t,e,i){t&&(t.removeClassName(e),t.addClassName(i))},setLocation:function(t,e){t=this._updateTopConstraint(t),e=this._updateLeftConstraint(e);var i=this.currentDrag||this.element;i.setStyle({top:t+"px"}),i.setStyle({left:e+"px"}),this.useLeft=!0,this.useTop=!0},getLocation:function(){var t={},t=this.useTop?Object.extend(t,{top:this.element.getStyle("top")}):Object.extend(t,{bottom:this.element.getStyle("bottom")});return t=this.useLeft?Object.extend(t,{left:this.element.getStyle("left")}):Object.extend(t,{right:this.element.getStyle("right")})},getSize:function(){return{width:this.width,height:this.height}},setSize:function(t,e,i){t=parseFloat(t),e=parseFloat(e),!this.minimized&&t<this.options.minWidth&&(t=this.options.minWidth),!this.minimized&&e<this.options.minHeight&&(e=this.options.minHeight),this.options.maxHeight&&e>this.options.maxHeight&&(e=this.options.maxHeight),this.options.maxWidth&&t>this.options.maxWidth&&(t=this.options.maxWidth),this.useTop&&this.useLeft&&Window.hasEffectLib&&Effect.ResizeWindow&&i?new Effect.ResizeWindow(this,null,null,t,e,{duration:Window.resizeEffectDuration}):(this.width=t,this.height=e,(i=this.currentDrag||this.element).setStyle({width:t+this.widthW+this.widthE+"px"}),i.setStyle({height:e+this.heightN+this.heightS+"px"}),this.currentDrag&&this.currentDrag!=this.element||((i=$(this.element.id+"_content")).setStyle({height:e+"px"}),i.setStyle({width:t+"px"})))},updateHeight:function(){this.setSize(this.width,this.content.scrollHeight,!0)},updateWidth:function(){this.setSize(this.content.scrollWidth,this.height,!0)},toFront:function(){this.element.style.zIndex<Windows.maxZIndex&&this.setZIndex(Windows.maxZIndex+1),this.iefix&&this._fixIEOverlapping()},getBounds:function(t){this.width&&this.height&&this.visible||this.computeBounds();var e=this.width,i=this.height;return t||(e+=this.widthW+this.widthE,i+=this.heightN+this.heightS),Object.extend(this.getLocation(),{width:e+"px",height:i+"px"})},computeBounds:function(){var t;this.width&&this.height||(t=WindowUtilities._computeSize(this.content.innerHTML,this.content.id,this.width,this.height,0,this.options.className),this.height?this.width=t+5:this.height=t+5),this.setSize(this.width,this.height),this.centered&&this._center(this.centerTop,this.centerLeft)},show:function(t){if(this.visible=!0,t){var e;if(void 0===this.overlayOpacity)return e=this,void setTimeout(function(){e.show(t)},10);Windows.addModalWindow(this),this.modal=!0,this.setZIndex(Windows.maxZIndex+1),Windows.unsetOverflow(this)}else this.element.style.zIndex||this.setZIndex(Windows.maxZIndex+1);this.oldStyle&&this.getContent().setStyle({overflow:this.oldStyle}),this.computeBounds(),this._notify("onBeforeShow"),this.options.showEffect!=Element.show&&this.options.showEffectOptions?this.options.showEffect(this.element,this.options.showEffectOptions):this.options.showEffect(this.element),this._checkIEOverlapping(),(WindowUtilities.focusedWindow=this)._notify("onShow")},showCenter:function(t,e,i){this.centered=!0,this.centerTop=e,this.centerLeft=i,this.show(t)},isVisible:function(){return this.visible},_center:function(t,e){var i=WindowUtilities.getWindowScroll(this.options.parent),o=WindowUtilities.getPageSize(this.options.parent);void 0===t&&(t=(o.windowHeight-(this.height+this.heightN+this.heightS))/2),t+=i.top,void 0===e&&(e=(o.windowWidth-(this.width+this.widthW+this.widthE))/2),e+=i.left,this.setLocation(t,e),this.toFront()},_recenter:function(t){var e,i;this.centered&&(e=WindowUtilities.getPageSize(this.options.parent),i=WindowUtilities.getWindowScroll(this.options.parent),this.pageSize&&this.pageSize.windowWidth==e.windowWidth&&this.pageSize.windowHeight==e.windowHeight&&this.windowScroll.left==i.left&&this.windowScroll.top==i.top||(this.pageSize=e,this.windowScroll=i,$("overlay_modal")&&$("overlay_modal").setStyle({height:e.pageHeight+"px"}),this.options.recenterAuto&&this._center(this.centerTop,this.centerLeft)))},hide:function(){this.visible=!1,this.modal&&(Windows.removeModalWindow(this),Windows.resetOverflow()),this.oldStyle=this.getContent().getStyle("overflow")||"auto",this.getContent().setStyle({overflow:"hidden"}),this.options.hideEffect(this.element,this.options.hideEffectOptions),this.iefix&&this.iefix.hide(),this.doNotNotifyHide||this._notify("onHide")},close:function(){var t,e;!this.visible||this.options.closeCallback&&!this.options.closeCallback(this)||(this.options.destroyOnClose&&(t=this.destroy.bind(this),this.options.hideEffectOptions.afterFinish?(e=this.options.hideEffectOptions.afterFinish,this.options.hideEffectOptions.afterFinish=function(){e(),t()}):this.options.hideEffectOptions.afterFinish=function(){t()}),Windows.updateFocusedWindow(),this.doNotNotifyHide=!0,this.hide(),this.doNotNotifyHide=!1,this._notify("onClose"))},minimize:function(){var t,e,i,o;this.resizing||(t=$(this.getId()+"_row2"),this.minimized?(this.minimized=!1,e=this.r2Height,this.r2Height=null,this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,null,null,null,this.height+e,{duration:Window.resizeEffectDuration}):(i=this.element.getHeight()+e,this.height+=e,this.element.setStyle({height:i+"px"}),t.show()),this.useTop||(o=parseFloat(this.element.getStyle("bottom")),this.element.setStyle({bottom:o-e+"px"})),this.toFront()):(this.minimized=!0,e=t.getDimensions().height,this.r2Height=e,i=this.element.getHeight()-e,this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,null,null,null,this.height-e,{duration:Window.resizeEffectDuration}):(this.height-=e,this.element.setStyle({height:i+"px"}),t.hide()),this.useTop||(o=parseFloat(this.element.getStyle("bottom")),this.element.setStyle({bottom:o+e+"px"}))),this._notify("onMinimize"),this._saveCookie())},maximize:function(){var t,e,i,o;this.isMinimized()||this.resizing||(Prototype.Browser.IE&&0==this.heightN&&this._getWindowBorderSize(),null!=this.storedLocation?(this._restoreLocation(),this.iefix&&this.iefix.hide()):(this._storeLocation(),Windows.unsetOverflow(this),i=WindowUtilities.getWindowScroll(this.options.parent),o=WindowUtilities.getPageSize(this.options.parent),t=i.left,e=i.top,this.options.parent!=document.body&&(i={top:0,left:0,bottom:0,right:0},i=this.options.parent.getDimensions(),o.windowWidth=i.width,o.windowHeight=i.height,t=e=0),this.constraint&&(o.windowWidth-=Math.max(0,this.constraintPad.left)+Math.max(0,this.constraintPad.right),o.windowHeight-=Math.max(0,this.constraintPad.top)+Math.max(0,this.constraintPad.bottom),t+=Math.max(0,this.constraintPad.left),e+=Math.max(0,this.constraintPad.top)),i=o.windowWidth-this.widthW-this.widthE,o=o.windowHeight-this.heightN-this.heightS,this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,e,t,i,o,{duration:Window.resizeEffectDuration}):(this.setSize(i,o),this.element.setStyle(this.useLeft?{left:t}:{right:t}),this.element.setStyle(this.useTop?{top:e}:{bottom:e})),this.toFront(),this.iefix&&this._fixIEOverlapping()),this._notify("onMaximize"),this._saveCookie())},isMinimized:function(){return this.minimized},isMaximized:function(){return null!=this.storedLocation},setOpacity:function(t){Element.setOpacity&&Element.setOpacity(this.element,t)},setZIndex:function(t){this.element.setStyle({zIndex:t}),Windows.updateZindex(t,this)},setTitle:function(t){t&&""!=t||(t="&nbsp;"),Element.update(this.element.id+"_top",t)},getTitle:function(){return $(this.element.id+"_top").innerHTML},setStatusBar:function(t){$(this.getId()+"_bottom");"object"==typeof t?this.bottombar.firstChild?this.bottombar.replaceChild(t,this.bottombar.firstChild):this.bottombar.appendChild(t):this.bottombar.innerHTML=t},_checkIEOverlapping:function(){!this.iefix&&0<navigator.appVersion.indexOf("MSIE")&&navigator.userAgent.indexOf("Opera")<0&&"absolute"==this.element.getStyle("position")&&(new Insertion.After(this.element.id,'<iframe id="'+this.element.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>'),this.iefix=$(this.element.id+"_iefix")),this.iefix&&setTimeout(this._fixIEOverlapping.bind(this),50)},_fixIEOverlapping:function(){Position.clone(this.element,this.iefix),this.iefix.style.zIndex=this.element.style.zIndex-1,this.iefix.show()},_getWindowBorderSize:function(t){var e=this._createHiddenDiv(this.options.className+"_n"),e=(this.heightN=Element.getDimensions(e).height,e.parentNode.removeChild(e),this._createHiddenDiv(this.options.className+"_s")),e=(this.heightS=Element.getDimensions(e).height,e.parentNode.removeChild(e),this._createHiddenDiv(this.options.className+"_e")),e=(this.widthE=Element.getDimensions(e).width,e.parentNode.removeChild(e),this._createHiddenDiv(this.options.className+"_w"));this.widthW=Element.getDimensions(e).width,e.parentNode.removeChild(e);(e=document.createElement("div")).className="overlay_"+this.options.className,document.body.appendChild(e);var i=this;setTimeout(function(){i.overlayOpacity=$(e).getStyle("opacity"),e.parentNode.removeChild(e)},10),Prototype.Browser.IE&&(this.heightS=$(this.getId()+"_row3").getDimensions().height,this.heightN=$(this.getId()+"_row1").getDimensions().height),Prototype.Browser.WebKit&&Prototype.Browser.WebKitVersion<420&&this.setSize(this.width,this.height),this.doMaximize&&this.maximize(),this.doMinimize&&this.minimize()},_createHiddenDiv:function(t){var e=document.body,i=document.createElement("div");return i.setAttribute("id",this.element.id+"_tmp"),i.className=t,i.style.display="none",i.innerHTML="",e.insertBefore(i,e.firstChild),i},_storeLocation:function(){null==this.storedLocation&&(this.storedLocation={useTop:this.useTop,useLeft:this.useLeft,top:this.element.getStyle("top"),bottom:this.element.getStyle("bottom"),left:this.element.getStyle("left"),right:this.element.getStyle("right"),width:this.width,height:this.height})},_restoreLocation:function(){null!=this.storedLocation&&(this.useLeft=this.storedLocation.useLeft,this.useTop=this.storedLocation.useTop,this.useLeft&&this.useTop&&Window.hasEffectLib&&Effect.ResizeWindow?new Effect.ResizeWindow(this,this.storedLocation.top,this.storedLocation.left,this.storedLocation.width,this.storedLocation.height,{duration:Window.resizeEffectDuration}):(this.element.setStyle(this.useLeft?{left:this.storedLocation.left}:{right:this.storedLocation.right}),this.element.setStyle(this.useTop?{top:this.storedLocation.top}:{bottom:this.storedLocation.bottom}),this.setSize(this.storedLocation.width,this.storedLocation.height)),Windows.resetOverflow(),this._removeStoreLocation())},_removeStoreLocation:function(){this.storedLocation=null},_saveCookie:function(){var t;this.cookie&&(t="",this.useLeft?t+="l:"+(this.storedLocation?this.storedLocation.left:this.element.getStyle("left")):t+="r:"+(this.storedLocation?this.storedLocation.right:this.element.getStyle("right")),this.useTop?t+=",t:"+(this.storedLocation?this.storedLocation.top:this.element.getStyle("top")):t+=",b:"+(this.storedLocation?this.storedLocation.bottom:this.element.getStyle("bottom")),t=(t=(t=(t+=","+(this.storedLocation||this).width)+","+(this.storedLocation||this).height)+","+this.isMinimized())+","+this.isMaximized(),WindowUtilities.setCookie(t,this.cookie))},_createWiredElement:function(){this.wiredElement||(Prototype.Browser.IE&&this._getWindowBorderSize(),(t=document.createElement("div")).className="wired_frame "+this.options.className+"_wired_frame",t.style.position="absolute",this.options.parent.insertBefore(t,this.options.parent.firstChild),this.wiredElement=$(t)),this.useLeft?this.wiredElement.setStyle({left:this.element.getStyle("left")}):this.wiredElement.setStyle({right:this.element.getStyle("right")}),this.useTop?this.wiredElement.setStyle({top:this.element.getStyle("top")}):this.wiredElement.setStyle({bottom:this.element.getStyle("bottom")});var t=this.element.getDimensions();return this.wiredElement.setStyle({width:t.width+"px",height:t.height+"px"}),this.wiredElement.setStyle({zIndex:Windows.maxZIndex+30}),this.wiredElement},_hideWiredElement:function(){this.wiredElement&&this.currentDrag&&(this.currentDrag==this.element?this.currentDrag=null:(this.useLeft?this.element.setStyle({left:this.currentDrag.getStyle("left")}):this.element.setStyle({right:this.currentDrag.getStyle("right")}),this.useTop?this.element.setStyle({top:this.currentDrag.getStyle("top")}):this.element.setStyle({bottom:this.currentDrag.getStyle("bottom")}),this.currentDrag.hide(),this.currentDrag=null,this.doResize&&this.setSize(this.width,this.height)))},_notify:function(t){this.options[t]?this.options[t](this):Windows.notify(t,this)}},{windows:[],modalWindows:[],observers:[],focusedWindow:null,maxZIndex:0,overlayShowEffectOptions:{duration:.5},overlayHideEffectOptions:{duration:.5},addObserver:function(t){this.removeObserver(t),this.observers.push(t)},removeObserver:function(e){this.observers=this.observers.reject(function(t){return t==e})},notify:function(e,i){this.observers.each(function(t){t[e]&&t[e](e,i)})},getWindow:function(e){return this.windows.detect(function(t){return t.getId()==e})},getFocusedWindow:function(){return this.focusedWindow},updateFocusedWindow:function(){this.focusedWindow=2<=this.windows.length?this.windows[this.windows.length-2]:null},register:function(t){this.windows.push(t)},addModalWindow:function(t){0==this.modalWindows.length?WindowUtilities.disableScreen(t.options.className,"overlay_modal",t.overlayOpacity,t.getId(),t.options.parent):(Window.keepMultiModalWindow?($("overlay_modal").style.zIndex=Windows.maxZIndex+1,Windows.maxZIndex+=1,WindowUtilities._hideSelect(this.modalWindows.last().getId())):this.modalWindows.last().element.hide(),WindowUtilities._showSelect(t.getId())),this.modalWindows.push(t)},removeModalWindow:function(t){this.modalWindows.pop(),0==this.modalWindows.length?WindowUtilities.enableScreen():Window.keepMultiModalWindow?(this.modalWindows.last().toFront(),WindowUtilities._showSelect(this.modalWindows.last().getId())):this.modalWindows.last().element.show()},unregister:function(e){this.windows=this.windows.reject(function(t){return t==e})},closeAll:function(){this.windows.each(function(t){Windows.close(t.getId())})},closeAllModalWindows:function(){WindowUtilities.enableScreen(),this.modalWindows.each(function(t){t&&t.close()})},minimize:function(t,e){t=this.getWindow(t);t&&t.visible&&t.minimize(),Event.stop(e)},maximize:function(t,e){t=this.getWindow(t);t&&t.visible&&t.maximize(),Event.stop(e)},close:function(t,e){t=this.getWindow(t);t&&t.close(),e&&Event.stop(e)},blur:function(t){t=this.getWindow(t);t&&(t.options.blurClassName&&t.changeClassName(t.options.blurClassName),this.focusedWindow==t&&(this.focusedWindow=null),t._notify("onBlur"))},focus:function(t){t=this.getWindow(t);t&&(this.focusedWindow&&this.blur(this.focusedWindow.getId()),t.options.focusClassName&&t.changeClassName(t.options.focusClassName),(this.focusedWindow=t)._notify("onFocus"))},unsetOverflow:function(t){this.windows.each(function(t){t.oldOverflow=t.getContent().getStyle("overflow")||"auto",t.getContent().setStyle({overflow:"hidden"})}),t&&t.oldOverflow&&t.getContent().setStyle({overflow:t.oldOverflow})},resetOverflow:function(){this.windows.each(function(t){t.oldOverflow&&t.getContent().setStyle({overflow:t.oldOverflow})})},updateZindex:function(t,e){t>this.maxZIndex&&(this.maxZIndex=t,this.focusedWindow)&&this.blur(this.focusedWindow.getId()),this.focusedWindow=e,this.focusedWindow&&this.focus(this.focusedWindow.getId())}}),Dialog={dialogId:null,onCompleteFunc:null,callFunc:null,parameters:null,confirm:function(t,e){var i,o,n,s;if(!t||"string"==typeof t)return t=t||"",i=(e=e||{}).okLabel||"Ok",o=e.cancelLabel||"Cancel",(e=Object.extend(e,e.windowParameters||{})).windowParameters=e.windowParameters||{},e.className=e.className||"alert",n="class ='"+(e.buttonClass?e.buttonClass+" ":"")+" ok_button'",s="class ='"+(e.buttonClass?e.buttonClass+" ":"")+" cancel_button'",t="      <div class='"+e.className+"_message'>"+t+"</div>        <div class='"+e.className+"_buttons'>          <input type='button' value='"+i+"' onclick='Dialog.okCallback()' "+n+"/>          <input type='button' value='"+o+"' onclick='Dialog.cancelCallback()' "+s+"/>        </div>    ",this._openDialog(t,e);Dialog._runAjaxRequest(t,e,Dialog.confirm)},alert:function(t,e){var i,o;if(!t||"string"==typeof t)return t=t||"",i=(e=e||{}).okLabel||"Ok",(e=Object.extend(e,e.windowParameters||{})).windowParameters=e.windowParameters||{},e.className=e.className||"alert",o="class ='"+(e.buttonClass?e.buttonClass+" ":"")+" ok_button'",t="      <div class='"+e.className+"_message'>"+t+"</div>        <div class='"+e.className+"_buttons'>          <input type='button' value='"+i+"' onclick='Dialog.okCallback()' "+o+"/>        </div>",this._openDialog(t,e);Dialog._runAjaxRequest(t,e,Dialog.alert)},info:function(t,e){if(!t||"string"==typeof t)return t=t||"",e=e||{},(e=Object.extend(e,e.windowParameters||{})).windowParameters=e.windowParameters||{},e.className=e.className||"alert",t="<div id='modal_dialog_message' class='"+e.className+"_message'>"+t+"</div>",e.showProgress&&(t+="<div id='modal_dialog_progress' class='"+e.className+"_progress'>  </div>"),e.ok=null,e.cancel=null,this._openDialog(t,e);Dialog._runAjaxRequest(t,e,Dialog.info)},setInfoMessage:function(t){$("modal_dialog_message").update(t)},closeInfo:function(){Windows.close(this.dialogId)},_openDialog:function(t,e){var i,o=e.className,o=(e.height||e.width||(e.width=WindowUtilities.getPageSize(e.options.parent||document.body).pageWidth/2),e.id?this.dialogId=e.id:(i=new Date,this.dialogId="modal_dialog_"+i.getTime(),e.id=this.dialogId),e.height&&e.width||(i=WindowUtilities._computeSize(t,this.dialogId,e.width,e.height,5,o),e.height?e.width=i+5:e.height=i+5),e.effectOptions=e.effectOptions,e.resizable=e.resizable||!1,e.minimizable=e.minimizable||!1,e.maximizable=e.maximizable||!1,e.draggable=e.draggable||!1,e.closable=e.closable||!1,new Window(e));return o.getContent().innerHTML=t,o.showCenter(!0,e.top,e.left),o.setDestroyOnClose(),o.cancelCallback=e.onCancel||e.cancel,o.okCallback=e.onOk||e.ok,o},_getAjaxContent:function(t){Dialog.callFunc(t.responseText,Dialog.parameters)},_runAjaxRequest:function(t,e,i){null==t.options&&(t.options={}),Dialog.onCompleteFunc=t.options.onComplete,Dialog.parameters=e,Dialog.callFunc=i,t.options.onComplete=Dialog._getAjaxContent,new Ajax.Request(t.url,t.options)},okCallback:function(){var t=Windows.focusedWindow;t.okCallback&&!t.okCallback(t)||($$("#"+t.getId()+" input").each(function(t){t.onclick=null}),t.close())},cancelCallback:function(){var t=Windows.focusedWindow;$$("#"+t.getId()+" input").each(function(t){t.onclick=null}),t.close(),t.cancelCallback&&t.cancelCallback(t)}},array,WindowUtilities=(Prototype.Browser.WebKit&&(array=navigator.userAgent.match(new RegExp(/AppleWebKit\/([\d\.\+]*)/)),Prototype.Browser.WebKitVersion=parseFloat(array[1])),{getWindowScroll:function(parent){var T,L,W,H;if(parent=parent||document.body,parent!=document.body)T=parent.scrollTop,L=parent.scrollLeft,W=parent.scrollWidth,H=parent.scrollHeight;else{var w=window;with(w.document)w.document.documentElement&&documentElement.scrollTop?(T=documentElement.scrollTop,L=documentElement.scrollLeft):w.document.body&&(T=body.scrollTop,L=body.scrollLeft),H=w.innerWidth?(W=w.innerWidth,w.innerHeight):w.document.documentElement&&documentElement.clientWidth?(W=documentElement.clientWidth,documentElement.clientHeight):(W=body.offsetWidth,body.offsetHeight)}return{top:T,left:L,width:W,height:H}},getPageSize:function(t){var e,i,o,n,s;return(t=t||document.body)!=document.body?(e=t.getWidth(),i=t.getHeight(),n=t.scrollWidth,o=t.scrollHeight):(t=window.innerHeight&&window.scrollMaxY?(s=document.body.scrollWidth,window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(s=document.body.scrollWidth,document.body.scrollHeight):(s=document.body.offsetWidth,document.body.offsetHeight),self.innerHeight?(e=self.innerWidth,i=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,i=document.documentElement.clientHeight):document.body&&(e=document.body.clientWidth,i=document.body.clientHeight),o=t<i?i:t,n=s<e?e:s),{pageWidth:n,pageHeight:o,windowWidth:e,windowHeight:i}},disableScreen:function(t,e,i,o,n){WindowUtilities.initLightbox(e,t,function(){this._disableScreen(t,e,i,o)}.bind(this),n||document.body)},_disableScreen:function(t,e,i,o){var n=$(e),s=WindowUtilities.getPageSize(n.parentNode);o&&Prototype.Browser.IE&&(WindowUtilities._hideSelect(),WindowUtilities._showSelect(o)),n.style.height=s.pageHeight+"px",n.style.display="none","overlay_modal"==e&&Window.hasEffectLib&&Windows.overlayShowEffectOptions?(n.overlayOpacity=i,new Effect.Appear(n,Object.extend({from:0,to:i},Windows.overlayShowEffectOptions))):n.style.display="block"},enableScreen:function(t){t=t||"overlay_modal";var e=$(t);e&&("overlay_modal"==t&&Window.hasEffectLib&&Windows.overlayHideEffectOptions?new Effect.Fade(e,Object.extend({from:e.overlayOpacity,to:0},Windows.overlayHideEffectOptions)):(e.style.display="none",e.parentNode.removeChild(e)),"__invisible__"!=t)&&WindowUtilities._showSelect()},_hideSelect:function(t){Prototype.Browser.IE&&(t=null==t?"":"#"+t+" ",$$(t+"select").each(function(t){WindowUtilities.isDefined(t.oldVisibility)||(t.oldVisibility=t.style.visibility||"visible",t.style.visibility="hidden")}))},_showSelect:function(t){Prototype.Browser.IE&&(t=null==t?"":"#"+t+" ",$$(t+"select").each(function(e){if(WindowUtilities.isDefined(e.oldVisibility)){try{e.style.visibility=e.oldVisibility}catch(t){e.style.visibility="visible"}e.oldVisibility=null}else e.style.visibility&&(e.style.visibility="visible")}))},isDefined:function(t){return void 0!==t&&null!=t},initLightbox:function(t,e,i,o){var n;$(t)?(Element.setStyle(t,{zIndex:Windows.maxZIndex+1}),Windows.maxZIndex++,i()):((n=document.createElement("div")).setAttribute("id",t),n.className="overlay_"+e,n.style.display="none",n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.zIndex=Windows.maxZIndex+1,Windows.maxZIndex++,n.style.width="100%",o.insertBefore(n,o.firstChild),Prototype.Browser.WebKit&&"overlay_modal"==t?setTimeout(function(){i()},10):i())},setCookie:function(t,e){document.cookie=e[0]+"="+escape(t)+(e[1]?"; expires="+e[1].toGMTString():"")+(e[2]?"; path="+e[2]:"")+(e[3]?"; domain="+e[3]:"")+(e[4]?"; secure":"")},getCookie:function(t){var e=document.cookie,t=t+"=",i=e.indexOf("; "+t);if(-1==i){if(0!=(i=e.indexOf(t)))return null}else i+=2;var o=document.cookie.indexOf(";",i);return-1==o&&(o=e.length),unescape(e.substring(i+t.length,o))},_computeSize:function(t,e,i,o,n,s){var r=document.body,a=document.createElement("div");return a.setAttribute("id",e),a.className=s+"_content",o?a.style.height=o+"px":a.style.width=i+"px",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.display="none",a.innerHTML=t,r.insertBefore(a,r.firstChild),e=o?$(a).getDimensions().width+n:$(a).getDimensions().height+n,r.removeChild(a),e}}),Proto,ColorZilla,Gradient,Gradient;Object.isUndefined(Proto)&&(Proto={}),Proto.Menu=Class.create({initialize:function(){var t=Prototype.emptyFunction,e=(this.ie=Prototype.Browser.IE,this.options=Object.extend({selector:".contextmenu",className:"protoMenu",pageOffset:25,fade:!1,zIndex:100,beforeShow:t,beforeHide:t,beforeSelect:t},arguments[0]||{}),this.shim=new Element("iframe",{style:"position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);display:none",src:"javascript:false;",frameborder:0}),this.options.fade=this.options.fade&&!Object.isUndefined(Effect),this.container=new Element("div",{className:this.options.className,style:"display:none"}),new Element("ul"));this.options.menuItems.each(function(t){e.insert(new Element("li",{className:t.separator?"separator":""}).insert(t.separator?"":Object.extend(new Element("a",{href:"#",title:t.name,className:(t.className||"")+(t.disabled?" disabled":" enabled")}),{_callback:t.callback}).observe("click",this.onClick.bind(this)).observe("contextmenu",Event.stop).update(t.name)))}.bind(this)),$(document.body).insert(this.container.insert(e).observe("contextmenu",Event.stop)),this.ie&&$(document.body).insert(this.shim),document.observe("click",function(t){this.container.visible()&&!t.isRightClick()&&(this.options.beforeHide(t),this.ie&&this.shim.hide(),this.container.hide())}.bind(this)),document.observe(Prototype.Browser.Opera?"click":"contextmenu",function(t){var e,i;(!Prototype.Browser.Opera||t.ctrlKey)&&(e=Event.element(t),i=null,i=Element.match(e,this.options.selector)?e:Element.up(e,this.options.selector))&&(t.contextMenuElement=i,t.contextMenuContainerElement=this.container,this.show(t))}.bind(this))},show:function(t){t.stop(),this.options.beforeShow(t);var e=Event.pointer(t).x,i=Event.pointer(t).y,o=document.viewport.getDimensions(),n=document.viewport.getScrollOffsets(),s=this.container.getDimensions(),e={left:(e+s.width+this.options.pageOffset>o.width?o.width-s.width-this.options.pageOffset:e)+"px",top:(i-n.top+s.height>o.height&&i-n.top>s.height?i-s.height:i)+"px"};this.container.setStyle(e).setStyle({zIndex:this.options.zIndex}),this.ie&&this.shim.setStyle(Object.extend(Object.extend(s,e),{zIndex:this.options.zIndex-1})).show(),this.options.fade?Effect.Appear(this.container,{duration:.25}):this.container.show(),this.event=t},onClick:function(t){t.stop(),t.target._callback&&!t.target.hasClassName("disabled")&&(this.options.beforeSelect(t),this.ie&&this.shim.hide(),this.container.hide(),t.target._callback(this.event))}}),void 0===ColorZilla&&(ColorZilla={}),ColorZilla.Cookie={set:function(t,e,i,o,n){void 0===o&&(o=".colorzilla.com"),void 0===n&&(n="/");var s,r="";return null!=i&&((s=new Date).setTime(s.getTime()+864e5*parseFloat(i)),r="; expires="+s.toGMTString()),o="; domain="+o,n="; path="+n,document.cookie=escape(t)+"="+escape(e||"")+r+o+n},get:function(t){t=document.cookie.match(new RegExp("(^|;)\\s*"+escape(t)+"=([^;\\s]*)"));return t?unescape(t[2]):null},remove:function(t){var e=ColorZilla.Cookie.get(t)||!0;return ColorZilla.Cookie.set(t,"",-1),e}},ColorZilla.Persist={_cookieName:"persist",_dict:{},_fromCookie:function(){if(this._dict={},!(o=ColorZilla.Cookie.get(this._cookieName)))return{};for(var t=o.split("&"),e=0;e<t.length;e++){var i,o,n=t[e].split("=");2==n.length&&(i=unescape(n[0]),o=unescape(n[1]),this._dict[i]=o)}return this._dict},_toCookie:function(){var t="";for(key in this._dict)""!=t&&(t+="&"),t+=escape(key)+"="+escape(this._dict[key]);ColorZilla.Cookie.set(this._cookieName,t,10950)},get:function(t,e){return this._fromCookie(),void 0===this._dict[t]?e:this._dict[t]},set:function(t,e){this._fromCookie(),this._dict[t]=e,this._toCookie()},remove:function(t,e){this._fromCookie(),void 0!==this._dict[t]&&delete this._dict[t],this._toCookie()},setAndReload:function(t,e){this.set(t,e),window.location.reload(!0)}},ColorZilla.LocalStorage={isSupported:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},get:function(t,e){if(!this.isSupported())return e;try{var i=localStorage.getItem(t);return null!=i?i:e}catch(t){return e}},set:function(t,e){if(!this.isSupported())return!1;try{return localStorage.setItem(t,e),!0}catch(t){return!1}},remove:function(t,e){if(!this.isSupported())return!1;try{return localStorage.removeItem(t,e),!0}catch(t){return!1}}},void 0===Gradient&&(Gradient={}),Gradient.DB={UltimateWeb2:{name:"Ultimate Web 2.0 Gradients",license:'derived from <a target="_blank" href="http://www.dezinerfolio.com/2007/05/06/ultimate-web-20-layer-styles">deziner folio</a>, <a target="_blank" href="http://sglider12.blogspot.com/">SGlider12</a> <a target="_blank" href="http://creativecommons.org/licenses/by-sa/2.5/in/">(cc) by-sa</a>',gradients:[{name:"Blue Gloss Default",stops:[{color:"#1E5799",position:"0%"},{color:"#2989D8",position:"50%"},{color:"#207cca",position:"51%"},{color:"#7db9e8",position:"100%"}]},{name:"Black Gloss #1",stops:[{color:"#4c4c4c",position:"0%"},{color:"#595959",position:"12%"},{color:"#666666",position:"25%"},{color:"#474747",position:"39%"},{color:"#2c2c2c",position:"50%"},{color:"#000000",position:"51%"},{color:"#111111",position:"60%"},{color:"#2b2b2b",position:"76%"},{color:"#1c1c1c",position:"91%"},{color:"#131313",position:"100%"}]},{name:"Blue 3D # 16",stops:[{color:"#87e0fd",position:"0%"},{color:"#53cbf1",position:"40%"},{color:"#05abe0",position:"100%"}]},{name:"Blue 3D #13",stops:[{color:"#f0f9ff",position:"0%"},{color:"#cbebff",position:"47%"},{color:"#a1dbff",position:"100%"}]},{name:"Blue 3D #14",stops:[{color:"#7abcff",position:"0%"},{color:"#60abf8",position:"44%"},{color:"#4096ee",position:"100%"}]},{name:"Blue to Transparent",stops:[{color:"#1E5799",position:"0%"},{color:"#7db9e8",position:"100%"}],opacityStops:[{opacity:1,position:"0%"},{opacity:0,position:"100%"}]},{name:"Blue to Transparent Sharp",stops:[{color:"#1E5799",position:"0%"},{color:"#7db9e8",position:"100%"}],opacityStops:[{opacity:1,position:"0%"},{opacity:1,position:"62%"},{opacity:.7,position:"68%"},{opacity:0,position:"100%"}]},{name:"Blue Two Sided Transparent",stops:[{color:"#1E5799",position:"20%"},{color:"#2989D8",position:"50%"},{color:"#1E5799",position:"80%"}],opacityStops:[{opacity:0,position:"0%"},{opacity:.8,position:"15%"},{opacity:1,position:"19%"},{opacity:1,position:"81%"},{opacity:.8,position:"85%"},{opacity:0,position:"100%"}]},{name:"Neutral Density",stops:[{color:"#000000",position:"0%"},{color:"#000000",position:"100%"}],opacityStops:[{opacity:"0.65",position:"0%"},{opacity:"0",position:"100%"}]},{name:"White to Transparent",stops:[{color:"#ffffff",position:"0%"},{color:"#ffffff",position:"100%"}],opacityStops:[{opacity:"1",position:"0%"},{opacity:"0",position:"100%"}]},{name:"Blue 3D #15",stops:[{color:"#00b7ea",position:"0%"},{color:"#009ec3",position:"100%"}]},{name:"Blue 3D #17",stops:[{color:"#88bfe8",position:"0%"},{color:"#70b0e0",position:"100%"}]},{name:"Blue 3D #18",stops:[{color:"#feffff",position:"0%"},{color:"#ddf1f9",position:"35%"},{color:"#a0d8ef",position:"100%"}]},{name:"Blue Flat #1",stops:[{color:"#258dc8",position:"0%"},{color:"#258dc8",position:"100%"}]},{name:"Blue Flat #2",stops:[{color:"#4096ee",position:"0%"},{color:"#4096ee",position:"100%"}]},{name:"Blue Gloss #1",stops:[{color:"#b8e1fc",position:"0%"},{color:"#a9d2f3",position:"10%"},{color:"#90bae4",position:"25%"},{color:"#90bcea",position:"37%"},{color:"#90bff0",position:"50%"},{color:"#6ba8e5",position:"51%"},{color:"#a2daf5",position:"83%"},{color:"#bdf3fd",position:"100%"}]},{name:"Blue Gloss #2",stops:[{color:"#3b679e",position:"0%"},{color:"#2b88d9",position:"50%"},{color:"#207cca",position:"51%"},{color:"#7db9e8",position:"100%"}]},{name:"Blue Gloss #3",stops:[{color:"#6db3f2",position:"0%"},{color:"#54a3ee",position:"50%"},{color:"#3690f0",position:"51%"},{color:"#1e69de",position:"100%"}]},{name:"Blue Gloss #4",stops:[{color:"#ebf1f6",position:"0%"},{color:"#abd3ee",position:"50%"},{color:"#89c3eb",position:"51%"},{color:"#d5ebfb",position:"100%"}]},{name:"Blue Gloss #5",stops:[{color:"#e4f5fc",position:"0%"},{color:"#bfe8f9",position:"50%"},{color:"#9fd8ef",position:"51%"},{color:"#2ab0ed",position:"100%"}]},{name:"Blue Gloss",stops:[{color:"#cedbe9",position:"0%"},{color:"#aac5de",position:"17%"},{color:"#6199c7",position:"50%"},{color:"#3a84c3",position:"51%"},{color:"#419ad6",position:"59%"},{color:"#4bb8f0",position:"71%"},{color:"#3a8bc2",position:"84%"},{color:"#26558b",position:"100%"}]},{name:"Blue Grey 3D",stops:[{color:"#a7c7dc",position:"0%"},{color:"#85b2d3",position:"100%"}]},{name:"Blue Grey Flat",stops:[{color:"#3f4c6b",position:"0%"},{color:"#3f4c6b",position:"100%"}]},{name:"Blue Pipe #1",stops:[{color:"#d0e4f7",position:"0%"},{color:"#73b1e7",position:"24%"},{color:"#0a77d5",position:"50%"},{color:"#539fe1",position:"79%"},{color:"#87bcea",position:"100%"}]},{name:"Blue Pipe #2",stops:[{color:"#e1ffff",position:"0%"},{color:"#e1ffff",position:"7%"},{color:"#e1ffff",position:"12%"},{color:"#fdffff",position:"12%"},{color:"#e6f8fd",position:"30%"},{color:"#c8eefb",position:"54%"},{color:"#bee4f8",position:"75%"},{color:"#b1d8f5",position:"100%"}]},{name:"Blue Pipe",stops:[{color:"#b3dced",position:"0%"},{color:"#29b8e5",position:"50%"},{color:"#bce0ee",position:"100%"}]},{name:"Brown 3D",stops:[{color:"#d5cea6",position:"0%"},{color:"#c9c190",position:"40%"},{color:"#b7ad70",position:"100%"}]},{name:"Brown Gloss",stops:[{color:"#f0b7a1",position:"0%"},{color:"#8c3310",position:"50%"},{color:"#752201",position:"51%"},{color:"#bf6e4e",position:"100%"}]},{name:"Brown Red 3D",stops:[{color:"#a90329",position:"0%"},{color:"#8f0222",position:"44%"},{color:"#6d0019",position:"100%"}]},{name:"Gold 3D",stops:[{color:"#fefcea",position:"0%"},{color:"#f1da36",position:"100%"}]},{name:"Green 3D #1",stops:[{color:"#b4ddb4",position:"0%"},{color:"#83c783",position:"17%"},{color:"#52b152",position:"33%"},{color:"#008a00",position:"67%"},{color:"#005700",position:"83%"},{color:"#002400",position:"100%"}]},{name:"Green 3D #2",stops:[{color:"#cdeb8e",position:"0%"},{color:"#a5c956",position:"100%"}]},{name:"Green 3D #3",stops:[{color:"#c9de96",position:"0%"},{color:"#8ab66b",position:"44%"},{color:"#398235",position:"100%"}]},{name:"Green 3D #4",stops:[{color:"#f8ffe8",position:"0%"},{color:"#e3f5ab",position:"33%"},{color:"#b7df2d",position:"100%"}]},{name:"Green 3D #2",stops:[{color:"#a9db80",position:"0%"},{color:"#96c56f",position:"100%"}]},{name:"Green 3D",stops:[{color:"#b4e391",position:"0%"},{color:"#61c419",position:"50%"},{color:"#b4e391",position:"100%"}]},{name:"Green Flat #1",stops:[{color:"#299a0b",position:"0%"},{color:"#299a0b",position:"100%"}]},{name:"Green Flat #2",stops:[{color:"#8fc800",position:"0%"},{color:"#8fc800",position:"100%"}]},{name:"Green Flat #3",stops:[{color:"#006e2e",position:"0%"},{color:"#006e2e",position:"100%"}]},{name:"Green Flat #4",stops:[{color:"#6bba70",position:"0%"},{color:"#6bba70",position:"100%"}]},{name:"Green Flat #5",stops:[{color:"#cdeb8b",position:"0%"},{color:"#cdeb8b",position:"100%"}]},{name:"Green Flat #6",stops:[{color:"#8fc400",position:"0%"},{color:"#8fc400",position:"100%"}]},{name:"Green Flat",stops:[{color:"#b6e026",position:"0%"},{color:"#abdc28",position:"100%"}]},{name:"Green Gloss #1",stops:[{color:"#9dd53a",position:"0%"},{color:"#a1d54f",position:"50%"},{color:"#80c217",position:"51%"},{color:"#7cbc0a",position:"100%"}]},{name:"Green Gloss #2",stops:[{color:"#e6f0a3",position:"0%"},{color:"#d2e638",position:"50%"},{color:"#c3d825",position:"51%"},{color:"#dbf043",position:"100%"}]},{name:"Green Gloss",stops:[{color:"#bfd255",position:"0%"},{color:"#8eb92a",position:"50%"},{color:"#72aa00",position:"51%"},{color:"#9ecb2d",position:"100%"}]},{name:"Green Semi Flat",stops:[{color:"#b4df5b",position:"0%"},{color:"#b4df5b",position:"100%"}]},{name:"Gren 3D",stops:[{color:"#eeeeee",position:"0%"},{color:"#cccccc",position:"100%"}]},{name:"Grey 3D #1",stops:[{color:"#cedce7",position:"0%"},{color:"#596a72",position:"100%"}]},{name:"Grey 3D #2",stops:[{color:"#606c88",position:"0%"},{color:"#3f4c6b",position:"100%"}]},{name:"Grey 3D #3",stops:[{color:"#b0d4e3",position:"0%"},{color:"#88bacf",position:"100%"}]},{name:"Grey 3D #4",stops:[{color:"#f2f5f6",position:"0%"},{color:"#e3eaed",position:"37%"},{color:"#c8d7dc",position:"100%"}]},{name:"Grey 3D",stops:[{color:"#d8e0de",position:"0%"},{color:"#aebfbc",position:"22%"},{color:"#99afab",position:"33%"},{color:"#8ea6a2",position:"50%"},{color:"#829d98",position:"67%"},{color:"#4e5c5a",position:"82%"},{color:"#0e0e0e",position:"100%"}]},{name:"Grey Black 3D",stops:[{color:"#b5bdc8",position:"0%"},{color:"#828c95",position:"36%"},{color:"#28343b",position:"100%"}]},{name:"Grey Blue 3D #1",stops:[{color:"#b8c6df",position:"0%"},{color:"#6d88b7",position:"100%"}]},{name:"Grey Blue 3D",stops:[{color:"#cfe7fa",position:"0%"},{color:"#6393c1",position:"100%"}]},{name:"Grey Blue Gloss #1",stops:[{color:"#d2dfed",position:"0%"},{color:"#c8d7eb",position:"26%"},{color:"#bed0ea",position:"51%"},{color:"#a6c0e3",position:"51%"},{color:"#afc7e8",position:"62%"},{color:"#bad0ef",position:"75%"},{color:"#99b5db",position:"88%"},{color:"#799bc8",position:"100%"}]},{name:"Grey Flat",stops:[{color:"#eeeeee",position:"0%"},{color:"#eeeeee",position:"100%"}]},{name:"Grey Gloss #1",stops:[{color:"#e2e2e2",position:"0%"},{color:"#dbdbdb",position:"50%"},{color:"#d1d1d1",position:"51%"},{color:"#fefefe",position:"100%"}]},{name:"Grey Gloss #2",stops:[{color:"#f2f6f8",position:"0%"},{color:"#d8e1e7",position:"50%"},{color:"#b5c6d0",position:"51%"},{color:"#e0eff9",position:"100%"}]},{name:"Grey Gloss",stops:[{color:"#d4e4ef",position:"0%"},{color:"#86aecc",position:"100%"}]},{name:"Grey Pipe",stops:[{color:"#f5f6f6",position:"0%"},{color:"#dbdce2",position:"21%"},{color:"#b8bac6",position:"49%"},{color:"#dddfe3",position:"80%"},{color:"#f5f6f6",position:"100%"}]},{name:"L Brown 3D",stops:[{color:"#f3e2c7",position:"0%"},{color:"#c19e67",position:"50%"},{color:"#b68d4c",position:"51%"},{color:"#e9d4b3",position:"100%"}]},{name:"L Green 3D",stops:[{color:"#f9fcf7",position:"0%"},{color:"#f5f9f0",position:"100%"}]},{name:"Lavender 3D",stops:[{color:"#c3d9ff",position:"0%"},{color:"#b1c8ef",position:"41%"},{color:"#98b0d9",position:"100%"}]},{name:"Neon",stops:[{color:"#d2ff52",position:"0%"},{color:"#91e842",position:"100%"}]},{name:"Olive 3D #1",stops:[{color:"#fefefd",position:"0%"},{color:"#dce3c4",position:"42%"},{color:"#aebf76",position:"100%"}]},{name:"Olive 3D #2",stops:[{color:"#e4efc0",position:"0%"},{color:"#abbd73",position:"100%"}]},{name:"Olive 3D #3",stops:[{color:"#a4b357",position:"0%"},{color:"#75890c",position:"100%"}]},{name:"Olive 3D",stops:[{color:"#627d4d",position:"0%"},{color:"#1f3b08",position:"100%"}]},{name:"Olive Flat",stops:[{color:"#73880a",position:"0%"},{color:"#73880a",position:"100%"}]},{name:"Orange 3D #1",stops:[{color:"#ffaf4b",position:"0%"},{color:"#ff920a",position:"100%"}]},{name:"Orange 3D #2",stops:[{color:"#fac695",position:"0%"},{color:"#f5ab66",position:"47%"},{color:"#ef8d31",position:"100%"}]},{name:"Orange 3D #3",stops:[{color:"#ffc578",position:"0%"},{color:"#fb9d23",position:"100%"}]},{name:"Orange 3D #4",stops:[{color:"#f9c667",position:"0%"},{color:"#f79621",position:"100%"}]},{name:"Orange 3D #5",stops:[{color:"#fceabb",position:"0%"},{color:"#fccd4d",position:"50%"},{color:"#f8b500",position:"51%"},{color:"#fbdf93",position:"100%"}]},{name:"Orange 3D",stops:[{color:"#ffa84c",position:"0%"},{color:"#ff7b0d",position:"100%"}]},{name:"Orange Flat #1",stops:[{color:"#ff670f",position:"0%"},{color:"#ff670f",position:"100%"}]},{name:"Orange Flat",stops:[{color:"#ff7400",position:"0%"},{color:"#ff7400",position:"100%"}]},{name:"Orange Gloss",stops:[{color:"#ffb76b",position:"0%"},{color:"#ffa73d",position:"50%"},{color:"#ff7c00",position:"51%"},{color:"#ff7f04",position:"100%"}]},{name:"Pink 3D #1",stops:[{color:"#ff5db1",position:"0%"},{color:"#ef017c",position:"100%"}]},{name:"Pink 3D #2",stops:[{color:"#fb83fa",position:"0%"},{color:"#e93cec",position:"100%"}]},{name:"Pink 3D #3",stops:[{color:"#e570e7",position:"0%"},{color:"#c85ec7",position:"47%"},{color:"#a849a3",position:"100%"}]},{name:"Pink 3D",stops:[{color:"#cb60b3",position:"0%"},{color:"#ad1283",position:"50%"},{color:"#de47ac",position:"100%"}]},{name:"Pink Flat",stops:[{color:"#ff0084",position:"0%"},{color:"#ff0084",position:"100%"}]},{name:"Pink Gloss #2",stops:[{color:"#fcecfc",position:"0%"},{color:"#fba6e1",position:"50%"},{color:"#fd89d7",position:"51%"},{color:"#ff7cd8",position:"100%"}]},{name:"Pink Gloss",stops:[{color:"#cb60b3",position:"0%"},{color:"#c146a1",position:"50%"},{color:"#a80077",position:"51%"},{color:"#db36a4",position:"100%"}]},{name:"Purple 3D #1",stops:[{color:"#ebe9f9",position:"0%"},{color:"#d8d0ef",position:"50%"},{color:"#cec7ec",position:"51%"},{color:"#c1bfea",position:"100%"}]},{name:"Purple 3D",stops:[{color:"#8989ba",position:"0%"},{color:"#8989ba",position:"100%"}]},{name:"Red 3D #1",stops:[{color:"#febbbb",position:"0%"},{color:"#fe9090",position:"45%"},{color:"#ff5c5c",position:"100%"}]},{name:"Red 3D #2",stops:[{color:"#f2825b",position:"0%"},{color:"#e55b2b",position:"50%"},{color:"#f07146",position:"100%"}]},{name:"Red 3D",stops:[{color:"#ff3019",position:"0%"},{color:"#cf0404",position:"100%"}]},{name:"Red Flat #1",stops:[{color:"#ff1a00",position:"0%"},{color:"#ff1a00",position:"100%"}]},{name:"Red Flat",stops:[{color:"#cc0000",position:"0%"},{color:"#cc0000",position:"100%"}]},{name:"Red Gloss #1",stops:[{color:"#f85032",position:"0%"},{color:"#f16f5c",position:"50%"},{color:"#f6290c",position:"51%"},{color:"#f02f17",position:"71%"},{color:"#e73827",position:"100%"}]},{name:"Red Gloss #2",stops:[{color:"#feccb1",position:"0%"},{color:"#f17432",position:"50%"},{color:"#ea5507",position:"51%"},{color:"#fb955e",position:"100%"}]},{name:"Red Gloss #3",stops:[{color:"#efc5ca",position:"0%"},{color:"#d24b5a",position:"50%"},{color:"#ba2737",position:"51%"},{color:"#f18e99",position:"100%"}]},{name:"Red Gloss",stops:[{color:"#f3c5bd",position:"0%"},{color:"#e86c57",position:"50%"},{color:"#ea2803",position:"51%"},{color:"#ff6600",position:"75%"},{color:"#c72200",position:"100%"}]},{name:"Shape 1 Style",stops:[{color:"#b7deed",position:"0%"},{color:"#71ceef",position:"50%"},{color:"#21b4e2",position:"51%"},{color:"#b7deed",position:"100%"}]},{name:"Shape 2 Style",stops:[{color:"#e0f3fa",position:"0%"},{color:"#d8f0fc",position:"50%"},{color:"#b8e2f6",position:"51%"},{color:"#b6dffd",position:"100%"}]},{name:"Wax 3D #1",stops:[{color:"#feffe8",position:"0%"},{color:"#d6dbbf",position:"100%"}]},{name:"Wax 3D #2",stops:[{color:"#fcfff4",position:"0%"},{color:"#e9e9ce",position:"100%"}]},{name:"Wax 3D #3",stops:[{color:"#fcfff4",position:"0%"},{color:"#dfe5d7",position:"40%"},{color:"#b3bead",position:"100%"}]},{name:"Wax 3D",stops:[{color:"#e5e696",position:"0%"},{color:"#d1d360",position:"100%"}]},{name:"Wax Flat",stops:[{color:"#eaefb5",position:"0%"},{color:"#e1e9a0",position:"100%"}]},{name:"Black 3D #1",stops:[{color:"#45484d",position:"0%"},{color:"#000000",position:"100%"}]},{name:"Black 3D",stops:[{color:"#7d7e7d",position:"0%"},{color:"#0e0e0e",position:"100%"}]},{name:"Black Gloss Pipe",stops:[{color:"#959595",position:"0%"},{color:"#0d0d0d",position:"46%"},{color:"#010101",position:"50%"},{color:"#0a0a0a",position:"53%"},{color:"#4e4e4e",position:"76%"},{color:"#383838",position:"87%"},{color:"#1b1b1b",position:"100%"}]},{name:"Black Gloss",stops:[{color:"#aebcbf",position:"0%"},{color:"#6e7774",position:"50%"},{color:"#0a0e0a",position:"51%"},{color:"#0a0809",position:"100%"}]},{name:"Web 2.0 Blue 3D #1",stops:[{color:"#c5deea",position:"0%"},{color:"#8abbd7",position:"31%"},{color:"#066dab",position:"100%"}]},{name:"Blue 3D #1",stops:[{color:"#f7fbfc",position:"0%"},{color:"#d9edf2",position:"40%"},{color:"#add9e4",position:"100%"}]},{name:"Blue 3D",stops:[{color:"#d6f9ff",position:"0%"},{color:"#9ee8fa",position:"100%"}]},{name:"Blue 3D #3",stops:[{color:"#e9f6fd",position:"0%"},{color:"#d3eefb",position:"100%"}]},{name:"Blue 3D #4",stops:[{color:"#63b6db",position:"0%"},{color:"#309dcf",position:"100%"}]},{name:"Blue 3D #2",stops:[{color:"#2c539e",position:"0%"},{color:"#2c539e",position:"100%"}]},{name:"Ble 3D #5",stops:[{color:"#a9e4f7",position:"0%"},{color:"#0fb4e7",position:"100%"}]},{name:"Blue 3D #5",stops:[{color:"#93cede",position:"0%"},{color:"#75bdd1",position:"41%"},{color:"#49a5bf",position:"100%"}]},{name:"Blue 3D #6",stops:[{color:"#b2e1ff",position:"0%"},{color:"#66b6fc",position:"100%"}]},{name:"Blue 3D #9",stops:[{color:"#4f85bb",position:"0%"},{color:"#4f85bb",position:"100%"}]},{name:"Blue 3D #10",stops:[{color:"#deefff",position:"0%"},{color:"#98bede",position:"100%"}]},{name:"Blue 3D #11",stops:[{color:"#49c0f0",position:"0%"},{color:"#2cafe3",position:"100%"}]},{name:"Blue 3D #12",stops:[{color:"#feffff",position:"0%"},{color:"#d2ebf9",position:"100%"}]},{name:"Blue 3d #8",stops:[{color:"#a7cfdf",position:"0%"},{color:"#23538a",position:"100%"}]},{name:"Blue 3d #7",stops:[{color:"#499bea",position:"0%"},{color:"#207ce5",position:"100%"}]},{name:"Blue Flat",stops:[{color:"#356aa0",position:"0%"},{color:"#356aa0",position:"100%"}]},{name:"White 3D #1",stops:[{color:"#ffffff",position:"0%"},{color:"#f6f6f6",position:"47%"},{color:"#ededed",position:"100%"}]},{name:"White 3D #2",stops:[{color:"#f2f9fe",position:"0%"},{color:"#d6f0fd",position:"100%"}]},{name:"White 3D",stops:[{color:"#ffffff",position:"0%"},{color:"#e5e5e5",position:"100%"}]},{name:"White Gloss #1",stops:[{color:"#ffffff",position:"0%"},{color:"#f1f1f1",position:"50%"},{color:"#e1e1e1",position:"51%"},{color:"#f6f6f6",position:"100%"}]},{name:"White Gloss #2",stops:[{color:"#ffffff",position:"0%"},{color:"#f3f3f3",position:"50%"},{color:"#ededed",position:"51%"},{color:"#ffffff",position:"100%"}]},{name:"White Gloss",stops:[{color:"#f6f8f9",position:"0%"},{color:"#e5ebee",position:"50%"},{color:"#d7dee3",position:"51%"},{color:"#f5f7f9",position:"100%"}]},{name:"Yellow 3D #1",stops:[{color:"#f6e6b4",position:"0%"},{color:"#ed9017",position:"100%"}]},{name:"Yellow 3D #2",stops:[{color:"#eab92d",position:"0%"},{color:"#c79810",position:"100%"}]},{name:"Yellow 3D #2",stops:[{color:"#ffd65e",position:"0%"},{color:"#febf04",position:"100%"}]},{name:"Yellow 3D",stops:[{color:"#f1e767",position:"0%"},{color:"#feb645",position:"100%"}]},{name:"Yellow Flat #1",stops:[{color:"#ffff88",position:"0%"},{color:"#ffff88",position:"100%"}]},{name:"Yellow Flat",stops:[{color:"#febf01",position:"0%"},{color:"#febf01",position:"100%"}]}]}},Gradient.DB.Default=Gradient.DB.UltimateWeb2,void 0===Gradient&&(Gradient={}),Gradient.Editor=function(t){var i=this,t=(-1!=navigator.appVersion.indexOf("Mac")&&$$("body")[0].addClassName("macos"),this.gradientControl=$(t),this.gradientPanelElem=this.gradientControl.select(".gradient-panel")[0],this.gradientMarkersContainerElem=this.gradientControl.select(".stop-markers-color")[0],this.gradientMarkerDeleterElem=this.gradientControl.select(".stop-markers-color-deleter")[0],this.stopDetailsPanel=this.gradientControl.select(".stop-details-color")[0],{gradientEditor:this,gradientControl:this.gradientControl,gradientPanelElem:this.gradientPanelElem,gradientMarkersContainerElem:this.gradientMarkersContainerElem,gradientMarkerDeleterElem:this.gradientMarkerDeleterElem,stopDetailsPanel:this.stopDetailsPanel,onStopActivatedCallback:this.onStopActivated.bind(this)}),t=(this.colorStopsHandler=new Gradient.StopsHandler("color",t),this.gradientOpacityMarkersContainerElem=this.gradientControl.select(".stop-markers-opacity")[0],this.gradientOpacityMarkerDeleterElem=this.gradientControl.select(".stop-markers-opacity-deleter")[0],this.opacityStopDetailsPanel=this.gradientControl.select(".stop-details-opacity")[0],{gradientEditor:this,gradientControl:this.gradientControl,gradientPanelElem:this.gradientPanelElem,gradientMarkersContainerElem:this.gradientOpacityMarkersContainerElem,gradientMarkerDeleterElem:this.gradientOpacityMarkerDeleterElem,stopDetailsPanel:this.opacityStopDetailsPanel,onStopActivatedCallback:this.onStopActivated.bind(this)});this.opacityStopsHandler=new Gradient.StopsHandler("opacity",t),this.cssTextElem=this.gradientControl.select(".css-output-text")[0],this.cssCopyButtonContainerElem=this.gradientControl.select(".copy-button-container")[0],this.cssCopyButtonElem=this.cssCopyButtonContainerElem.select(".copy-button")[0],this.cssCopyStatusElem=this.gradientControl.select(".copy-status")[0],this.cssNotesElem=this.gradientControl.select(".css-notes")[0],this.cssNotesTextElem=this.cssNotesElem.select(".css-notes-text")[0],this.cssCompatNotesElem=$$(".browser-compatibility .css-notes")[0],this.cssCompatNotesTextElem=this.cssCompatNotesElem.select(".css-notes-text")[0],this.cssNotesCloseButton=this.cssNotesElem.select(".small-close-button")[0],this.cssNotesCloseButton.observe("click",function(){i.cssNotesElem.hide()}),this.cssCompatNotesCloseButton=this.cssCompatNotesElem.select(".small-close-button")[0],this.cssCompatNotesCloseButton.observe("click",function(){i.cssCompatNotesElem.hide()}),this.currentOutputFormatElem=this.gradientControl.select(".current-output-format")[0],this.switchOutputFormatElem=this.gradientControl.select(".switch-output-format")[0],this.previewBackgroundElem=this.gradientControl.select(".preview-panel-background")[0],this.previewElem=this.gradientControl.select(".preview-panel")[0],this.previewHandleElem=this.gradientControl.select(".preview-panel-handle")[0],this.orientationSelectorElem=this.gradientControl.select(".output-options .orientation")[0],this.previewDimensionWidthElem=this.gradientControl.select(".output-options .dimension-width")[0],this.previewDimensionHeightElem=this.gradientControl.select(".output-options .dimension-height")[0],this.previewAsIECheckboxElem=this.gradientControl.select(".output-options input.preview-as-ie")[0],this.presetsContainerElem=this.gradientControl.select(".presets .presets-container")[0],this.gradientNameBoxElem=this.gradientControl.select(".gradient-name .name-input")[0],this.saveNewPresetButtonElem=this.gradientControl.select(".gradient-name .save-new-preset")[0],Gradient.UIUtils.makeResizable(this.previewBackgroundElem,this.previewHandleElem,function(t,e){i.previewDimensionsWidth=t-2,i.previewDimensionsHeight=e-2,i.previewDimensionWidthElem.value=i.previewDimensionsWidth,i.previewDimensionHeightElem.value=i.previewDimensionsHeight,ColorZilla.Persist.set("preview-width",i.previewDimensionsWidth),ColorZilla.Persist.set("preview-height",i.previewDimensionsHeight)}),this.colorFormatSelectorElem=this.gradientControl.select(".css-options .color-format")[0],this.includeCSSCommentsCheckboxElem=this.gradientControl.select(".css-options input#css-comments")[0],this.supportIE9CheckboxElem=$$("input#css-ie9-support")[0],this.maximizeCssCompatibilityElem=$$("input#maximize-css-compatibility")[0],this.supportIE9HelpElem=$$(".css-ie9-support-help a")[0],this.colorPickerElem=$("colorpicker-1"),this.gradientPanelElemWidth=Element.getWidth(this.gradientPanelElem),this.gradientPanelElemWidth-=2,this.cssTextElem.observe("dblclick",function(){Gradient.Utils.selectTextInNode(i.cssTextElem),Gradient.Utils.sendEvent("generated-output","text-select")}),this.orientationSelectorElem.observe("change",this.onOrientationSelectorChange.bind(this)),this.previewDimensionWidthElem.observe("change",this.onPreviewDimensionsChange.bind(this)),this.previewDimensionHeightElem.observe("change",this.onPreviewDimensionsChange.bind(this)),this.previewAsIECheckboxElem.observe("change",this.onPreviewAsIECheckboxChange.bind(this)),this.colorFormatSelectorElem.observe("change",this.onColorFormatSelectorChange.bind(this)),this.includeCSSCommentsCheckboxElem.observe("change",this.onIncludeCSSCommentsCheckboxChange.bind(this)),this.saveNewPresetButtonElem.observe("click",this.onSaveNewPresetButtonClick.bind(this)),this.supportIE9CheckboxElem.observe("change",this.onSupportIE9CheckboxChange.bind(this)),this.supportIE9HelpElem.observe("click",function(t){Event.stop(t),i.showIE9SupportInstructions()}),this.maximizeCssCompatibilityElem.observe("change",this.onMaximizeCssCompatibilityCheckboxChange.bind(this)),this.importFromCSSButton=this.gradientControl.select("a.import-css")[0],this.importFromCSSButton.observe("click",this.onImportFromCSSButtonClicked.bind(this)),this.importFromCSSPanel=this.gradientControl.select(".import-css-input-panel")[0],this.importFromCSSPanelOkButton=this.gradientControl.select(".import-css-input-panel button.ok")[0],this.importFromCSSPanelOkButton.observe("click",this.onImportFromCSSPanelOkButtonClick.bind(this)),this.importFromCSSPanelCancelButton=this.gradientControl.select(".import-css-input-panel button.cancel")[0],this.importFromCSSPanelCancelButton.observe("click",this.onImportFromCSSPanelCancelButtonClick.bind(this)),this.importFromCSSTextElem=this.gradientControl.select(".import-css-input-panel .import-css-text")[0],this.importFromImageButton=this.gradientControl.select("a.import-image")[0],this.importFromImageButton.observe("click",this.onImportFromImageButtonClicked.bind(this)),this.importFromImagePanel=this.gradientControl.select(".import-image-input-panel")[0],this.importFromImageForm=this.gradientControl.select(".import-image-form")[0],this.importFromImagePanelOkButton=this.gradientControl.select(".import-image-input-panel button.ok")[0],this.importFromImagePanelOkButton.observe("click",this.onImportFromImagePanelOkButtonClick.bind(this)),this.importFromImagePanelCancelButton=this.gradientControl.select(".import-image-input-panel button.cancel")[0],this.importFromImagePanelCancelButton.observe("click",this.onImportFromImagePanelCancelButtonClick.bind(this)),this.importFromImageFileInputElem=this.gradientControl.select(".import-image-input-panel input.import-image-file-input")[0],this.importFromImageURLInputElem=this.gradientControl.select(".import-image-input-panel input.import-image-url-input")[0],this.switchOutputFormatElem.observe("click",this.onSwitchOutputFormatClicked.bind(this)),this.permalinkElem=this.gradientControl.select(".permalink-panel .permalink")[0],this.permalinkElem.observe("mousedown",function(){Gradient.Utils.sendEvent("permalink","click")}),this.cssImporter=null,this.lastUsedColor="#ffffff",this.outputOrientation=ColorZilla.Persist.get("output-orientation","vertical"),this.orientationSelectorElem.value=this.outputOrientation,this.previewDimensionsWidth=ColorZilla.Persist.get("preview-width","370"),this.previewDimensionsHeight=ColorZilla.Persist.get("preview-height","50"),this.previewDimensionWidthElem.value=this.previewDimensionsWidth,this.previewDimensionHeightElem.value=this.previewDimensionsHeight,this.previewAsIE=!1,this.cssColorFormat=ColorZilla.Persist.get("css-color-format","hex"),this.colorFormatSelectorElem.value=this.cssColorFormat,this.includeCSSComments="true"==ColorZilla.Persist.get("include-css-comments","true"),this.includeCSSCommentsCheckboxElem.checked=this.includeCSSComments,this.supportIE9="true"==ColorZilla.Persist.get("support-ie9","false"),this.supportIE9CheckboxElem.checked=this.supportIE9,this.updateIE9CompatibilityDisplay(this.supportIE9),this.maximizeCSSCompatibility="true"==ColorZilla.Persist.get("maximize-css-compatibility","false"),this.maximizeCssCompatibilityElem.checked=this.maximizeCSSCompatibility,this.updateMaximizeCSSCompatibilityDisplay(this.maximizeCSSCompatibility),this.outputFormat=ColorZilla.Persist.get("output-format","css"),this.switchToPresetSet("Default"),this.userGradientPresets=Gradient.UserPresets.get(),this.userGradientPresetsIDCounter=this.userGradientPresets.length,this.addUserPresets(this.userGradientPresets),setTimeout(function(){Refresh.Web.DefaultColorPickerSettings.clientFilesPath="/colorpicker/images/",i.colorPicker=new Refresh.Web.ColorPicker("cp1",{startHex:"ffcc00",startMode:"s"}),i.colorPicker.updateColorZilla=function(){var t=Refresh.Web.ColorMethods.normalizeHex($("cp1_Hex").value);i.colorStopsHandler.changeActiveStopValue("#"+t)},i.colorPickerDialogWin=new Window({top:170,left:400,maximizable:!1,resizable:!1,minimizable:!1,hideEffect:Element.hide,showEffect:Element.show}),i.colorPickerDialogWin.setContent("colorpicker-1",!0,!1);var t=i.colorPickerElem.select(".dialog-button.ok-button")[0],e=i.colorPickerElem.select(".dialog-button.cancel-button")[0],t=(t.observe("click",function(){i.invalidateCurrentPreset();var t=Refresh.Web.ColorMethods.normalizeHex($("cp1_Hex").value);i.lastUsedColor="#"+t,i.colorPickerDialogWin.close()}),e.observe("click",function(){i.colorPickerDialogWin.close()}),Event.observe(window,"keypress",function(t){t.keyCode==Event.KEY_ESC&&i.colorPickerDialogWin.visible&&i.colorPickerDialogWin.close()}),myObserver={onClose:function(t,e){e==i.colorPickerDialogWin&&i.colorStopsHandler.changeActiveStopValue(i.lastUsedColor)}},Windows.addObserver(myObserver),[{name:Gradient.Utils.i18n("save-current-gradient"),callback:function(t){i.onSaveNewPresetButtonClick()},className:"new-preset"},{name:Gradient.Utils.i18n("delete-gradient"),callback:function(t){i.deleteUserPreset(t.contextMenuElement)},className:"delete-preset"}]);new Proto.Menu({beforeShow:function(t){var e=t.contextMenuContainerElement.select(".delete-preset")[0];t.contextMenuElement.hasClassName("user-preset")?(e.addClassName("enabled"),e.removeClassName("disabled")):(e.addClassName("disabled"),e.removeClassName("enabled"))},selector:".has-preset-contextmenu",className:"menu desktop preset-context-menu",menuItems:t}),i.updateOutputFormatHeaders(),i.initCopyToClipboard()},10),setTimeout(function(){i.gradientAdjuster=new Gradient.Adjustments(i)},10);var e,t=this.getGradientFromPermalinkHash(window.location.hash);t?Gradient.Utils.sendEvent("permalink","loaded",(e=t).name):e=0<this.userGradientPresets.length?this.userGradientPresets[this.userGradientPresets.length-1]:Gradient.DB.Default.gradients[0],this.setCurrentPreset(e.name,Gradient.Utils.deepClone(e.stops),Gradient.Utils.deepClone(this.getGradientPresetOpacityStops(e))),Event.observe(window,"hashchange",this.onHashChanged.bind(this)),this.uiUpdateTimerID=0},Gradient.Editor.prototype={cssGradientsSupported:function(){var t=document.createElement("div");return t.style.cssText="background-image:gradient(linear,left top,right bottom,from(#222),to(#444));background-image:-o-gradient(linear,left top,right bottom,from(#222),to(#444));background-image:-moz-gradient(linear,left top,right bottom,from(#222),to(#444));background-image:-ms-gradient(linear,left top,right bottom,from(#222),to(#444));background-image:-webkit-gradient(linear,left top,right bottom,from(#222),to(#444));background-image:-khtml-gradient(linear,left top,right bottom,from(#222),to(#444));background-image:linear-gradient(left top,#222, #444);background-image:-o-linear-gradient(left top,#222, #444);background-image:-moz-linear-gradient(left top,#222, #444);background-image:-ms-linear-gradient(left top,#222, #444);background-image:-webkit-linear-gradient(left top,#222, #444);background-image:-khtml-linear-gradient(left top,#222, #444);",-1!==t.style.backgroundImage.indexOf("gradient")},formatCSSColor:function(t,e,i){var o;return"hex"==i||"iehex"==i&&1==e?t.toLowerCase():"iehex"==i?("#"==(t=t.toLowerCase()).substr(0,1)&&(t=t.substring(1)),e=Math.round(255*e),"#"+(e=Gradient.Utils.decimalToHexa(e))+t):(o=Gradient.Utils.hexaToRGB(t),"rgb"==i?Gradient.Utils.rbgToRGBCSS(o):"rgba"==i?Gradient.Utils.rbgAndAlphaToRGBACSS(o,e):"hsl"==i?Gradient.Utils.rgbToHSLCSS(o):"hsla"==i?Gradient.Utils.rgbToHSLCSS(o,e):t)},generateCSSRules:function(t,e,i){var o,n,s,r,a,l,c,h=t,u=(void 0===i&&(i="hex"),"linear"),p=!1;switch(e=void 0===e?"horizontal":e){case"horizontal":o="left top, right top",s="GradientType=1",r="horizontal",l=a=n="left",c="to right";break;case"vertical":o="left top, left bottom",s="GradientType=0",r="vertical",l=a=n="top",c="to bottom";break;case"diagonal":o="left top, right bottom",s="GradientType=1",r="horizontal",a=n="-45deg",p=!0,l="left top",c="135deg";break;case"diagonal-bottom":o="left bottom, right top",s="GradientType=1",r="horizontal",p=!0,l="left bottom",c=a=n="45deg";break;case"radial":u="radial",o="center center, 0px, center center, 100%",s="GradientType=1",r="horizontal",l=a=n="center, ellipse cover",p=!0,c="ellipse at center"}var t=this.formatCSSColor(h[0].color,1,"rgba"==i?"rgb":"hex"!=i&&"rgb"!=i?"hex":i),d=[],f=[],e=this.formatCSSColor(h[0].color,h[0].opacity,"iehex"),m=this.formatCSSColor(h[h.length-1].color,h[h.length-1].opacity,"iehex");ieCSS="startColorstr='"+e+"', endColorstr='"+m+"'";for(var g=0;g<h.length;g++){var b=this.formatCSSColor(h[g].color,h[g].opacity,i),v=h[g].position;d.push(b+" "+v),f.push("color-stop("+v+","+b+")")}var y=d,E="-webkit-"+u+"-gradient("+n+",  "+d+")",S="-ms-"+u+"-gradient("+n+",  "+d+")",w=d,C=u+"-gradient("+c+",  "+d+")";return{kind:u,solid:t,moz:d="-moz-"+u+"-gradient("+n+",  "+(d=d.join(", "))+")",webkit:f="-webkit-gradient("+u+", "+o+", "+(f=f.join(", "))+")",newWebkit:E,ie:ieCSS="progid:DXImageTransform.Microsoft.gradient( "+ieCSS+","+s+" )",ieCSSIsFallback:p,ieCSS3:S,opera:"-o-"+u+"-gradient("+a+",  "+y+")",w3Standard:C,standardSCSS:u+"-gradient("+l+",  "+w+")",ieSCSS:"filter-gradient("+e+", "+m+", "+r+");"}},generateSVGRule:function(t,e){t=this.generateSVG(t,e);return"url("+Gradient.Utils.dataURIEncode(t,"image/svg+xml")+")"},generateSVG:function(t,e){var i,o=t,n="linear",s='x="0" y="0" width="1" height="1"';switch(e){case"horizontal":i='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"vertical":i='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"diagonal":i='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"diagonal-bottom":i='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"radial":n="radial",i='cx="50%" cy="50%" r="75%"',s='x="-50" y="-50" width="101" height="101"'}new Date;var t="ucgg-generated",r=[];r.push('<?xml version="1.0" ?>'),r.push('<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none">'),r.push("  <"+n+'Gradient id="grad-'+t+'" gradientUnits="userSpaceOnUse" '+i+">");for(var a=0;a<o.length;a++){var l=o[a].color.toLowerCase(),c=o[a].opacity,h=o[a].position;r.push('    <stop offset="'+h+'" stop-color="'+l+'" stop-opacity="'+c+'"/>')}return r.push("  </"+n+"Gradient>"),r.push("  <rect "+s+' fill="url(#grad-'+t+')" />'),r.push("</svg>"),r=r.join("\n")},setElementGradientBackground:function(t,e){try{t.style.background=e.solid}catch(t){}try{t.style.background=e.moz}catch(t){}try{t.style.background=e.webkit}catch(t){}try{t.style.background=e.newWebkit}catch(t){}try{t.style.background=e.opera}catch(t){}try{t.style.background=e.ieCSS3}catch(t){}try{t.style.filter=e.ie}catch(t){}try{t.style.background=e.w3Standard}catch(t){}},setColorStops:function(t){this.colorStopsHandler.setStops(t),this.updateAllUI()},setAllStops:function(t,e){this.colorStopsHandler.setStops(t),void 0!==e&&e?this.opacityStopsHandler.setStops(e):this.opacityStopsHandler.setStops(this.opacityStopsHandler.defaultStops),this.updateAllUI()},getColorStops:function(){return this.colorStopsHandler.getStops()},getOpacityStops:function(){return this.opacityStopsHandler.getStops()},currentGradientHasOpacity:function(){var t=this.getOpacityStops();return Gradient.StopUtils.gradientHasOpacity({stops:t})},getMergedStops:function(){if(this.currentGradientHasOpacity())return Gradient.StopUtils.mergeStops(this.getColorStops(),this.getOpacityStops());for(var t=Gradient.Utils.deepClone(this.getColorStops()),e=0;e<t.length;e++)t[e].opacity=1;return t},getGradientPresetOpacityStops:function(t){return"opacityStops"in t?t.opacityStops:this.opacityStopsHandler.defaultStops},setNewStopColor:function(t){this.lastUsedColor=t},updateAllUI:function(){this.mergedStops=this.getMergedStops(),this.updateGradientPanel(),this.colorStopsHandler.updateStopMarkers(),this.opacityStopsHandler.updateStopMarkers(),this.switchToOpacitySupportingColorModeIfNeeded(),this.cssRules=this.generateCSSRules(this.mergedStops,this.outputOrientation,this.cssColorFormat),this.updatePreviewElement();var t=this;clearTimeout(this.uiUpdateTimerID),this.uiUpdateTimerID=setTimeout(function(){t.supportIE9&&(t.cssRules.svg=t.generateSVGRule(t.mergedStops,t.outputOrientation)),t.updatePermalink(),t.updateCSSOutput()},50)},switchToOpacitySupportingColorModeIfNeeded:function(){var t;this.currentGradientHasOpacity()&&"rgba"!=this.cssColorFormat&&"hsla"!=this.cssColorFormat&&(this.cssColorFormat="hsl"==this.cssColorFormat?"hsla":"rgba",this.colorFormatSelectorElem.value=this.cssColorFormat,t=this.cssNotesTextElem.getAttribute("data-template"),this.cssNotesTextElem.innerHTML=t.replace(/__x__/,this.cssColorFormat),this.cssNotesElem.show(),ColorZilla.Persist.set("css-color-format",this.cssColorFormat))},adjustCopyButtonPositionForScrollbar:function(){void 0===this.scrollbarWidth&&(t=$$(".scrollbar-measure")[0],this.scrollbarWidth=t.offsetWidth-t.clientWidth,this.cssCopyButtonElemLastMargin=-1);var t=this.cssTextElem.scrollHeight>this.cssTextElem.getHeight()?this.scrollbarWidth:1;t!=this.cssCopyButtonElemLastMargin&&(this.cssCopyButtonElemLastMargin=t,this.cssCopyButtonElem.style.marginRight=t+"px")},getPermalink:function(){return"https://colorzilla.com/gradient-editor/#"+this.currentGradientToHash()},updatePermalink:function(){this.permalinkElem.setAttribute("href",this.getPermalink())},updateGradientPanel:function(){var t=this.mergedStops,t=this.generateCSSRules(t,"horizontal","rgba");this.setElementGradientBackground(this.gradientPanelElem,t)},updateCSSOutput:function(){var t=this.cssRules,e=[],i=[],o="IE9 SVG, needs conditional override of 'filter' to 'none'",n="IE6-9";this.supportIE9&&(n="IE6-8"),t.ieCSSIsFallback&&(n+=" fallback on horizontal gradient");let s;var r=this.cssTextElem.getAttribute("data-permalink-comment-english"),a=this.cssTextElem.getAttribute("data-permalink-comment-translated");s=r==a?r:r.replace(/:/,".")+" "+a,r="css"==this.outputFormat?(this.includeCSSComments&&e.push(`/* ${s} ${this.getPermalink()} */`),!this.currentGradientHasOpacity()&&this.maximizeCSSCompatibility&&e.push("background: "+t.solid+";"+(this.includeCSSComments?" /* Old browsers */":"")),this.supportIE9&&(this.includeCSSComments&&e.push("/* "+o+" */"),e.push("background: "+t.svg+";")),this.maximizeCSSCompatibility&&(e.push("background: "+t.moz+";"+(this.includeCSSComments?" /* FF3.6-15 */":"")),e.push("background: "+t.webkit+";"+(this.includeCSSComments?" /* Chrome4-9,Safari4-5 */":"")),e.push("background: "+t.newWebkit+";"+(this.includeCSSComments?" /* Chrome10-25,Safari5.1-6 */":""))),this.maximizeCSSCompatibility&&(e.push("background: "+t.opera+";"+(this.includeCSSComments?" /* Opera "+("linear"==t.kind?"11.10-11.50":"12+")+" */":"")),e.push("background: "+t.ieCSS3+";"+(this.includeCSSComments?" /* IE10 preview */":""))),e.push("background: "+t.w3Standard+";"+(this.includeCSSComments?" /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */":"")),this.maximizeCSSCompatibility&&e.push("filter: "+t.ie+";"+(this.includeCSSComments?" /* "+n+" */":"")),e):(this.includeCSSComments&&(i.push("// "+Gradient.Utils.i18n("needs-latest-compass")),i.push("// "+s),i.push("// "+this.getPermalink())),!this.currentGradientHasOpacity()&&this.maximizeCSSCompatibility&&i.push("background-color: "+t.solid+";"+(this.includeCSSComments?" // Old browsers":"")),this.maximizeCSSCompatibility&&i.push("@include "+t.ieSCSS+(this.includeCSSComments?" // "+n:"")),this.supportIE9&&(this.includeCSSComments&&i.push("// "+o),i.push("$experimental-support-for-svg: true;")),i.push("@include background-image("+t.standardSCSS+");"),i),this.cssTextElem.innerHTML="<div>"+r.join("</div><div>")+"</div>",void 0===this.initialStateRemoved&&(this.cssTextElem.removeClassName("initial"),this.initialStateRemoved=!0),this.adjustCopyButtonPositionForScrollbar()},updatePreviewElement:function(){var t,e;e=this.previewAsIE?(e=[(e=this.getMergedStops())[0],e[e.length-1]],t="diagonal"!=this.outputOrientation.substr(0,8)&&"radial"!=this.outputOrientation?this.outputOrientation:"horizontal",this.generateCSSRules(e,t,"rgba")):this.cssRules,this.setElementGradientBackground(this.previewElem,e),this.previewBackgroundElem.style.width=this.previewDimensionsWidth+"px",this.previewBackgroundElem.style.height=this.previewDimensionsHeight+"px"},updateOutputFormatHeaders:function(){var t=this.switchOutputFormatElem.getAttribute("data-template");switchToNewFormatStr="scss"==this.outputFormat?(currentFormatStr="SCSS (Sass)",t.replace(/__x__/,"css")):(currentFormatStr="CSS",t.replace(/__x__/,"scss")),this.currentOutputFormatElem.innerHTML=currentFormatStr,this.switchOutputFormatElem.innerHTML=switchToNewFormatStr},setLastUsedColorFromCurrentGradient:function(){var t=this.getColorStops();this.lastUsedColor=t[0].color},onHashChanged:function(){var t=window.location.hash;t&&"#"!=t&&(t=this.getGradientFromPermalinkHash(t))&&this.setCurrentPreset(t.name,Gradient.Utils.deepClone(t.stops),Gradient.Utils.deepClone(this.getGradientPresetOpacityStops(t)))},resetURLHash:function(){var t=window.location.hash;t&&6<t.length&&(window.location.hash="#_")},getGradientFromPermalinkHash:function(t){if(!t||!t.match(/,/))return null;var t=(t=(t="#"==t.substr(0,1)?t.substring(1):t).replace(/&amp;/g,"&")).split(";"),e=1<t.length?decodeURIComponent(t[1]):"Custom";e=(e=e.replace(/\+/g," ")).replace(/[^0-9a-zA-Z \-_\.#]/g," ");for(var i=(t=t[0]).split("&"),t=i[0],i=2==i.length?i[1]:null,o=t.split(","),n=[],s=0;s<o.length;s++){var r="#"+(r=(r=(l=o[s].split("+"))[0]).match(/^[0-9a-fA-F]{6}$/)?r:"ffffff");(c=l[1]).match(/^\d{1,3}$/)||(c="0"),n.push({color:r,position:c+="%"})}var a=null;if(i)for(o=i.split(","),a=[],s=0;s<o.length;s++){var l,c,h=(l=o[s].split("+"))[0];h.match(/^[0-9\.]+$/)||(h=1),(c=l[1]).match(/^\d{1,3}$/)||(c="0"),c+="%",a.push({opacity:h,position:c})}t={name:e,stops:n};return a&&(t.opacityStops=a),t},currentGradientToHash:function(){for(var t=[],e=this.getColorStops(),i=0;i<e.length;i++){var o=(r=e[i]).color.toLowerCase(),n=("#"==o.substr(0,1)&&(o=o.substring(1)),parseInt(r.position));t.push(o+"+"+n)}var s=t.join(",");if(this.currentGradientHasOpacity()){for(t=[],e=this.getOpacityStops(),i=0;i<e.length;i++){var r,a=(r=e[i]).opacity,n=parseInt(r.position);t.push(a+"+"+n)}s+="&"+t.join(",")}var l=encodeURIComponent(this.getCurrentPresetName());return"Custom"!=l&&(s+=";"+(l=l.replace(/%20/g,"+"))),s},openColorPickerAndGetColor:function(t){var e=window.prompt("Enter new color");null!==e&&t(e)},initCopyToClipboard:function(){var e,t;ClipboardJS.isSupported()?(e=this,t=new ClipboardJS(this.cssCopyButtonElem),this.cssCopyButtonElem.observe("mouseover",function(){var t=e.cssTextElem.innerHTML;t=(t=(t=t.replace(/<div[^>]*>/g,"")).replace(/<\/div>/g,"\r\n")).replace(/&amp;/g,"&"),e.cssCopyButtonElem.setAttribute("data-clipboard-text",t)}),t.on("success",function(t){e.cssCopyStatusElem.show(),setTimeout(function(){e.cssCopyStatusElem.hide()},2e3),Gradient.Utils.sendEvent("generated-output","text-copy")})):this.cssCopyButtonElem.addClassName("no-flash")},openColorPicker:function(t,e){this.colorPickerDialogWin.show(!0),$("cp1_Hex").focus();var i=this.lastUsedColor.substring(1);this.colorPicker._cvp._hexInput.value=i,this.colorPicker._cvp.setValuesFromHex(),this.colorPicker.positionMapAndSliderArrows(),this.colorPicker.updateVisuals()},switchToPresetSet:function(t){this.clearPresets();var e=Gradient.DB[t];if(void 0!==e){e.license;for(var i=0;i<e.gradients.length;i++)this.addPreset(e.gradients[i])}},addUserPresets:function(t){for(var e=0;e<t.length;e++)this.addPreset(t[e],!0,!0)},clearPresets:function(){var t=this.presetsContainerElem;if(t.hasChildNodes())for(;1<=t.childNodes.length;)t.removeChild(t.firstChild)},addPreset:function(t,e,i){var o=t.stops,n=t.name,s=this.getGradientPresetOpacityStops(t),r=document.createElement("div"),a=(r.className="preset-item-background gradient-background",document.createElement("div")),l="preset-item  has-preset-contextmenu",i=(i&&(l+=" user-preset","uniqueID"in t)&&a.setAttribute("preset-id",t.uniqueID),a.className=l,Gradient.StopUtils.mergeStops(o,s)),t=this.generateCSSRules(i,"diagonal","rgba"),c=(this.setElementGradientBackground(a,t),this),o=Gradient.Utils.deepClone(o),s=Gradient.Utils.deepClone(s);Element.extend(a),a.observe("click",function(t){Event.isLeftClick(t)&&(c.resetURLHash(),c.setCurrentPreset(n,o,s),Gradient.Utils.sendEvent("preset","select",n))}),r.appendChild(a),e&&this.presetsContainerElem.firstChild?this.presetsContainerElem.insertBefore(r,this.presetsContainerElem.firstChild):this.presetsContainerElem.appendChild(r)},deletePreset:function(t){t=t.up(".preset-item-background");t.parentNode.removeChild(t)},deleteUserPreset:function(t){this.deletePreset(t);for(var e=t.getAttribute("preset-id"),i=[],o=0;o<this.userGradientPresets.length;o++)e!=this.userGradientPresets[o].uniqueID&&i.push(this.userGradientPresets[o]);this.userGradientPresets=i,Gradient.UserPresets.persist(this.userGradientPresets)},getCurrentPresetName:function(t){return this.gradientNameBoxElem.value},setPresetName:function(t){this.gradientNameBoxElem.value=t},setCurrentPreset:function(t,e,i){this.setPresetName(t),this.setAllStops(e,i),this.gradientAdjuster&&this.gradientAdjuster.resetAllAdjustments(),this.setLastUsedColorFromCurrentGradient()},invalidateCurrentPreset:function(t){this.setPresetName("Custom"),this.resetURLHash(),!t&&this.gradientAdjuster&&this.gradientAdjuster.resetAllAdjustments()},saveNewPreset:function(){var t={name:this.getCurrentPresetName(),stops:this.getColorStops()};this.currentGradientHasOpacity()&&(t.opacityStops=this.getOpacityStops()),t.uniqueID=this.userGradientPresetsIDCounter,this.userGradientPresetsIDCounter++,this.addPreset(t,!0,!0),t=Gradient.Utils.deepClone(t),this.userGradientPresets.push(t),Gradient.UserPresets.persist(this.userGradientPresets),Gradient.Utils.sendEvent("preset","save",t.name)},toggleImportCSSPanel:function(){this.showHideImportImagePanel(!1),this.gradientAdjuster.onAdjustHueSaturationPanelCancelButtonClick(null,!0),Element.toggle(this.importFromCSSPanel)},toggleImportImagePanel:function(){this.showHideImportCSSPanel(!1),this.gradientAdjuster.onAdjustHueSaturationPanelCancelButtonClick(null,!0),Element.toggle(this.importFromImagePanel)},showHideImportPanel:function(t,e){e?Element.show(t):Element.hide(t)},showHideImportCSSPanel:function(t){this.showHideImportPanel(this.importFromCSSPanel,t)},showHideImportImagePanel:function(t){this.showHideImportPanel(this.importFromImagePanel,t)},showIE9SupportInstructions:function(){var t=[];t.push("<pre>&lt;!--[if gte IE 9]&gt;"),t.push('  &lt;style type="text/css"&gt;'),t.push("    .gradient {"),t.push("       filter: none;"),t.push("    }"),t.push("  &lt;/style&gt;"),t.push("&lt;![endif]--&gt;</pre>"),this.cssCompatNotesTextElem.innerHTML.match(/<pre>/)||(this.cssCompatNotesTextElem.innerHTML+=t.join("\n")),this.cssCompatNotesElem.show()},exportToImageDataURL:function(){for(var t=this.previewDimensionsWidth,e=this.previewDimensionsHeight,i=document.createElement("canvas"),o=(i.setAttribute("width",t),i.setAttribute("height",e),i.getContext("2d")),n="horizontal"==this.outputOrientation?t:0,s="horizontal"==this.outputOrientation?0:e,r=o.createLinearGradient(0,0,n,s),a=this.getColorStops(),l=0;l<a.length;l++){var c=a[l],h=parseInt(c.position)/100;r.addColorStop(h,c.color)}return o.fillStyle=r,o.fillRect(0,0,t,e),i.toDataURL("image/png")},onStopActivated:function(t){("color"==t?this.opacityStopsHandler:this.colorStopsHandler).setActiveStopMakerElemAndUpdateDetailsPanel(null)},onOrientationSelectorChange:function(t){t=Event.element(t);this.outputOrientation=t.value,this.updateAllUI(),ColorZilla.Persist.set("output-orientation",this.outputOrientation),Gradient.Utils.sendEvent("generated-output","change-orientation",this.outputOrientation)},onPreviewDimensionsChange:function(t){this.previewDimensionsWidth=Math.min(parseInt(this.previewDimensionWidthElem.value),370),this.previewDimensionsHeight=Math.min(parseInt(this.previewDimensionHeightElem.value),350),this.previewDimensionWidthElem.value=this.previewDimensionsWidth,this.previewDimensionHeightElem.value=this.previewDimensionsHeight,this.updatePreviewElement(),ColorZilla.Persist.set("preview-width",this.previewDimensionsWidth),ColorZilla.Persist.set("preview-height",this.previewDimensionsHeight)},onPreviewAsIECheckboxChange:function(t){t=Event.element(t);this.previewAsIE=t.checked,this.updatePreviewElement()},onColorFormatSelectorChange:function(t){t=Event.element(t);this.cssColorFormat=t.value,this.cssNotesElem.hide(),this.updateAllUI(),ColorZilla.Persist.set("css-color-format",this.cssColorFormat),Gradient.Utils.sendEvent("generated-output","change-color-format",this.cssColorFormat)},onIncludeCSSCommentsCheckboxChange:function(t){t=Event.element(t);this.includeCSSComments=t.checked,this.updateAllUI(),ColorZilla.Persist.set("include-css-comments",this.includeCSSComments?"true":"false"),Gradient.Utils.sendEvent("generated-output","change-include-comments",this.includeCSSComments?"true":"false")},updateIE9CompatibilityDisplay:function(t){var e=$$(".browser-compatibility .ie9-support-mode")[0];t?e.removeClassName("partial"):e.addClassName("partial")},updateMaximizeCSSCompatibilityDisplay:function(t){var e=$$(".browser-compatibility .compatibility-mode");t?e.each(function(t){t.removeClassName("not-supported")}):e.each(function(t){t.addClassName("not-supported")})},onSupportIE9CheckboxChange:function(t){t=Event.element(t);this.supportIE9=t.checked,this.updateAllUI(),ColorZilla.Persist.set("support-ie9",this.supportIE9?"true":"false"),this.supportIE9?this.showIE9SupportInstructions():(this.cssNotesElem.hide(),this.cssCompatNotesElem.hide()),this.updateIE9CompatibilityDisplay(this.supportIE9),Gradient.Utils.sendEvent("generated-output","change-support-ie9",this.supportIE9?"true":"false")},onMaximizeCssCompatibilityCheckboxChange:function(t){t=Event.element(t);this.maximizeCSSCompatibility=t.checked,this.updateAllUI(),ColorZilla.Persist.set("maximize-css-compatibility",this.maximizeCSSCompatibility?"true":"false"),this.updateMaximizeCSSCompatibilityDisplay(this.maximizeCSSCompatibility),Gradient.Utils.sendEvent("generated-output","change-maximize-css-compatibility",this.maximizeCSSCompatibility?"true":"false")},onImportFromCSSButtonClicked:function(t){this.importFromCSSTextElem.value="",this.toggleImportCSSPanel(),Gradient.Utils.sendEvent("import-css","open")},onImportFromImageButtonClicked:function(t){this.importFromImageForm.reset(),this.toggleImportImagePanel(),Gradient.Utils.sendEvent("import-image","open")},onImportFromCSSPanelOkButtonClick:function(t){var e=this.importFromCSSTextElem.value;e?(this.cssImporter||(this.cssImporter=new Gradient.Importer),(e=this.cssImporter.parseCSS(e))?(this.setAllStops(e.stops,e.opacityStops),this.invalidateCurrentPreset(),this.showHideImportCSSPanel(!1),Gradient.Utils.sendEvent("import-css","close","success")):(alert(Gradient.Utils.i18n("error-parsing-gradient-css")),Gradient.Utils.sendEvent("import-css","close","parse-fail"))):(this.showHideImportCSSPanel(!1),Gradient.Utils.sendEvent("import-css","close","error-empty"))},onImportFromImagePanelOkButtonClick:function(t){var e;this.importFromImageFileInputElem.value||this.importFromImageURLInputElem.value?(this.importFromImageForm.target="import-image-upload-target",this.importFromImageForm.submit(),e=this,window.importFromImageCallback=function(t){e.onImportFromImageCallback(t)},Gradient.Utils.sendEvent("import-image","start-import")):(alert(Gradient.Utils.i18n("no-file-or-url")),Gradient.Utils.sendEvent("import-image","close","empty"))},onImportFromImageCallback:function(t){t?(t=t.evalJSON(!0))?(this.setAllStops(t.stops,"opacityStops"in t?t.opacityStops:null),this.invalidateCurrentPreset(),this.showHideImportImagePanel(!1),Gradient.Utils.sendEvent("import-image","close","success")):(alert(Gradient.Utils.i18n("error-in-gradient-data")),Gradient.Utils.sendEvent("import-image","close","fail-cannot-parse")):(alert(Gradient.Utils.i18n("error-importing")),Gradient.Utils.sendEvent("import-image","close","fail-no-resp"))},onImportFromCSSPanelCancelButtonClick:function(t){this.showHideImportCSSPanel(!1),Gradient.Utils.sendEvent("import-css","close","cancel")},onImportFromImagePanelCancelButtonClick:function(t){this.showHideImportImagePanel(!1),Gradient.Utils.sendEvent("import-image","close","cancel")},onSaveNewPresetButtonClick:function(t){this.saveNewPreset()},onSwitchOutputFormatClicked:function(t){Event.stop(t),"css"==this.outputFormat?this.outputFormat="scss":this.outputFormat="css",this.updateOutputFormatHeaders(),ColorZilla.Persist.set("output-format",this.outputFormat),this.updateAllUI(),Gradient.Utils.sendEvent("generated-output","change-output-format",this.outputFormat)}},Gradient.Adjustments=function(t){this.gradientEditor=t,this.gradientControl=this.gradientEditor.gradientControl;var e=this.gradientControl.select(".gradient-adjustments-panel")[0];this.adjustments=["hue","sat","light"],this.adjustmentSliderElems={},this.adjustmentEditBoxElems={},this.adjustmentRanges={hue:{min:-180,max:180},sat:{min:-100,max:100},light:{min:-100,max:100}};for(var i=0;i<this.adjustments.length;i++){var o=this.adjustments[i],n=e.select("."+o+"-adjust-bar-container")[0],s=n.select("."+o+"-adjust-bar")[0],r=e.select("."+o+"-adjust-value")[0],a=Gradient.Utils.blankURI,s=new Refresh.Web.Slider(s,{xMinValue:1,xMaxValue:2*this.adjustmentRanges[o].max,yMinValue:1,yMaxValue:1,arrowImage:a},n);this.adjustmentSliderElems[o]=s,this.adjustmentEditBoxElems[o]=r,s.onValuesChanged=this.onSliderValueChanged.bind(this,s,o),r.observe("keyup",this.onAdjustValueEntryBoxKeyUp.bindAsEventListener(this,o)),r.observe("keydown",this.onAdjustValueEntryBoxKeyDown.bindAsEventListener(this,o)),r.observe("blur",this.onAdjustValueEntryBoxBlur.bindAsEventListener(this,o))}this.adjustHueSaturationPanel=e.select(".adjust-hue-saturation-panel")[0],this.adjustHueSaturationPanelOkButton=this.adjustHueSaturationPanel.select("button.ok")[0],this.adjustHueSaturationPanelOkButton.observe("click",this.onAdjustHueSaturationPanelOkButtonClick.bind(this)),this.adjustHueSaturationPanelCancelButton=this.adjustHueSaturationPanel.select("button.cancel")[0],this.adjustHueSaturationPanelCancelButton.observe("click",this.onAdjustHueSaturationPanelCancelButtonClick.bind(this)),e.select("a.adjust-reverse")[0].observe("click",this.onReverseGradientButtonClick.bind(this)),e.select("a.adjust-hue-sat")[0].observe("click",this.onAdjustHueSaturationButtonClick.bind(this)),this.resetAllAdjustments()},Gradient.Adjustments.prototype={resetSpecificAdjustment:function(t){this.adjustmentEditBoxElems[t].value=0,this.adjustmentSliderElems[t].xValue=this.adjustmentRanges[t].max,this.adjustmentSliderElems[t].setArrowPositionFromValues()},resetAllAdjustments:function(t){if(this.adjustmentsMade||void 0!==t){this.adjustmentsMade=!1,this.preAdjustmentStops=null;for(var e=0;e<this.adjustments.length;e++)this.resetSpecificAdjustment(this.adjustments[e]);this.currentAdjustments={hue:0,sat:0,light:0}}},startAdjusting:function(){this.adjustmentsMade||(this.preAdjustmentStops=Gradient.Utils.deepClone(this.gradientEditor.getColorStops()),this.adjustmentsMade=!0,this.gradientEditor.invalidateCurrentPreset(!0))},setGradientAdjustment:function(t,e){this.startAdjusting(),this.currentAdjustments[e]=t,this.adjustGradient()},adjustGradient:function(){var t=Gradient.Utils.deepClone(this.preAdjustmentStops),e=this.currentAdjustments.sat,i=this.currentAdjustments.light;function o(t,e){return 0<e?t+=Math.floor((255-t)*e/100+.5):e<0&&(t+=Math.floor(t*e/100+.5)),t=255<(t=t<0?0:t)?255:t}for(var n=0;n<t.length;n++){var s=t[n],r=Gradient.Utils.hexaToRGB(s.color),a=Gradient.Utils.rgbToHSL(r.red,r.green,r.blue),r=(a.hue+=this.currentAdjustments.hue,a.hue=(a.hue%360+360)%360,a.sat=o(a.sat,e),a.light=o(a.light,i),Gradient.Utils.hslToRGB(a.hue,a.sat,a.light)),a=Gradient.Utils.rgbToHexa(r.red,r.green,r.blue);s.color=a}this.gradientEditor.setColorStops(t)},revertGradientToPreAdjustmentState:function(){this.adjustmentsMade&&this.gradientEditor.setColorStops(this.preAdjustmentStops)},revertStops:function(t){for(var e=[],i=t.length-1;0<=i;i--){var o=t[i],n=100-parseInt(o.position);n+="%",o.position=n,e.push(o)}return e},onAdjustHueSaturationButtonClick:function(t){Element.visible(this.adjustHueSaturationPanel)||(this.gradientEditor.showHideImportImagePanel(!1),this.gradientEditor.showHideImportCSSPanel(!1),Element.show(this.adjustHueSaturationPanel),this.resetAllAdjustments(!0),Gradient.Utils.sendEvent("adjust","hue-sat-open"))},onAdjustHueSaturationPanelOkButtonClick:function(t,e){this.resetAllAdjustments(),Element.hide(this.adjustHueSaturationPanel),e||Gradient.Utils.sendEvent("adjust","hue-sat-close","ok")},onAdjustHueSaturationPanelCancelButtonClick:function(t,e){this.adjustmentsMade&&this.revertGradientToPreAdjustmentState(),this.onAdjustHueSaturationPanelOkButtonClick(t,!0),e||Gradient.Utils.sendEvent("adjust","hue-sat-close","cancel")},onReverseGradientButtonClick:function(t){var e=Gradient.Utils.deepClone(this.gradientEditor.getColorStops()),e=this.revertStops(e),i=Gradient.Utils.deepClone(this.gradientEditor.getOpacityStops()),i=this.revertStops(i);this.gradientEditor.setAllStops(e,i),this.gradientEditor.invalidateCurrentPreset(),Gradient.Utils.sendEvent("adjust","reverse")},onSliderValueChanged:function(t,e){t=t.xValue-this.adjustmentRanges[e].max;this.adjustmentEditBoxElems[e].value=0<t?"+"+t:t,this.setGradientAdjustment(t,e)},onAdjustValueEntryBoxKeyUp:function(t,e){t=Event.element(t);this.handleAdjustmentEntryBoxKeyEvent(t,e)},onAdjustValueEntryBoxKeyDown:function(t,e){var i=Event.element(t),o=parseInt(i.value);isNaN(o)||(38==(t=t.keyCode)&&o++,40==t&&o--,i.value=o,this.handleAdjustmentEntryBoxKeyEvent(i,e))},onAdjustValueEntryBoxBlur:function(t,e){var t=Event.element(t),i=t.value;isNaN(i)&&(t.value=0),this.handleAdjustmentEntryBoxKeyEvent(t,e)},handleAdjustmentEntryBoxKeyEvent:function(t,e){var i,o,n=parseInt(t.value);isNaN(n)||(i=this.adjustmentRanges[e].min,o=this.adjustmentRanges[e].max,this.setGradientAdjustment(n=o<(n=n<i?i:n)?o:n,e),this.adjustmentSliderElems[e].xValue=n+o,this.adjustmentSliderElems[e].setArrowPositionFromValues(),t.value=n=0<n?"+"+n:n)}},Gradient.Utils={blankURI:"data:image/gif,GIF89a%01%00%01%00%80%00%00%00%00%00%00%00%00!%F9%04%01%00%00%00%00%2C%00%00%00%00%01%00%01%00%00%02%02D%01%00%3B",dataURIEncode:function(t,e){return"data:"+e+";base64,"+Gradient.Utils.btoa(t)},decimalToHexa:function(t){t=(t=+t).toString(16);return t=t.length<2?"0"+t:t},intToPercent:function(t){return Math.floor(100*t/255+.5)},hexaToRGB:function(t){var e=t.substr(1,2),i=t.substr(3,2),t=t.substr(5,2);return{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(t,16)}},rgbToHexa:function(t,e,i){return"#"+(Gradient.Utils.decimalToHexa(t)+Gradient.Utils.decimalToHexa(e)+Gradient.Utils.decimalToHexa(i))},rbgToRGBCSS:function(t){return"rgb("+(t.red+","+t.green+","+t.blue)+")"},rbgAndAlphaToRGBACSS:function(t,e){return"rgba("+(t.red+","+t.green+","+t.blue+","+e)+")"},rgbToHSLCSS:function(t,e){var t=Gradient.Utils.rgbToHSL(t.red,t.green,t.blue),t=t.hue+","+Gradient.Utils.intToPercent(t.sat)+"%,"+Gradient.Utils.intToPercent(t.light)+"%",i=void 0!==e;return i&&(t+=","+e),"hsl"+(i?"a":"")+"("+t+")"},rgbToHSL:function(t,e,i){t/=255,e/=255,i/=255;var o,n=Math.max(t,e,i),s=Math.min(t,e,i),r=(n+s)/2;if(n==s)o=l=0;else{var a=n-s,l=a/(.5<r?2-n-s:n+s);switch(n){case t:o=(e-i)/a+(e<i?6:0);break;case e:o=(i-t)/a+2;break;case i:o=(t-e)/a+4}o/=6}return{hue:o=Math.round(360*o),sat:l=Math.round(255*l),light:Math.round(255*r)}},hslToRGB:function(t,e,i){e/=255;e=(i/=255)<=.5?i*(e+1):i+e-i*e,i=2*i-e;function o(t,e,i){return i<0&&i++,1<i&&i--,6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}var n=o(i,e,(t/=360)+1/3),s=o(i,e,t),i=o(i,e,t-1/3);return{red:Math.round(255*n),green:Math.round(255*s),blue:Math.round(255*i)}},rgbToHSV:function(t,e,i){var o,n=Math.max(t,e,i),s=n-Math.min(t,e,i),r=0==n?0:255*s/n;return 0==r?o=0:t==n?o=60*(e-i)/s:e==n?o=120+60*(i-t)/s:i==n&&(o=240+60*(t-e)/s),o<0&&(o+=360),{hue:o=Math.round(255*o/360),sat:Math.round(r),val:n}},hsvToRGB:function(t,e,i){var o,n,s,r,a,l,c;if(0==e)o=n=s=i;else{switch(a=(i/=255)*(1-(e/=255)),l=i*(1-e*(r=(t=359*t/15300)-(t=Math.floor(t)))),c=i*(1-e*(1-r)),t){case 0:o=i,n=c,s=a;break;case 1:o=l,n=i,s=a;break;case 2:o=a,n=i,s=c;break;case 3:o=a,n=l,s=i;break;case 4:o=c,n=a,s=i;break;default:o=i,n=a,s=l}o=Math.round(255*o),n=Math.round(255*n),s=Math.round(255*s)}return{red:o,green:n,blue:s}},deepClone:function(t){return Object.toJSON(t).evalJSON(!0)},selectTextInNode:function(t){var e,i;"getSelection"in window&&"createRange"in document?(e=window.getSelection(),(i=document.createRange()).selectNodeContents(t),e.removeAllRanges(),e.addRange(i)):"selection"in document&&"createTextRange"in document.body&&(document.selection.empty(),(i=document.body.createTextRange()).moveToElementText(el),i.select())},sendEvent:function(t,e,i,o){setTimeout(function(){try{ga("send","event","ugg-"+t,e,i,o)}catch(t){}},10)},i18n:function(t){return document.getElementById("translations").getAttribute("data-trans-"+t)}},Gradient.UIUtils={showHideLinkTrigger:function(t,e){t=Event.element(t),e=$$(e);return 0!=e.length&&(e[0].toggle(),t.parentNode.toggleClassName("showing")),!1},makeResizable:function(e,t,i){var o,n;function s(t){Event.stop(t);t=[Event.pointerX(t),Event.pointerY(t)],t=[t[0]-o[0],t[1]-o[1]],t=[n[0]+t[0],n[1]+t[1]];e.style.width=t[0]+"px",e.style.height=t[1]+"px",i&&i(e.getWidth(),e.getHeight())}function r(t){Event.stop(t),Event.stopObserving($$("body")[0],"mousemove",s),Event.stopObserving($$("body")[0],"mouseup",r)}Event.observe(t,"mousedown",function(t){Event.stop(t),o=[Event.pointerX(t),Event.pointerY(t)],n=[e.getWidth(),e.getHeight()],Event.observe($$("body")[0],"mousemove",s),Event.observe($$("body")[0],"mouseup",r)})}},Gradient.Importer=function(){this.testElem=document.createElement("div"),this.testElem.style.display="none",document.documentElement.appendChild(this.testElem),this.roundAlpha=!0},Gradient.Importer.prototype={setRoundAlpha:function(t){this.roundAlpha=t},trim:function(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")},cssSplit:function(t,e){for(var i=[],o="",n=0,s=0;s<t.length;s++){var r=t.charAt(s);"("==r&&n++,")"==r&&n--,r==e&&0==n?(i.push(o),o=""):o+=r}return o&&i.push(o),i},isColor:function(t){var e;return!!t&&((e=this.testElem).style.color="inherit",e.style.color=t,"inherit"!=e.style.color)},addPositionsToStopsIfNeeded:function(t){for(var e=0;e<t.length;e++){var i,o,n=t[e];null===n.position&&(0==e?n.position="0%":e==t.length-1?n.position="100%":(i=t[e-1].position,o=t[e+1].position,o=i&&o?Math.round((parseInt(i)+parseInt(o))/2):(i=t.length-1,Math.round(e*(100/i))),n.position=o+"%"))}return t},parseRGBCSSColor:function(t){var e,i,o;return!t||(t=t.replace(/rgba?/,"").replace(/[() ]/g,"").split(",")).length<3?null:(e=4==t.length?t[3]:1,this.roundAlpha&&(e*=100,e=Math.round(e),e/=100),e=+e,i=t[0],o=t[1],t=t[2],{value:"#"+(Gradient.Utils.decimalToHexa(i)+Gradient.Utils.decimalToHexa(o)+Gradient.Utils.decimalToHexa(t)),opacity:e})},parseHSLCSSColor:function(t){var e,i,o;return!t||(t=t.replace(/hsla?/,"").replace(/[() ]/g,"").split(",")).length<3?null:(e=4==t.length?t[3]:1,this.roundAlpha&&(e*=100,e=Math.round(e),e/=100),e=+e,o=t[0],i=255*parseInt(t[1])/100,t=255*parseInt(t[2])/100,o=Gradient.Utils.hslToRGB(o,i,t),{value:"#"+(Gradient.Utils.decimalToHexa(o.red)+Gradient.Utils.decimalToHexa(o.green)+Gradient.Utils.decimalToHexa(o.blue)),opacity:e})},resolveColor:function(t){if(!this.isColor(t))return null;var e=this.testElem;e.style.color="inherit",e.style.color=t;var e=document.defaultView.getComputedStyle(e,null).color,i=null;return"transparent"==e?t.match(/rgba/)?i=this.parseRGBCSSColor(t):t.match(/hsla/)&&(i=this.parseHSLCSSColor(t)):i=this.parseRGBCSSColor(e),i},parseStopCSSMozilla:function(t){var e,i=null,o=t=this.trim(t),t=t.split(" ");return 1<t.length&&(e=t[t.length-1]).match(/^ *[0-9]+% *$|/)&&(i=this.trim(e),o=this.trim(t.slice(0,-1).join(" "))),{color:(o=(o=this.resolveColor(o))||{color:null,opacity:null}).value,opacity:o.opacity,position:i}},parseCSSMozilla:function(t,e){var i=this.cssSplit(t,",");if(i.length<2)return null;for(var o=0;o<e;o++){var n=this.trim(i[0]),s=this.parseStopCSSMozilla(n);if(this.isColor(s.color))break;i=i.slice(1)}for(var r=[],o=0;o<i.length;o++){if(!(s=this.parseStopCSSMozilla(i[o])))return null;r.push(s)}return this.addPositionsToStopsIfNeeded(r),{stops:r}},parseStopCSSWebkit:function(t){var e,t=(t=(t=(t=t.replace(/ /g,"")).replace(/from\(/,"color-stop(0.0,")).replace(/to\(/,"color-stop(1.0,")).match(/color-stop\((.+)\)/);return!t||(t=t[1],(t=this.cssSplit(t,",")).length<2)?null:(-1==(e=t[0]).indexOf("%")&&(e=Math.round(100*e),e+="%"),t=t[1],{color:(t=(t=this.resolveColor(t))||{color:null,opacity:null}).value,opacity:t.opacity,position:e})},parseCSSWebkit:function(t,e){if((o=this.cssSplit(t,",")).length<4)return null;for(var t=this.trim(o[0]),i=this.trim(o[1]),o=o.slice(e),n=[],s=0;s<o.length;s++){var r=this.parseStopCSSWebkit(o[s]);if(!r)return null;n.push(r)}return{stops:n,startPoint:t,endPoint:i}},parseCSSIE:function(t){for(var e,i=null,o=null,n=t.split(","),s=0;s<n.length;s++){var r=n[s];(result=r.match(/startColorstr *= *'?([^']*)'?/i))?i=result[1].toLowerCase():(result=r.match(/endColorstr *= *'?([^']*)'?/i))&&(o=result[1].toLowerCase())}return i&&o?(e=t=1,9==i.length&&(t=i.substr(1,2),t=Math.round(parseInt(t,16)/255*100)/100,i="#"+i.substr(3)),9==o.length&&(e=o.substr(1,2),e=Math.round(parseInt(e,16)/255*100)/100,o="#"+o.substr(3)),{stops:[{color:i,opacity:t,position:"0%"},{color:o,opacity:e,position:"100%"}]}):null},parseCSS:function(t){var e=null;return t=(t=t.replace(/[\n\r]/g,"")).replace(/[;]/g,"\n"),(result=t.match(/linear-gradient *\((.+)\)/))?e=this.parseCSSMozilla(result[1],1):(result=t.match(/-webkit-gradient *\( *linear *, *(.+)\)/))?e=this.parseCSSWebkit(result[1],2):(result=t.match(/progid:DXImageTransform.Microsoft.gradient *\((.+)\)/))?e=this.parseCSSIE(result[1]):(result=t.match(/radial-gradient *\((.+)\)/))?e=this.parseCSSMozilla(result[1],2):(result=t.match(/-webkit-gradient *\( *radial *, *(.+)\)/))&&(e=this.parseCSSWebkit(result[1],4)),e?(e&&Gradient.StopUtils.gradientHasOpacity(e)?e=Gradient.StopUtils.splitStopsIntoColorAndOpacity(e):(e=Gradient.StopUtils.extractColorOnlyStops(e)).opacityStops=null,e):null}},Gradient.UserPresets={get:function(){if(!(t=ColorZilla.LocalStorage.get("user-gradient-presets",null)))return[];for(var t=t.evalJSON(!0),e=0;e<t.length;e++)t[e].uniqueID=e;return t},persist:function(t){t=Object.toJSON(t);return ColorZilla.LocalStorage.set("user-gradient-presets",t)}},Gradient.Utils.btoa=function(t){for(var e,i,o,n,s,r,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;c<t.length;)o=(e=t.charCodeAt(c++))>>2,n=(3&e)<<4|(e=t.charCodeAt(c++))>>4,s=(15&e)<<2|(i=t.charCodeAt(c++))>>6,r=63&i,isNaN(e)?s=r=64:isNaN(i)&&(r=64),l=l+a.charAt(o)+a.charAt(n)+a.charAt(s)+a.charAt(r);return l},Gradient.StopsHandler=function(t,e){var i;this.gradientEditor=e.gradientEditor,this.gradientControl=e.gradientControl,this.gradientPanelElem=e.gradientPanelElem,this.gradientMarkersContainerElem=e.gradientMarkersContainerElem,this.gradientMarkerDeleterElem=e.gradientMarkerDeleterElem,this.stopDetailsPanel=e.stopDetailsPanel,this.onStopActivatedCallback=e.onStopActivatedCallback,this.type=t,this.stopDetailsColorPanel=null,this.opacityValueElem=null,"color"==this.type?(this.stopDetailsColorPanel=this.gradientControl.select(".stop-details .color")[0],this.stopDetailsColorPanel.observe("click",this.onStopDetailsColorPanelClick.bind(this))):(this.opacityValueElem=this.gradientControl.select(".stop-details .opacity-value")[0],this.opacityValueElem.observe("keyup",this.onOpacityDetailsEntryBoxKeyUp.bind(this)),this.opacityValueElem.observe("keydown",this.onOpacityDetailsEntryBoxKeyDown.bind(this)),this.opacityValueElem.observe("blur",this.onOpacityDetailsEntryBoxBlur.bind(this)),this.opacityAdjustOpenButtonElem=this.gradientControl.select(".stop-details .opacity-adjust-open-button")[0],this.opacityAdjustOpenButtonElem.observe("click",this.onOpacityAdjustOpenButtonClick.bind(this))),this.stopDetailsPositionEntryBox=this.stopDetailsPanel.select(".position")[0],this.stopDetailsDeleteButton=this.stopDetailsPanel.select(".delete-button button")[0],this.setDisableStopDetailsPanel(!0),this.onGradientControlMouseUpHandler=this.onGradientControlMouseUp.bind(this),this.onGradientControlMouseMoveHandler=this.onGradientControlMouseMove.bind(this),this.onStopMarkerDeleterMouseOverHandler=this.onStopMarkerDeleterMouseOver.bind(this),this.stopDetailsDeleteButton.observe("click",this.onStopDetailsDeleteButtonClick.bind(this)),this.stopDetailsPositionEntryBox.observe("keyup",this.onStopDetailsPositionEntryBoxKeyUp.bind(this)),this.stopDetailsPositionEntryBox.observe("keydown",this.onStopDetailsPositionEntryBoxKeyDown.bind(this)),this.stopDetailsPositionEntryBox.observe("blur",this.onStopDetailsPositionEntryBoxBlur.bind(this)),this.gradientMarkersContainerElem.observe("click",this.onGradientMarkersContainerClick.bind(this)),this.activeStopMarkerElem=null,this.draggingStopMarkerElem=null,this.opacityStopAdjustContainerElem=null,"opacity"==this.type&&(this.defaultStops=[{opacity:1,position:"0%"},{opacity:1,position:"100%"}],this.stops=Gradient.Utils.deepClone(this.defaultStops),e=Gradient.Utils.blankURI,this.opacityStopAdjustContainerElem=$$(".opacity-stop-adjust-container")[0],this.transparentScreen=$("transparent-screen"),t=this.opacityStopAdjustContainerElem.select(".opacity-slider-container")[0],i=this.opacityStopAdjustContainerElem.select(".opacity-slider-bar")[0],this.opacityAdjustSlider=new Refresh.Web.Slider(i,{xMinValue:1,xMaxValue:100,yMinValue:1,yMaxValue:1,arrowImage:e},t),this.onDocumentClickToHideOpacityPanelHandler=this.onDocumentClickToHideOpacityPanel.bind(this),this.opacityAdjustSlider.onValuesChanged=this.onOpacityAdjustSliderValueChanged.bind(this)),this.lastUsedOpacity=1},Gradient.StopsHandler.prototype={setStops:function(t,e){this.stops=t,this.setActiveStopMakerElemAndUpdateDetailsPanel(null),void 0!==e&&e&&this.gradientEditor.updateAllUI()},getStops:function(){return this.stops},getStopPositionFromMouseEvent:function(t){var e=Element.cumulativeOffset(this.gradientMarkersContainerElem)[0],t=Math.round(100*(t-e)/this.gradientEditor.gradientPanelElemWidth);return t+="%"},updateStopMarkers:function(){for(var t=this.stops,e=0;e<t.length;e++)0==this.gradientMarkersContainerElem.select(".stop-marker-"+e).length&&this.createStopMarker(e),this.updateStopMarker(e,this.getStopValue(t[e]),t[e].position);this.removeUnusedMarkers()},updateStopMarker:function(t,e,i){i=parseInt(i);var o=this.findStopMarkerElemByIndex(t),n=Math.round(this.gradientEditor.gradientPanelElemWidth*i/100-5.5);o.style.left=n+"px","color"==this.type?(o.select(".color")[0].style.background=e,o.setAttribute("color",e)):(o.select(".color")[0].style.background=this.opacityToStopColor(e),o.setAttribute("stop-opacity",e)),o.setAttribute("position",i),o.setAttribute("imarker",t)},removeUnusedMarkers:function(){for(var t=this.gradientMarkersContainerElem.select(".stop-marker"),e=0;e<t.length;e++){var i=t[e];i.getAttribute("imarker")>=this.stops.length&&i.parentNode.removeChild(i)}},opacityToStopColor:function(t){t=255-Math.round(255*t);return Gradient.Utils.rgbToHexa(t,t,t)},createStopMarker:function(t){var e=document.createElement("div"),t=(e.className="stop-marker stop-marker-"+t,document.createElement("div"));t.className="color",e.appendChild(t),this.gradientMarkersContainerElem.appendChild(e),Element.extend(e),e.observe("mousedown",this.onStopMarkerMouseDown.bind(this)),e.observe("dblclick",this.onStopMarkerDoubleClick.bind(this)),e.setAttribute("title","color"==this.type?"Color stop":"Opacity stop")},setActiveStopMakerElem:function(t){this.activeStopMarkerElem&&this.activeStopMarkerElem.removeClassName("active"),this.activeStopMarkerElem=t,this.activeStopMarkerElem&&(this.activeStopMarkerElem.addClassName("active"),"color"==this.type?this.gradientEditor.lastUsedColor=this.activeStopMarkerElem.getAttribute("color"):this.lastUsedOpacity=this.activeStopMarkerElem.getAttribute("stop-opacity"))},setActiveStopMakerElemAndUpdateDetailsPanel:function(t){var e;t&&this.onStopActivatedCallback&&this.onStopActivatedCallback(this.type),this.setActiveStopMakerElem(t),t?(this.setDisableStopDetailsPanel(!1),this.stopDetailsColorPanel?(this.stopDetailsColorPanel.style.background=t.getAttribute("color"),this.stopDetailsPositionEntryBox.focus()):this.opacityValueElem&&(e=t.getAttribute("stop-opacity"),this.opacityValueElem.value=Math.round(100*e),this.opacityValueElem.select(),this.opacityValueElem.focus()),this.stopDetailsPositionEntryBox.value=t.getAttribute("position"),"color"==this.type&&this.stopDetailsPositionEntryBox.select()):this.setDisableStopDetailsPanel(!0)},getActiveStopMarkerElemIndex:function(){return this.activeStopMarkerElem?this.activeStopMarkerElem.getAttribute("imarker"):null},getDraggingStopMarkerElemIndex:function(){return this.draggingStopMarkerElem?this.draggingStopMarkerElem.getAttribute("imarker"):null},deleteStop:function(t){this.gradientEditor.invalidateCurrentPreset();for(var e=this.findStopMarkerElemByIndex(t),i=(e.parentNode.removeChild(e),[]),o=0;o<this.stops.length;o++)o!=t&&i.push(this.stops[o]);this.setStops(i,!0),this.setActiveStopMakerElemAndUpdateDetailsPanel(null)},sortStopsByPosition:function(){this.stops.sort(function(t,e){return parseInt(t.position)-parseInt(e.position)})},getStopValue:function(t){return"color"==this.type?t.color:t.opacity},findStopIndexByPositionAndValue:function(t,e){t=parseInt(t);for(var i=0;i<this.stops.length;i++){var o=this.getStopValue(this.stops[i]);if(parseInt(this.stops[i].position)==t&&o==e)return i}return null},findStopMarkerElemByIndex:function(t){return this.gradientMarkersContainerElem.select(".stop-marker-"+t)[0]},changeActiveStopValue:function(t){var e=this.getActiveStopMarkerElemIndex();null!==e&&(this.stopDetailsColorPanel?this.stopDetailsColorPanel.style.background=t:this.opacityValueElem,"color"==this.type?this.stops[e].color=t:this.stops[e].opacity=t,this.gradientEditor.updateAllUI())},updateStopPosition:function(t,e){this.stops[t].position=e;t=this.getStopValue(this.stops[t]),this.sortStopsByPosition(),this.gradientEditor.invalidateCurrentPreset(),this.gradientEditor.updateAllUI(),e=this.findStopIndexByPositionAndValue(e,t),t=this.findStopMarkerElemByIndex(e);this.setActiveStopMakerElem(t),this.draggingStopMarkerElem&&(this.draggingStopMarkerElem=t)},setDisableStopDetailsPanel:function(t){t?(this.stopDetailsPanel.addClassName("disabled"),this.stopDetailsPositionEntryBox.value="",this.stopDetailsPositionEntryBox.setAttribute("disabled","true"),this.stopDetailsDeleteButton.setAttribute("disabled","true"),this.stopDetailsColorPanel?this.stopDetailsColorPanel.style.background="#efefef":this.opacityValueElem&&(this.opacityValueElem.value="",this.opacityValueElem.setAttribute("disabled","true"),this.opacityAdjustOpenButtonElem.addClassName("disabled"))):(this.stopDetailsPanel.removeClassName("disabled"),this.stopDetailsPositionEntryBox.removeAttribute("disabled"),2<this.stops.length?this.stopDetailsDeleteButton.removeAttribute("disabled"):this.stopDetailsDeleteButton.setAttribute("disabled","true"),this.opacityValueElem&&(this.opacityValueElem.removeAttribute("disabled"),this.opacityAdjustOpenButtonElem.removeClassName("disabled")))},showOpacityStopAdjustPanel:function(t,e,i){this.transparentScreen.show();var o=$$("body")[0].getHeight();this.transparentScreen.style.height=o+"px",this.opacityStopAdjustContainerElem.show(),this.opacityStopAdjustContainerElem.style.left=t+"px",this.opacityStopAdjustContainerElem.style.top=e+"px",this.opacityAdjustSlider.xValue=Math.round(100*i),this.opacityAdjustSlider.setArrowPositionFromValues(),document.observe("mousedown",this.onDocumentClickToHideOpacityPanelHandler)},hideOpacityStopAdjustPanel:function(){this.transparentScreen.hide(),this.opacityStopAdjustContainerElem.hide(),document.stopObserving("mousedown",this.onDocumentClickToHideOpacityPanelHandler)},opacityStopAdjustPanelIsVisible:function(){return this.opacityStopAdjustContainerElem&&this.opacityStopAdjustContainerElem.visible()},registerDraggingEvents:function(){this.gradientControl.observe("mouseup",this.onGradientControlMouseUpHandler),this.gradientControl.observe("mousemove",this.onGradientControlMouseMoveHandler),this.gradientMarkerDeleterElem.observe("mouseover",this.onStopMarkerDeleterMouseOverHandler),this.gradientPanelElem.observe("mouseover",this.onStopMarkerDeleterMouseOverHandler)},unregisterDraggingEvents:function(){this.gradientControl.stopObserving("mouseup",this.onGradientControlMouseUpHandler),this.gradientControl.stopObserving("mousemove",this.onGradientControlMouseMoveHandler),this.gradientMarkerDeleterElem.stopObserving("mouseover",this.onStopMarkerDeleterMouseOverHandler),this.gradientPanelElem.stopObserving("mouseover",this.onStopMarkerDeleterMouseOverHandler)},onStopMarkerMouseDown:function(t){Event.stop(t);t=Event.element(t);t.hasClassName("stop-marker")||(t=t.up(".stop-marker")),this.setActiveStopMakerElemAndUpdateDetailsPanel(t),this.draggingStopMarkerElem=t,this.registerDraggingEvents()},onGradientControlMouseUp:function(t){this.draggingStopMarkerElem=null,this.unregisterDraggingEvents(),"color"==this.type&&this.stopDetailsPositionEntryBox.select()},onGradientControlMouseMove:function(t){var e;this.draggingStopMarkerElem&&(Event.stop(t),t=Event.pointerX(t),t=this.getStopPositionFromMouseEvent(t),(e=parseInt(t))<0||100<e||(e=this.getDraggingStopMarkerElemIndex(),this.updateStopPosition(e,t),this.stopDetailsPositionEntryBox.value=parseInt(t)))},onStopMarkerDeleterMouseOver:function(t){Event.element(t);this.draggingStopMarkerElem&&(2<this.stops.length&&(t=this.getDraggingStopMarkerElemIndex(),this.deleteStop(t)),this.draggingStopMarkerElem=null,this.unregisterDraggingEvents())},onStopDetailsDeleteButtonClick:function(t){var e;this.activeStopMarkerElem&&(2<this.stops.length&&(e=this.getActiveStopMarkerElemIndex(),this.deleteStop(e)),this.setActiveStopMakerElemAndUpdateDetailsPanel(null))},handleStopDetailsPositionEntryBoxKeyEvent:function(t){var e=parseInt(t.value);isNaN(e)||(t.value=e=100<(e=e<0?0:e)?100:e,this.activeStopMarkerElem&&(t=this.getActiveStopMarkerElemIndex(),e=e,this.updateStopPosition(t,e+"%")))},onStopDetailsPositionEntryBoxKeyUp:function(t){t=Event.element(t);this.handleStopDetailsPositionEntryBoxKeyEvent(t)},onStopDetailsPositionEntryBoxKeyDown:function(t){var e=Event.element(t),i=parseInt(e.value);isNaN(i)||(38==(t=t.keyCode)&&i++,40==t&&i--,e.value=i,this.handleStopDetailsPositionEntryBoxKeyEvent(e))},onStopDetailsPositionEntryBoxBlur:function(t){var t=Event.element(t),e=parseInt(t.value);isNaN(e)&&this.activeStopMarkerElem&&(e=this.getActiveStopMarkerElemIndex(),e=this.stops[e].position,t.value=parseInt(e))},handleOpacityDetailsEntryBoxKeyEvent:function(t){var e=parseInt(t.value);isNaN(e)||(t.value=e=100<(e=e<0?0:e)?100:e,this.activeStopMarkerElem&&(this.changeActiveStopValue(t=e/100),this.lastUsedOpacity=t))},onOpacityDetailsEntryBoxKeyUp:function(t){t=Event.element(t);this.handleOpacityDetailsEntryBoxKeyEvent(t)},onOpacityDetailsEntryBoxKeyDown:function(t){var e=Event.element(t),e=Event.element(t),i=parseInt(e.value);isNaN(i)||(38==(t=t.keyCode)&&i++,40==t&&i--,e.value=i,this.handleOpacityDetailsEntryBoxKeyEvent(e))},onOpacityDetailsEntryBoxBlur:function(t){var t=Event.element(t),e=parseInt(t.value);isNaN(e)&&this.activeStopMarkerElem&&(e=this.getActiveStopMarkerElemIndex(),e=this.stops[e].opacity,t.value=Math.round(100*e))},onStopDetailsColorPanelClick:function(t){var e;this.activeStopMarkerElem&&(Event.element(t),e=Event.pointerX(t),t=Event.pointerY(t),this.gradientEditor.openColorPicker(e,t))},onStopMarkerDoubleClick:function(t){var t=Event.element(t);"color"==this.type?this.gradientEditor.openColorPicker():(t=t.cumulativeOffset(),this.showOpacityStopAdjustPanel(t[0]+6,t[1]-35,this.lastUsedOpacity))},onOpacityAdjustOpenButtonClick:function(t){this.activeStopMarkerElem&&(t=Event.element(t).cumulativeOffset(),this.showOpacityStopAdjustPanel(t[0]+10,t[1]-10,this.lastUsedOpacity))},onDocumentClickToHideOpacityPanel:function(t){this.opacityStopAdjustPanelIsVisible()&&(Event.stop(t),(t=Event.element(t)).hasClassName("opacity-stop-adjust-container")||t.up(".opacity-stop-adjust-container")||this.hideOpacityStopAdjustPanel())},onOpacityAdjustSliderValueChanged:function(){var t=this.opacityAdjustSlider.xValue,e=t/100;this.activeStopMarkerElem&&(this.changeActiveStopValue(e),this.lastUsedOpacity=e,this.opacityValueElem.value=t)},onGradientMarkersContainerClick:function(t){var e,i;Event.element(t)==this.gradientMarkersContainerElem&&(t=Event.pointerX(t),t=this.getStopPositionFromMouseEvent(t),i="color"==this.type?{color:e=this.gradientEditor.lastUsedColor,position:t}:{opacity:e=this.lastUsedOpacity,position:t},this.stops.push(i),this.sortStopsByPosition(),this.gradientEditor.updateAllUI(),i=this.findStopIndexByPositionAndValue(t,e),t=this.findStopMarkerElemByIndex(i),this.setActiveStopMakerElemAndUpdateDetailsPanel(t))}},Gradient.StopUtils={interpolateStopsProperty:function(t,e,i,o){var n,s=parseInt(t.position),i=(i-s)/(parseInt(e.position)-s),s=1-i;return"color"==o?(o=Gradient.Utils.hexaToRGB(t.color),n=Gradient.Utils.hexaToRGB(e.color),{red:Math.round(o.red*s+n.red*i),green:Math.round(o.green*s+n.green*i),blue:Math.round(o.blue*s+n.blue*i)}):(o=t.opacity,n=e.opacity,Math.round(100*(o*s+n*i))/100)},interpolateStopsColor:function(t,e,i,o){t=Gradient.StopUtils.interpolateStopsProperty(t,e,i,"color");return void 0===o||"hex"==o?Gradient.Utils.rgbToHexa(t.red,t.green,t.blue):t},interpolateStopsOpacity:function(t,e,i){return Gradient.StopUtils.interpolateStopsProperty(t,e,i,"opacity")},getColorForOpacityOnlyStop:function(t,e,i,o){for(var n=t,s=null,r=n+1;r<e.length;r++)if("color"in i[e[r]]){s=i[e[r]];break}for(var a=null,r=n-1;0<=r;r--)if("color"in i[e[r]]){a=i[e[r]];break}a=a||s,s=s||a,n=a.color;return n=a!=s?Gradient.StopUtils.interpolateStopsColor(a,s,parseInt(e[t]),o):n},getOpacityForColorOnlyStop:function(t,e,i){for(var o=t,n=null,s=o+1;s<e.length;s++)if("opacity"in i[e[s]]){n=i[e[s]];break}for(var r=null,s=o-1;0<=s;s--)if("opacity"in i[e[s]]){r=i[e[s]];break}r=r||n,n=n||r,o=r.opacity;return o=r!=n?Gradient.StopUtils.interpolateStopsOpacity(r,n,parseInt(e[t])):o},mergeStops:function(t,e){var i=Gradient.Utils.deepClone(t),t=Gradient.Utils.deepClone(e);(i=i.concat(t)).sort(function(t,e){return parseInt(t.position)-parseInt(e.position)});for(var o=[],n={},s=0;s<i.length;s++){var r=(a=i[s]).position;r in n||(o.push(r),n[r]={position:r}),"color"in a&&(n[r].color=a.color),"opacity"in a&&(n[r].opacity=a.opacity)}for(var a,l=[],s=0;s<o.length;s++)"color"in(a=n[o[s]])||(a.color=Gradient.StopUtils.getColorForOpacityOnlyStop(s,o,n,"hex")),"opacity"in a||(a.opacity=Gradient.StopUtils.getOpacityForColorOnlyStop(s,o,n)),l.push(a);return l},extractStopByType:function(t,e){return"color"==e?{position:t.position,color:t.color}:"opacity"==e?{position:t.position,opacity:t.opacity}:null},splitStopsIntoColorAndOpacity:function(t){var e=t.stops;if(e.length<2)return null;for(var i=[],o=[],n=1;n<e.length-1;n++){var s=e[n],r=e[n-1],a=e[n+1],l=Gradient.Utils.hexaToRGB(s.color),c=Gradient.StopUtils.interpolateStopsColor(r,a,parseInt(s.position),"rgb"),h=c.red,u=c.green,c=c.blue,r=Gradient.StopUtils.interpolateStopsOpacity(r,a,parseInt(s.position));(1<Math.abs(h-l.red)||1<Math.abs(u-l.green)||1<Math.abs(c-l.blue))&&i.push(Gradient.StopUtils.extractStopByType(s,"color")),.05<Math.abs(r-Math.round(100*s.opacity)/100)&&o.push(Gradient.StopUtils.extractStopByType(s,"opacity"))}return 0==i.length?i=[Gradient.StopUtils.extractStopByType(e[0],"color"),Gradient.StopUtils.extractStopByType(e[e.length-1],"color")]:(e[0].color!=i[0].color&&i.unshift(Gradient.StopUtils.extractStopByType(e[0],"color")),e[e.length-1].color!=i[i.length-1].color&&i.push(Gradient.StopUtils.extractStopByType(e[e.length-1],"color"))),0==o.length?o=[Gradient.StopUtils.extractStopByType(e[0],"opacity"),Gradient.StopUtils.extractStopByType(e[e.length-1],"opacity")]:(e[0].opacity!=o[0].opacity&&o.unshift(Gradient.StopUtils.extractStopByType(e[0],"opacity")),e[e.length-1].opacity!=o[o.length-1].opacity&&o.push(Gradient.StopUtils.extractStopByType(e[e.length-1],"opacity"))),t.stops=Gradient.Utils.deepClone(i),t.opacityStops=Gradient.Utils.deepClone(o),t},gradientHasOpacity:function(t){if(t&&t.stops)for(var e=0;e<t.stops.length;e++){var i=t.stops[e];if("opacity"in i&&1!=i.opacity)return!0}return!1},extractColorOnlyStops:function(t){if(t&&t.stops){for(var e=0;e<t.stops.length;e++)t.stops[e]=Gradient.StopUtils.extractStopByType(t.stops[e],"color");return t}}},window.Refresh||(Refresh={}),Refresh.Web||(Refresh.Web={}),Refresh.Web.Color=function(t){var e={r:0,g:0,b:0,h:0,s:0,v:0,hex:"",setRgb:function(t,e,i){this.r=t,this.g=e,this.b=i;t=Refresh.Web.ColorMethods.rgbToHsv(this);this.h=t.h,this.s=t.s,this.v=t.v,this.hex=Refresh.Web.ColorMethods.rgbToHex(this)},setHsv:function(t,e,i){this.h=t,this.s=e,this.v=i;t=Refresh.Web.ColorMethods.hsvToRgb(this);this.r=t.r,this.g=t.g,this.b=t.b,this.hex=Refresh.Web.ColorMethods.rgbToHex(t)},setHex:function(t){this.hex=t;t=Refresh.Web.ColorMethods.hexToRgb(this.hex),this.r=t.r,this.g=t.g,this.b=t.b,t=Refresh.Web.ColorMethods.rgbToHsv(t);this.h=t.h,this.s=t.s,this.v=t.v}};return t&&("hex"in t?e.setHex(t.hex):"r"in t?e.setRgb(t.r,t.g,t.b):"h"in t&&e.setHsv(t.h,t.s,t.v)),e},Refresh.Web.ColorMethods={hexToRgb:function(t){var e="00",i="00",o="00";return 6==(t=this.validateHex(t)).length?(e=t.substring(0,2),i=t.substring(2,4),o=t.substring(4,6)):(4<t.length&&(e=t.substring(4,t.length),t=t.substring(0,4)),2<t.length&&(i=t.substring(2,t.length),t=t.substring(0,2)),0<t.length&&(o=t.substring(0,t.length))),{r:this.hexToInt(e),g:this.hexToInt(i),b:this.hexToInt(o)}},validateHex:function(t){return t=6<(t=(t=new String(t).toUpperCase()).replace(/[^A-F0-9]/g,"0")).length?t.substring(0,6):t},webSafeDec:function(t){return t=Math.round(t/51),t*=51},hexToWebSafe:function(t){var e,i,t=3==t.length?(e=t.substring(0,1),i=t.substring(1,1),t.substring(2,1)):(e=t.substring(0,2),i=t.substring(2,4),t.substring(4,6));return intToHex(this.webSafeDec(this.hexToInt(e)))+this.intToHex(this.webSafeDec(this.hexToInt(i)))+this.intToHex(this.webSafeDec(this.hexToInt(t)))},rgbToWebSafe:function(t){return{r:this.webSafeDec(t.r),g:this.webSafeDec(t.g),b:this.webSafeDec(t.b)}},rgbToHex:function(t){return this.intToHex(t.r)+this.intToHex(t.g)+this.intToHex(t.b)},intToHex:function(t){t=parseInt(t).toString(16);return(t=1==t.length?"0"+t:t).toUpperCase()},hexToInt:function(t){return parseInt(t,16)},rgbToHsv:function(t){var e=t.r/255,i=t.g/255,t=t.b/255,o=0,n=0,o=i<=e&&t<=e?(n=e,t<i?t:i):t<=i&&e<=i?(n=i,t<e?t:e):(n=t,e<i?e:i);return(hsv={h:0,s:0,v:0}).v=n,hsv.s=n?(n-o)/n:0,hsv.s?(delta=n-o,hsv.h=e==n?(i-t)/delta:i==n?2+(t-e)/delta:4+(e-i)/delta,hsv.h=parseInt(60*hsv.h),hsv.h<0&&(hsv.h+=360)):hsv.h=0,hsv.s=parseInt(100*hsv.s),hsv.v=parseInt(100*hsv.v),hsv},hsvToRgb:function(t){rgb={r:0,g:0,b:0};var e=t.h,i=t.s,o=t.v;if(0==i)rgb.r=rgb.g=rgb.b=0==o?0:parseInt(255*o/100);else{360==e&&(e=0),e/=60,i/=100,o/=100;var t=parseInt(e),e=e-t,n=o*(1-i),s=o*(1-i*e),r=o*(1-i*(1-e));switch(t){case 0:rgb.r=o,rgb.g=r,rgb.b=n;break;case 1:rgb.r=s,rgb.g=o,rgb.b=n;break;case 2:rgb.r=n,rgb.g=o,rgb.b=r;break;case 3:rgb.r=n,rgb.g=s,rgb.b=o;break;case 4:rgb.r=r,rgb.g=n,rgb.b=o;break;case 5:rgb.r=o,rgb.g=n,rgb.b=s}rgb.r=parseInt(255*rgb.r),rgb.g=parseInt(255*rgb.g),rgb.b=parseInt(255*rgb.b)}return rgb},normalizeHex:function(t){return this.rgbToHex(this.hexToRgb(t))}},window.Refresh||(Refresh={}),Refresh.Web||(Refresh.Web={}),Refresh.Web.ColorValuePicker=Class.create(),Refresh.Web.ColorValuePicker.prototype={initialize:function(t){this.id=t,this.onValuesChanged=null,this._hueInput=$(this.id+"_Hue"),this._valueInput=$(this.id+"_Brightness"),this._saturationInput=$(this.id+"_Saturation"),this._redInput=$(this.id+"_Red"),this._greenInput=$(this.id+"_Green"),this._blueInput=$(this.id+"_Blue"),this._hexInput=$(this.id+"_Hex"),this._event_onHsvKeyUp=this._onHsvKeyUp.bindAsEventListener(this),this._event_onHsvBlur=this._onHsvBlur.bindAsEventListener(this),this._event_onRgbKeyUp=this._onRgbKeyUp.bindAsEventListener(this),this._event_onRgbBlur=this._onRgbBlur.bindAsEventListener(this),this._event_onHexKeyUp=this._onHexKeyUp.bindAsEventListener(this),Event.observe(this._hueInput,"keyup",this._event_onHsvKeyUp),Event.observe(this._valueInput,"keyup",this._event_onHsvKeyUp),Event.observe(this._saturationInput,"keyup",this._event_onHsvKeyUp),Event.observe(this._hueInput,"blur",this._event_onHsvBlur),Event.observe(this._valueInput,"blur",this._event_onHsvBlur),Event.observe(this._saturationInput,"blur",this._event_onHsvBlur),Event.observe(this._redInput,"keyup",this._event_onRgbKeyUp),Event.observe(this._greenInput,"keyup",this._event_onRgbKeyUp),Event.observe(this._blueInput,"keyup",this._event_onRgbKeyUp),Event.observe(this._redInput,"blur",this._event_onRgbBlur),Event.observe(this._greenInput,"blur",this._event_onRgbBlur),Event.observe(this._blueInput,"blur",this._event_onRgbBlur),Event.observe(this._hexInput,"keyup",this._event_onHexKeyUp),this.color=new Refresh.Web.Color,""!=this._hexInput.value&&this.color.setHex(this._hexInput.value),this._hexInput.value=this.color.hex,this._redInput.value=this.color.r,this._greenInput.value=this.color.g,this._blueInput.value=this.color.b,this._hueInput.value=this.color.h,this._saturationInput.value=this.color.s,this._valueInput.value=this.color.v},_onHsvKeyUp:function(t){""!=t.target.value&&(this.validateHsv(t),this.setValuesFromHsv(),this.onValuesChanged)&&this.onValuesChanged(this)},_onRgbKeyUp:function(t){""!=t.target.value&&(this.validateRgb(t),this.setValuesFromRgb(),this.onValuesChanged)&&this.onValuesChanged(this)},_onHexKeyUp:function(t){""!=t.target.value&&(this.validateHex(t),this.setValuesFromHex(),this.onValuesChanged)&&this.onValuesChanged(this)},_onHsvBlur:function(t){""==t.target.value&&this.setValuesFromRgb()},_onRgbBlur:function(t){""==t.target.value&&this.setValuesFromHsv()},HexBlur:function(t){""==t.target.value&&this.setValuesFromHsv()},validateRgb:function(t){if(!this._keyNeedsValidation(t))return t;this._redInput.value=this._setValueInRange(this._redInput.value,0,255),this._greenInput.value=this._setValueInRange(this._greenInput.value,0,255),this._blueInput.value=this._setValueInRange(this._blueInput.value,0,255)},validateHsv:function(t){if(!this._keyNeedsValidation(t))return t;this._hueInput.value=this._setValueInRange(this._hueInput.value,0,359),this._saturationInput.value=this._setValueInRange(this._saturationInput.value,0,100),this._valueInput.value=this._setValueInRange(this._valueInput.value,0,100)},validateHex:function(t){if(!this._keyNeedsValidation(t))return t;t=new String(this._hexInput.value).toUpperCase();6<(t=(t="#"==t.substr(0,1)?t.substring(1):t).replace(/[^A-F0-9]/g,"0")).length&&(t=t.substring(0,6)),this._hexInput.value=t},_keyNeedsValidation:function(t){return 9!=t.keyCode&&16!=t.keyCode&&38!=t.keyCode&&29!=t.keyCode&&40!=t.keyCode&&37!=t.keyCode&&(!t.ctrlKey||t.keyCode!="c".charCodeAt()&&t.keyCode!="v".charCodeAt())},_setValueInRange:function(t,e,i){return""==t||isNaN(t)?e:i<(t=parseInt(t))?i:t<e?e:t},setValuesFromRgb:function(){this.color.setRgb(this._redInput.value,this._greenInput.value,this._blueInput.value),this._hexInput.value=this.color.hex,this._hueInput.value=this.color.h,this._saturationInput.value=this.color.s,this._valueInput.value=this.color.v},setValuesFromHsv:function(){this.color.setHsv(this._hueInput.value,this._saturationInput.value,this._valueInput.value),this._hexInput.value=this.color.hex,this._redInput.value=this.color.r,this._greenInput.value=this.color.g,this._blueInput.value=this.color.b},setValuesFromHex:function(){this.color.setHex(this._hexInput.value),this._redInput.value=this.color.r,this._greenInput.value=this.color.g,this._blueInput.value=this.color.b,this._hueInput.value=this.color.h,this._saturationInput.value=this.color.s,this._valueInput.value=this.color.v}},window.Refresh||(Refresh={}),Refresh.Web||(Refresh.Web={}),Refresh.Web.SlidersList=[],Refresh.Web.DefaultSliderSettings={xMinValue:0,xMaxValue:100,yMinValue:0,yMaxValue:100,arrowImage:"images/rangearrows.gif"},Refresh.Web.Slider=Class.create(),Refresh.Web.Slider.prototype={_container:null,_bar:null,_arrow:null,initialize:function(t,e,i){this.id=t,this.settings=Object.extend(Object.extend({},Refresh.Web.DefaultSliderSettings),e||{}),this.xValue=0,this.yValue=0,this._bar=$(this.id),this._arrow=document.createElement("img"),this._arrow.border=0,this._arrow.src=this.settings.arrowImage,this._arrow.margin=0,this._arrow.padding=0,this._arrow.style.position="absolute",this._arrow.style.zIndex="5",this._arrow.style.top="0px",this._arrow.style.left="0px",i?(i.appendChild(this._arrow),this._container=i):document.body.appendChild(this._arrow);this.setPositioningVariables(),this._event_docMouseMove=this._docMouseMove.bindAsEventListener(this),this._event_docMouseUp=this._docMouseUp.bindAsEventListener(this),this._event_docMouseOut=this._docMouseOut.bindAsEventListener(this),Event.observe(this._bar,"mousedown",this._bar_mouseDown.bindAsEventListener(this)),Event.observe(this._arrow,"mousedown",this._arrow_mouseDown.bindAsEventListener(this)),this.setArrowPositionFromValues(),this.onValuesChanged&&this.onValuesChanged(this),Refresh.Web.SlidersList.push(this)},setPositioningVariables:function(){this._barWidth=this._bar.getWidth(),this._barHeight=this._bar.getHeight();var t=this._bar.cumulativeOffset();this._barTop=t.top,this._barLeft=t.left,this._barBottom=this._barTop+this._barHeight,this._barRight=this._barLeft+this._barWidth,this._arrow=$(this._arrow),this._arrowWidth=this._arrow.getWidth(),this._arrowHeight=this._arrow.getHeight(),this.MinX=this._barLeft,this.MinY=this._barTop,this.MaxX=this._barRight,this.MinY=this._barBottom},setArrowPositionFromValues:function(t){this.setPositioningVariables();var e,i,o=0,n=0;this.settings.xMinValue!=this.settings.xMaxValue&&(this.xValue==this.settings.xMinValue?o=0:this.xValue==this.settings.xMaxValue?o=this._barWidth-1:(i=this.settings.xMaxValue,this.settings.xMinValue<1&&(i=i+Math.abs(this.settings.xMinValue)+1),e=this.xValue,this.xValue<1&&(e+=1),o=e/i*this._barWidth,o=parseInt(o)==i-1?i:parseInt(o),this.settings.xMinValue<1&&(o=o-Math.abs(this.settings.xMinValue)-1))),this.settings.yMinValue!=this.settings.yMaxValue&&(this.yValue==this.settings.yMinValue?n=0:this.yValue==this.settings.yMaxValue?n=this._barHeight-1:(e=this.settings.yMaxValue,this.settings.yMinValue<1&&(e=e+Math.abs(this.settings.yMinValue)+1),i=this.yValue,this.yValue<1&&(i+=1),n=i/e*this._barHeight,n=parseInt(n)==e-1?e:parseInt(n),this.settings.yMinValue<1&&(n=n-Math.abs(this.settings.yMinValue)-1))),this._setArrowPosition(o,n)},_setArrowPosition:function(t,e){var i;(t=t<0?0:t)>this._barWidth&&(t=this._barWidth),(e=e<0?0:e)>this._barHeight&&(e=this._barHeight),t=this._container?(i=t,e):(i=this._barLeft+t,this._barTop+e),this._arrowWidth>this._barWidth?i-=this._arrowWidth/2-this._barWidth/2:i-=parseInt(this._arrowWidth/2),this._arrowHeight>this._barHeight?t-=this._arrowHeight/2-this._barHeight/2:t-=parseInt(this._arrowHeight/2),this._arrow.style.left=i+"px",this._arrow.style.top=t+"px"},_bar_mouseDown:function(t){this._mouseDown(t)},_arrow_mouseDown:function(t){this._mouseDown(t)},_mouseDown:function(t){(Refresh.Web.ActiveSlider=this).setValuesFromMousePosition(t),Event.observe(document,"mousemove",this._event_docMouseMove),Event.observe(document,"mouseup",this._event_docMouseUp),Event.observe(document,"mouseout",this._event_docMouseOut),Event.stop(t)},_docMouseOut:function(t){"HTML"==t.target.tagName&&this._docMouseUp(t)},_docMouseMove:function(t){this.setValuesFromMousePosition(t),Event.stop(t)},_docMouseUp:function(t){Event.stopObserving(document,"mouseup",this._event_docMouseUp),Event.stopObserving(document,"mousemove",this._event_docMouseMove),Event.stopObserving(document,"mouseout",this._event_docMouseOut),Event.stop(t)},setValuesFromMousePosition:function(t){this.setPositioningVariables();var t=Event.pointer(t),e=0,i=0,e=t.x<this._barLeft?0:t.x>this._barRight?this._barWidth:t.x-this._barLeft+1,i=t.y<this._barTop?0:t.y>this._barBottom?this._barHeight:t.y-this._barTop+1,t=parseInt(e/this._barWidth*this.settings.xMaxValue),o=parseInt(i/this._barHeight*this.settings.yMaxValue);this.xValue=t,this.yValue=o,this.settings.xMaxValue==this.settings.xMinValue&&(e=0),this.settings.yMaxValue==this.settings.yMinValue&&(i=0),this._setArrowPosition(e,i),this.onValuesChanged&&this.onValuesChanged(this)}},window.Refresh||(Refresh={}),Refresh.Web||(Refresh.Web={}),Refresh.Web.DefaultColorPickerSettings={startMode:"h",startHex:"ff0000",clientFilesPath:"images/"},Refresh.Web.ColorPicker=Class.create(),Refresh.Web.ColorPicker.prototype={initialize:function(t,e){this.id=t,this.settings=Object.extend(Object.extend({},Refresh.Web.DefaultColorPickerSettings),e||{}),this._hueRadio=$(this.id+"_HueRadio"),this._saturationRadio=$(this.id+"_SaturationRadio"),this._valueRadio=$(this.id+"_BrightnessRadio"),this._redRadio=$(this.id+"_RedRadio"),this._greenRadio=$(this.id+"_GreenRadio"),this._blueRadio=$(this.id+"_BlueRadio"),this._hueRadio.value="h",this._saturationRadio.value="s",this._valueRadio.value="v",this._redRadio.value="r",this._greenRadio.value="g",this._blueRadio.value="b",this._event_onRadioClicked=this._onRadioClicked.bindAsEventListener(this),Event.observe(this._hueRadio,"click",this._event_onRadioClicked),Event.observe(this._saturationRadio,"click",this._event_onRadioClicked),Event.observe(this._valueRadio,"click",this._event_onRadioClicked),Event.observe(this._redRadio,"click",this._event_onRadioClicked),Event.observe(this._greenRadio,"click",this._event_onRadioClicked),Event.observe(this._blueRadio,"click",this._event_onRadioClicked),this._preview=$(this.id+"_Preview"),this._mapBase=$(this.id+"_ColorMap"),this._mapBase.style.width="256px",this._mapBase.style.height="256px",this._mapBase.style.padding=0,this._mapBase.style.margin=0,this._mapBase.style.border="solid 1px #000",this._mapBase.style.position="relative",this._mapL1=new Element("img",{src:this.settings.clientFilesPath+"blank.gif",width:256,height:256}),this._mapL1.style.margin="0px",this._mapL1.style.display="block",this._mapBase.appendChild(this._mapL1),this._mapL2=new Element("img",{src:this.settings.clientFilesPath+"blank.gif",width:256,height:256}),this._mapBase.appendChild(this._mapL2),this._mapL2.style.clear="both",this._mapL2.style.margin="-256px 0px 0px 0px",this._mapL2.setOpacity(.5),this._mapL2.style.display="block",this._bar=$(this.id+"_ColorBar"),this._bar.style.width="20px",this._bar.style.height="256px",this._bar.style.padding=0,this._bar.style.margin="0px 10px",this._bar.style.border="solid 1px #000",this._bar.style.position="relative",this._barL1=new Element("img",{src:this.settings.clientFilesPath+"blank.gif",width:20,height:256}),this._barL1.style.margin="0px",this._barL1.style.display="block",this._bar.appendChild(this._barL1),this._barL2=new Element("img",{src:this.settings.clientFilesPath+"blank.gif",width:20,height:256}),this._barL2.style.margin="-256px 0px 0px 0px",this._barL2.style.display="block",this._bar.appendChild(this._barL2),this._barL3=new Element("img",{src:this.settings.clientFilesPath+"blank.gif",width:20,height:256}),this._barL3.style.margin="-256px 0px 0px 0px",this._barL3.style.backgroundColor="#ff0000",this._barL3.style.display="block",this._bar.appendChild(this._barL3),this._barL4=new Element("img",{src:this.settings.clientFilesPath+"bar-brightness.png",width:20,height:256}),this._barL4.style.margin="-256px 0px 0px 0px",this._barL4.style.display="block",this._bar.appendChild(this._barL4),this._map=new Refresh.Web.Slider(this._mapL2,{xMaxValue:255,yMinValue:255,arrowImage:this.settings.clientFilesPath+"mappoint.gif"},this._mapBase),this._slider=new Refresh.Web.Slider(this._barL4,{xMinValue:1,xMaxValue:1,yMinValue:255,arrowImage:this.settings.clientFilesPath+"rangearrows.gif"},this._bar),this._cvp=new Refresh.Web.ColorValuePicker(this.id);var i=this;this._slider.onValuesChanged=function(){i.sliderValueChanged()},this._map.onValuesChanged=function(){i.mapValueChanged()},this._cvp.onValuesChanged=function(){i.textValuesChanged()},this.isLessThanIE7=!1,parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters&&(this.isLessThanIE7=!0),this.setColorMode(this.settings.startMode),this.settings.startHex&&(this._cvp._hexInput.value=this.settings.startHex),this._cvp.setValuesFromHex(),this.positionMapAndSliderArrows(),this.updateVisuals(),this.color=null},show:function(){this._map.Arrow.style.display="",this._slider.Arrow.style.display="",this._map.setPositioningVariables(),this._slider.setPositioningVariables(),this.positionMapAndSliderArrows()},hide:function(){this._map.Arrow.style.display="none",this._slider.Arrow.style.display="none"},_onRadioClicked:function(t){this.setColorMode(t.target.value)},_onWebSafeClicked:function(t){this.setColorMode(this.ColorMode)},textValuesChanged:function(){this.positionMapAndSliderArrows(),this.updateVisuals()},setColorMode:function(t){function e(t,e){t.setAlpha(e,100),e.style.backgroundColor="",e.src=t.settings.clientFilesPath+"blank.gif",e.style.filter=""}switch(this.color=this._cvp.color,e(this,this._mapL1),e(this,this._mapL2),e(this,this._barL1),e(this,this._barL2),e(this,this._barL3),e(this,this._barL4),this._hueRadio.checked=!1,this._saturationRadio.checked=!1,this._valueRadio.checked=!1,this._redRadio.checked=!1,this._greenRadio.checked=!1,this._blueRadio.checked=!1,t){case"h":this._hueRadio.checked=!0,this._mapL1.style.backgroundColor="#"+Refresh.Web.ColorMethods.normalizeHex(this.color.hex),this._mapL2.style.backgroundColor="transparent",this.setImg(this._mapL2,this.settings.clientFilesPath+"map-hue.png"),this.setAlpha(this._mapL2,100),this.setImg(this._barL4,this.settings.clientFilesPath+"bar-hue.png"),this._map.settings.xMaxValue=100,this._map.settings.yMaxValue=100,this._slider.settings.yMaxValue=359;break;case"s":this._saturationRadio.checked=!0,this.setImg(this._mapL1,this.settings.clientFilesPath+"map-saturation.png"),this.setImg(this._mapL2,this.settings.clientFilesPath+"map-saturation-overlay.png"),this.setAlpha(this._mapL2,0),this.setBG(this._barL3,this.color.hex),this.setImg(this._barL4,this.settings.clientFilesPath+"bar-saturation.png"),this._map.settings.xMaxValue=359,this._map.settings.yMaxValue=100,this._slider.settings.yMaxValue=100;break;case"v":this._valueRadio.checked=!0,this.setBG(this._mapL1,"000"),this.setImg(this._mapL2,this.settings.clientFilesPath+"map-brightness.png"),this._barL3.style.backgroundColor="#"+Refresh.Web.ColorMethods.normalizeHex(this.color.hex),this.setImg(this._barL4,this.settings.clientFilesPath+"bar-brightness.png"),this._map.settings.xMaxValue=359,this._map.settings.yMaxValue=100,this._slider.settings.yMaxValue=100;break;case"r":this._redRadio.checked=!0,this.setImg(this._mapL2,this.settings.clientFilesPath+"map-red-max.png"),this.setImg(this._mapL1,this.settings.clientFilesPath+"map-red-min.png"),this.setImg(this._barL4,this.settings.clientFilesPath+"bar-red-tl.png"),this.setImg(this._barL3,this.settings.clientFilesPath+"bar-red-tr.png"),this.setImg(this._barL2,this.settings.clientFilesPath+"bar-red-br.png"),this.setImg(this._barL1,this.settings.clientFilesPath+"bar-red-bl.png");break;case"g":this._greenRadio.checked=!0,this.setImg(this._mapL2,this.settings.clientFilesPath+"map-green-max.png"),this.setImg(this._mapL1,this.settings.clientFilesPath+"map-green-min.png"),this.setImg(this._barL4,this.settings.clientFilesPath+"bar-green-tl.png"),this.setImg(this._barL3,this.settings.clientFilesPath+"bar-green-tr.png"),this.setImg(this._barL2,this.settings.clientFilesPath+"bar-green-br.png"),this.setImg(this._barL1,this.settings.clientFilesPath+"bar-green-bl.png");break;case"b":this._blueRadio.checked=!0,this.setImg(this._mapL2,this.settings.clientFilesPath+"map-blue-max.png"),this.setImg(this._mapL1,this.settings.clientFilesPath+"map-blue-min.png"),this.setImg(this._barL4,this.settings.clientFilesPath+"bar-blue-tl.png"),this.setImg(this._barL3,this.settings.clientFilesPath+"bar-blue-tr.png"),this.setImg(this._barL2,this.settings.clientFilesPath+"bar-blue-br.png"),this.setImg(this._barL1,this.settings.clientFilesPath+"bar-blue-bl.png");break;default:alert("invalid mode")}switch(t){case"h":case"s":case"v":this._map.settings.xMinValue=1,this._map.settings.yMinValue=1,this._slider.settings.yMinValue=1;break;case"r":case"g":case"b":this._map.settings.xMinValue=0,this._map.settings.yMinValue=0,this._slider.settings.yMinValue=0,this._map.settings.xMaxValue=255,this._map.settings.yMaxValue=255,this._slider.settings.yMaxValue=255}this.ColorMode=t,this.positionMapAndSliderArrows(),this.updateMapVisuals(),this.updateSliderVisuals()},mapValueChanged:function(){switch(this.ColorMode){case"h":this._cvp._saturationInput.value=this._map.xValue,this._cvp._valueInput.value=100-this._map.yValue;break;case"s":this._cvp._hueInput.value=this._map.xValue,this._cvp._valueInput.value=100-this._map.yValue;break;case"v":this._cvp._hueInput.value=this._map.xValue,this._cvp._saturationInput.value=100-this._map.yValue;break;case"r":this._cvp._blueInput.value=this._map.xValue,this._cvp._greenInput.value=256-this._map.yValue;break;case"g":this._cvp._blueInput.value=this._map.xValue,this._cvp._redInput.value=256-this._map.yValue;break;case"b":this._cvp._redInput.value=this._map.xValue,this._cvp._greenInput.value=256-this._map.yValue}switch(this.ColorMode){case"h":case"s":case"v":this._cvp.setValuesFromHsv();break;case"r":case"g":case"b":this._cvp.setValuesFromRgb()}this.updateVisuals()},sliderValueChanged:function(){switch(this.ColorMode){case"h":this._cvp._hueInput.value=360-this._slider.yValue;break;case"s":this._cvp._saturationInput.value=100-this._slider.yValue;break;case"v":this._cvp._valueInput.value=100-this._slider.yValue;break;case"r":this._cvp._redInput.value=255-this._slider.yValue;break;case"g":this._cvp._greenInput.value=255-this._slider.yValue;break;case"b":this._cvp._blueInput.value=255-this._slider.yValue}switch(this.ColorMode){case"h":case"s":case"v":this._cvp.setValuesFromHsv();break;case"r":case"g":case"b":this._cvp.setValuesFromRgb()}this.updateVisuals()},positionMapAndSliderArrows:function(){this.color=this._cvp.color;var t=0;switch(this.ColorMode){case"h":t=360-this.color.h;break;case"s":t=100-this.color.s;break;case"v":t=100-this.color.v;break;case"r":t=255-this.color.r;break;case"g":t=255-this.color.g;break;case"b":t=255-this.color.b}this._slider.yValue=t,this._slider.setArrowPositionFromValues();var e=0,i=0;switch(this.ColorMode){case"h":e=this.color.s,i=100-this.color.v;break;case"s":e=this.color.h,i=100-this.color.v;break;case"v":e=this.color.h,i=100-this.color.s;break;case"r":e=this.color.b,i=256-this.color.g;break;case"g":e=this.color.b,i=256-this.color.r;break;case"b":e=this.color.r,i=256-this.color.g}this._map.xValue=e,this._map.yValue=i,this._map.setArrowPositionFromValues()},updateVisuals:function(){this.updatePreview(),this.updateMapVisuals(),this.updateSliderVisuals(),this.updateColorZilla&&this.updateColorZilla()},updatePreview:function(){try{this._preview.style.backgroundColor="#"+Refresh.Web.ColorMethods.normalizeHex(this._cvp.color.hex)}catch(t){}},updateMapVisuals:function(){switch(this.color=this._cvp.color,this.ColorMode){case"h":var t=new Refresh.Web.Color({h:this.color.h,s:100,v:100});this.setBG(this._mapL1,t.hex);break;case"s":this.setAlpha(this._mapL2,100-this.color.s);break;case"v":this.setAlpha(this._mapL2,this.color.v);break;case"r":this.setAlpha(this._mapL2,this.color.r/256*100);break;case"g":this.setAlpha(this._mapL2,this.color.g/256*100);break;case"b":this.setAlpha(this._mapL2,this.color.b/256*100)}},updateSliderVisuals:function(){switch(this.color=this._cvp.color,this.ColorMode){case"h":break;case"s":var t=new Refresh.Web.Color({h:this.color.h,s:100,v:this.color.v});this.setBG(this._barL3,t.hex);break;case"v":t=new Refresh.Web.Color({h:this.color.h,s:this.color.s,v:100});this.setBG(this._barL3,t.hex);break;case"r":case"g":case"b":var t=0,e=0,i=("r"==this.ColorMode?(t=this._cvp._blueInput.value,e=this._cvp._greenInput.value):"g"==this.ColorMode?(t=this._cvp._blueInput.value,e=this._cvp._redInput.value):"b"==this.ColorMode&&(t=this._cvp._redInput.value,e=this._cvp._greenInput.value),t/256*100),o=e/256*100,t=(256-t)/256*100,e=(256-e)/256*100;this.setAlpha(this._barL4,t<o?t:o),this.setAlpha(this._barL3,i<o?i:o),this.setAlpha(this._barL2,i<e?i:e),this.setAlpha(this._barL1,t<e?t:e)}},setBG:function(t,e){try{t.style.backgroundColor="#"+Refresh.Web.ColorMethods.normalizeHex(e)}catch(t){}},setImg:function(t,e){e.indexOf("png")&&this.isLessThanIE7?(t.pngSrc=e,t.src=this.settings.clientFilesPath+"blank.gif",t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"');"):t.src=e},setAlpha:function(t,e){var i;this.isLessThanIE7?null!=(i=t.pngSrc)&&-1==i.indexOf("map-hue")&&(t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"') progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")"):t.setOpacity(e/100)}},!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ClipboardJS=e():t.ClipboardJS=e()}(this,function(){return i=[function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t};function o(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var r=c(i(1)),a=c(i(3)),l=c(i(4));function c(t){return t&&t.__esModule?t:{default:t}}i=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);function o(t,e){var i;if(this instanceof o)return(i=function(t,e){if(t)return!e||"object"!=typeof e&&"function"!=typeof e?t:e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this))).resolveOptions(e),i.listenClick(t),i;throw new TypeError("Cannot call a class as a function")}return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t),s(o,[{key:"resolveOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===n(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,l.default)(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){t=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new r.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(t){return h("action",t)}},{key:"defaultTarget",value:function(t){t=h("target",t);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(t){return h("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof t?[t]:t,e=!!document.queryCommandSupported;return t.forEach(function(t){e=e&&!!document.queryCommandSupported(t)}),e}}]),o}(a.default);function h(t,e){t="data-clipboard-"+t;if(e.hasAttribute(t))return e.getAttribute(t)}t.exports=i},function(t,e,i){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t};function s(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var i=i(2),r=(i=i)&&i.__esModule?i:{default:i};n(a,[{key:"resolveOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir"),e=(this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px",window.pageYOffset||document.documentElement.scrollTop);this.fakeElem.style.top=e+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,r.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,r.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){if(this._action=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"copy","copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":o(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]);i=a;function a(t){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.resolveOptions(t),this.initSelection()}t.exports=i},function(t,e){t.exports=function(t){var e,i;return t="SELECT"===t.nodeName?(t.focus(),t.value):"INPUT"===t.nodeName||"TEXTAREA"===t.nodeName?((e=t.hasAttribute("readonly"))||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),e||t.removeAttribute("readonly"),t.value):(t.hasAttribute("contenteditable")&&t.focus(),e=window.getSelection(),(i=document.createRange()).selectNodeContents(t),e.removeAllRanges(),e.addRange(i),e.toString())}},function(t,e){function i(){}i.prototype={on:function(t,e,i){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){var o=this;function n(){o.off(t,n),e.apply(i,arguments)}return n._=e,this.on(t,n,i)},emit:function(t){for(var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),o=0,n=i.length;o<n;o++)i[o].fn.apply(i[o].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),o=i[t],n=[];if(o&&e)for(var s=0,r=o.length;s<r;s++)o[s].fn!==e&&o[s].fn._!==e&&n.push(o[s]);return n.length?i[t]=n:delete i[t],this}},t.exports=i},function(t,e,i){var c=i(5),h=i(6);t.exports=function(t,e,i){if(!t&&!e&&!i)throw new Error("Missing required arguments");if(!c.string(e))throw new TypeError("Second argument must be a String");if(!c.fn(i))throw new TypeError("Third argument must be a Function");if(c.node(t))return a=e,l=i,(r=t).addEventListener(a,l),{destroy:function(){r.removeEventListener(a,l)}};if(c.nodeList(t))return o=t,n=e,s=i,Array.prototype.forEach.call(o,function(t){t.addEventListener(n,s)}),{destroy:function(){Array.prototype.forEach.call(o,function(t){t.removeEventListener(n,s)})}};if(c.string(t))return h(document.body,t,e,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");var o,n,s,r,a,l}},function(t,i){i.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},i.nodeList=function(t){var e=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===e||"[object HTMLCollection]"===e)&&"length"in t&&(0===t.length||i.node(t[0]))},i.string=function(t){return"string"==typeof t||t instanceof String},i.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,i){var r=i(7);function s(t,e,i,o,n){var s=function(e,i,t,o){return function(t){t.delegateTarget=r(t.target,i),t.delegateTarget&&o.call(e,t)}}.apply(this,arguments);return t.addEventListener(i,s,n),{destroy:function(){t.removeEventListener(i,s,n)}}}t.exports=function(t,e,i,o,n){return"function"==typeof t.addEventListener?s.apply(null,arguments):"function"==typeof i?s.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,function(t){return s(t,e,i,o,n)}))}},function(t,e){var i;"undefined"==typeof Element||Element.prototype.matches||((i=Element.prototype).matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector),t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}}],o={},n.m=i,n.c=o,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0);function n(t){var e;return(o[t]||(e=o[t]={i:t,l:!1,exports:{}},i[t].call(e.exports,e,e.exports,n),e.l=!0,e)).exports}var i,o});